{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\hotel_ai_assistant\\\\hotel_dashboard\\\\src\\\\components\\\\features\\\\FieldView.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { CheckCircle2, Languages, Wrench, Sparkles, Brush, AlertTriangle } from 'lucide-react';\nimport useTranslations from '../../hooks/useTranslations';\nimport useStore from '../../store/useStore';\nimport { setWorkerLanguage, clockInStaff, getStaffTasks, updateStaffTaskStatus, subscribeToStaff, updateStaffLocation, reportIssue } from '../../services/api';\nimport './FieldView.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst MARKET_LANGUAGES = {\n  US: [{\n    code: 'en',\n    label: 'English'\n  }, {\n    code: 'es',\n    label: 'Spanish'\n  }],\n  IL: [{\n    code: 'he',\n    label: 'Hebrew'\n  }, {\n    code: 'th',\n    label: 'Thai'\n  }, {\n    code: 'hi',\n    label: 'Hindi'\n  }]\n};\nconst TASK_ICONS = {\n  Cleaning: Brush,\n  Maintenance: Wrench,\n  'VIP Treats': Sparkles,\n  cleaning: Brush,\n  maintenance: Wrench,\n  vip_treats: Sparkles\n};\nconst FieldView = ({\n  clockInOnly = false,\n  autoClockInOnScan = false\n}) => {\n  _s();\n  var _staffProfile$rank, _staffProfile$goldPoi;\n  const {\n    t\n  } = useTranslations();\n  const {\n    fieldLanguage,\n    setFieldLanguage,\n    market,\n    staffProfile,\n    setStaffProfile,\n    addNotification\n  } = useStore();\n  const marketKey = market === 'IL' ? 'IL' : 'US';\n  const languages = MARKET_LANGUAGES[marketKey] || MARKET_LANGUAGES.US;\n  const [staffIdInput, setStaffIdInput] = useState(staffProfile.staffId || '');\n  const [staffNameInput, setStaffNameInput] = useState(staffProfile.name || '');\n  const [staffPhoneInput, setStaffPhoneInput] = useState(staffProfile.phone || '');\n  const [tasks, setTasks] = useState([]);\n  const [loadingTasks, setLoadingTasks] = useState(false);\n  const [toast, setToast] = useState('');\n  const [pointsToast, setPointsToast] = useState('');\n  const [levelToast, setLevelToast] = useState('');\n  const [showIssueModal, setShowIssueModal] = useState(false);\n  const [issueTask, setIssueTask] = useState(null);\n  const [issueNote, setIssueNote] = useState('');\n  const [issuePhoto, setIssuePhoto] = useState(null);\n  const [issueSending, setIssueSending] = useState(false);\n  const [cameraOn, setCameraOn] = useState(false);\n  const [pendingFinishTask, setPendingFinishTask] = useState(null);\n  const [taskActionLoading, setTaskActionLoading] = useState({});\n  const videoRef = useRef(null);\n  const finishPhotoRef = useRef(null);\n  const scanLoopRef = useRef(null);\n  const prevTaskCountRef = useRef(0);\n  const autoClockInRef = useRef(false);\n  const staffProfileRef = useRef(staffProfile);\n  const prevGoldPointsRef = useRef(staffProfile.goldPoints || 0);\n  useEffect(() => {\n    staffProfileRef.current = staffProfile;\n  }, [staffProfile]);\n  useEffect(() => {\n    const allowed = languages.map(lang => lang.code);\n    if (!allowed.includes(fieldLanguage)) {\n      setFieldLanguage(allowed[0]);\n    }\n  }, [fieldLanguage, languages, setFieldLanguage]);\n  useEffect(() => {\n    const syncWorkerLanguage = async () => {\n      try {\n        await setWorkerLanguage(fieldLanguage);\n      } catch (error) {\n        console.error('Failed to sync worker language:', error);\n      }\n    };\n    syncWorkerLanguage();\n  }, [fieldLanguage]);\n  useEffect(() => {\n    const stopCamera = () => {\n      var _videoRef$current;\n      if (scanLoopRef.current) {\n        cancelAnimationFrame(scanLoopRef.current);\n      }\n      const stream = (_videoRef$current = videoRef.current) === null || _videoRef$current === void 0 ? void 0 : _videoRef$current.srcObject;\n      if (stream) {\n        stream.getTracks().forEach(track => track.stop());\n        if (videoRef.current) videoRef.current.srcObject = null;\n      }\n    };\n    if (!cameraOn) {\n      stopCamera();\n      return;\n    }\n    const start = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            facingMode: 'environment'\n          }\n        });\n        if (!videoRef.current) return;\n        videoRef.current.srcObject = stream;\n        await videoRef.current.play();\n        if ('BarcodeDetector' in window) {\n          const detector = new window.BarcodeDetector({\n            formats: ['qr_code']\n          });\n          const scan = async () => {\n            if (!videoRef.current) return;\n            try {\n              const barcodes = await detector.detect(videoRef.current);\n              if (barcodes && barcodes.length > 0) {\n                const value = barcodes[0].rawValue || '';\n                if (value) {\n                  setStaffIdInput(value);\n                  setToast(t('field.toast.qrScanned'));\n                  setTimeout(() => setToast(''), 1500);\n                  if (autoClockInOnScan && !autoClockInRef.current) {\n                    autoClockInRef.current = true;\n                    handleClockIn(value);\n                  }\n                  setCameraOn(false);\n                  return;\n                }\n              }\n            } catch (error) {\n              // ignore scan errors\n            }\n            scanLoopRef.current = requestAnimationFrame(scan);\n          };\n          scanLoopRef.current = requestAnimationFrame(scan);\n        }\n      } catch (error) {\n        setToast(t('field.toast.cameraUnavailable'));\n        setTimeout(() => setToast(''), 2000);\n        setCameraOn(false);\n      }\n    };\n    start();\n    return stopCamera;\n  }, [cameraOn]);\n  useEffect(() => {\n    const loadTasks = async () => {\n      if (!staffProfile.staffId) return;\n      setLoadingTasks(true);\n      try {\n        const data = await getStaffTasks(staffProfile.staffId);\n        setTasks(data);\n      } catch (error) {\n        console.error('Failed to load tasks:', error);\n      } finally {\n        setLoadingTasks(false);\n      }\n    };\n    loadTasks();\n  }, [staffProfile.staffId]);\n  useEffect(() => {\n    const count = tasks.length;\n    if (count > prevTaskCountRef.current) {\n      if (navigator.vibrate) {\n        navigator.vibrate([200, 100, 200]);\n      }\n      try {\n        const ctx = new (window.AudioContext || window.webkitAudioContext)();\n        const osc = ctx.createOscillator();\n        const gain = ctx.createGain();\n        osc.type = 'sine';\n        osc.frequency.value = 880;\n        gain.gain.value = 0.05;\n        osc.connect(gain);\n        gain.connect(ctx.destination);\n        osc.start();\n        setTimeout(() => {\n          osc.stop();\n          ctx.close();\n        }, 150);\n      } catch (error) {\n        // audio not available\n      }\n      setToast(t('field.toast.newTask'));\n      setTimeout(() => setToast(''), 1500);\n    }\n    prevTaskCountRef.current = count;\n  }, [tasks]);\n  useEffect(() => {\n    if (!staffProfile.staffId) return;\n    const source = subscribeToStaff(update => {\n      var _update$gold_points, _update$rank, _update$rank_tier;\n      const current = staffProfileRef.current;\n      if ((update === null || update === void 0 ? void 0 : update.id) !== current.staffId) return;\n      setStaffProfile({\n        ...current,\n        goldPoints: (_update$gold_points = update.gold_points) !== null && _update$gold_points !== void 0 ? _update$gold_points : current.goldPoints,\n        rank: (_update$rank = update.rank) !== null && _update$rank !== void 0 ? _update$rank : current.rank,\n        rankTier: (_update$rank_tier = update.rank_tier) !== null && _update$rank_tier !== void 0 ? _update$rank_tier : current.rankTier\n      });\n    });\n    return () => {\n      if (source && source.close) source.close();\n    };\n  }, [staffProfile.staffId, setStaffProfile]);\n  const handleClockIn = async overrideStaffId => {\n    const staffIdValue = overrideStaffId || staffIdInput;\n    if (!staffIdValue) return;\n    try {\n      var _ref, _result$gold_points, _result$rank;\n      const payload = {\n        staff_id: staffIdValue,\n        name: staffNameInput,\n        phone: staffPhoneInput\n      };\n      if (!staffProfile.language) {\n        payload.language = fieldLanguage;\n      }\n      const result = await clockInStaff(payload);\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(position => {\n          updateStaffLocation(result.id, position.coords.latitude, position.coords.longitude).catch(() => {});\n        }, () => {});\n      }\n      setStaffProfile({\n        staffId: result.id,\n        name: result.name,\n        phone: result.phone,\n        goldPoints: (_ref = (_result$gold_points = result.gold_points) !== null && _result$gold_points !== void 0 ? _result$gold_points : result.points) !== null && _ref !== void 0 ? _ref : 0,\n        rank: (_result$rank = result.rank) !== null && _result$rank !== void 0 ? _result$rank : null,\n        rankTier: result.rank_tier || staffProfile.rankTier || 'starter',\n        language: result.language || staffProfile.language || fieldLanguage\n      });\n      if (result.language) {\n        setFieldLanguage(result.language);\n      }\n      if (!clockInOnly) {\n        const data = await getStaffTasks(result.id);\n        setTasks(data);\n      }\n      setToast(t('field.toast.clockedIn'));\n      setTimeout(() => setToast(''), 1500);\n      autoClockInRef.current = false;\n    } catch (error) {\n      console.error('Clock-in failed:', error);\n      autoClockInRef.current = false;\n    }\n  };\n  const handleTaskUpdate = async (taskId, status) => {\n    const task = tasks.find(item => item.id === taskId);\n    const actionKey = `${taskId}-${status}`;\n    setTaskActionLoading(prev => ({\n      ...prev,\n      [actionKey]: true\n    }));\n    try {\n      const result = await updateStaffTaskStatus(taskId, status);\n      const data = await getStaffTasks(staffProfile.staffId);\n      setTasks(data);\n      if ((result === null || result === void 0 ? void 0 : result.gold_points) !== undefined || (result === null || result === void 0 ? void 0 : result.rank) !== undefined || result !== null && result !== void 0 && result.rank_tier) {\n        var _result$gold_points2, _result$rank2, _result$rank_tier;\n        setStaffProfile({\n          ...staffProfile,\n          goldPoints: (_result$gold_points2 = result.gold_points) !== null && _result$gold_points2 !== void 0 ? _result$gold_points2 : staffProfile.goldPoints,\n          rank: (_result$rank2 = result.rank) !== null && _result$rank2 !== void 0 ? _result$rank2 : staffProfile.rank,\n          rankTier: (_result$rank_tier = result.rank_tier) !== null && _result$rank_tier !== void 0 ? _result$rank_tier : staffProfile.rankTier\n        });\n      }\n      if (status === 'finished' && (result === null || result === void 0 ? void 0 : result.points_awarded) !== undefined) {\n        const pointsMessage = t('field.toast.goldPoints', {\n          count: result.points_awarded\n        });\n        setPointsToast(pointsMessage);\n        setTimeout(() => setPointsToast(''), 1800);\n      }\n      if (task !== null && task !== void 0 && task.room) {\n        addNotification({\n          type: status === 'finished' ? 'success' : 'activity',\n          action: status,\n          room: task.room,\n          title: t('activity.title', {\n            room: task.room\n          })\n        });\n      }\n      setToast(status === 'finished' ? t('field.toast.roomReady') : t('field.toast.taskUpdated'));\n      setTimeout(() => setToast(''), 1500);\n    } catch (error) {\n      console.error('Failed to update task:', error);\n    } finally {\n      setTaskActionLoading(prev => ({\n        ...prev,\n        [actionKey]: false\n      }));\n    }\n  };\n  const handleFinishClick = task => {\n    if (taskActionLoading[`${task.id}-finished`]) return;\n    setTaskActionLoading(prev => ({\n      ...prev,\n      [`${task.id}-finished`]: true\n    }));\n    setPendingFinishTask(task);\n    if (finishPhotoRef.current) {\n      finishPhotoRef.current.value = '';\n      finishPhotoRef.current.click();\n    }\n  };\n  const handleFinishPhotoSelected = event => {\n    var _event$target$files;\n    const file = (_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0];\n    if (!pendingFinishTask) return;\n    if (!file) {\n      setTaskActionLoading(prev => ({\n        ...prev,\n        [`${pendingFinishTask.id}-finished`]: false\n      }));\n      setPendingFinishTask(null);\n      return;\n    }\n    handleTaskUpdate(pendingFinishTask.id, 'finished');\n    setPendingFinishTask(null);\n  };\n  const openIssueModal = task => {\n    setIssueTask(task);\n    setIssueNote('');\n    setIssuePhoto(null);\n    setShowIssueModal(true);\n  };\n  const handleIssueSubmit = async () => {\n    if (!issueTask || !issuePhoto) return;\n    setIssueSending(true);\n    try {\n      await reportIssue({\n        roomId: issueTask.room_id,\n        roomName: issueTask.room,\n        taskId: issueTask.id,\n        note: issueNote,\n        photo: issuePhoto\n      });\n      if (issueTask !== null && issueTask !== void 0 && issueTask.room) {\n        addNotification({\n          type: 'damage',\n          action: 'damage_reported',\n          room: issueTask.room,\n          title: t('activity.damageReported', {\n            room: issueTask.room\n          }),\n          message: issueNote || ''\n        });\n      }\n      setToast(t('field.toast.issueReported'));\n      setTimeout(() => setToast(''), 1500);\n      setShowIssueModal(false);\n    } catch (error) {\n      console.error('Failed to report issue:', error);\n    } finally {\n      setIssueSending(false);\n    }\n  };\n  const goldPoints = staffProfile.goldPoints || 0;\n  const goldTier = goldPoints >= 100 ? 3 : goldPoints >= 50 ? 2 : goldPoints >= 10 ? 1 : 0;\n  useEffect(() => {\n    const prev = prevGoldPointsRef.current;\n    if (prev < 100 && goldPoints >= 100) {\n      const levelMessage = t('field.toast.levelUp');\n      setLevelToast(levelMessage);\n      setTimeout(() => setLevelToast(''), 2200);\n    }\n    prevGoldPointsRef.current = goldPoints;\n  }, [goldPoints, marketKey, staffProfile.rankTier]);\n  useEffect(() => {\n    if (!staffProfile.staffId || !navigator.geolocation) return () => {};\n    const updateLocation = () => {\n      navigator.geolocation.getCurrentPosition(position => {\n        updateStaffLocation(staffProfile.staffId, position.coords.latitude, position.coords.longitude).catch(() => {});\n      }, () => {});\n    };\n    updateLocation();\n    const interval = setInterval(updateLocation, 120000);\n    return () => clearInterval(interval);\n  }, [staffProfile.staffId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `field-view gold-tier-${goldTier}`,\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      ref: finishPhotoRef,\n      type: \"file\",\n      accept: \"image/*\",\n      style: {\n        display: 'none'\n      },\n      onChange: handleFinishPhotoSelected\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field-title\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: t('field.title')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"field-subtitle\",\n          children: t('field.subtitle')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 391,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, this), staffProfile.staffId && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field-rank\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"field-rank-label\",\n          children: t('field.rank')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"field-rank-value\",\n          children: (_staffProfile$rank = staffProfile.rank) !== null && _staffProfile$rank !== void 0 ? _staffProfile$rank : '-'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"field-rank-points\",\n          children: t('field.points', {\n            count: (_staffProfile$goldPoi = staffProfile.goldPoints) !== null && _staffProfile$goldPoi !== void 0 ? _staffProfile$goldPoi : 0\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"field-rank-tier\",\n          children: t(`field.rankTier.${staffProfile.rankTier || 'starter'}`)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field-lang-toggle\",\n        children: [/*#__PURE__*/_jsxDEV(Languages, {\n          size: 16\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"field-lang-options\",\n          children: languages.map(lang => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `field-lang-btn ${fieldLanguage === lang.code ? 'active' : ''}`,\n            onClick: () => setFieldLanguage(lang.code),\n            children: lang.label\n          }, lang.code, false, {\n            fileName: _jsxFileName,\n            lineNumber: 405,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field-task-list\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"field-clockin glass-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: t('field.clockIn.title')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"clockin-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: t('field.clockIn.scanPlaceholder'),\n            value: staffIdInput,\n            onChange: e => setStaffIdInput(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-secondary\",\n            onClick: () => setCameraOn(prev => !prev),\n            children: cameraOn ? t('field.clockIn.stopCamera') : t('field.clockIn.scanQr')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            placeholder: t('field.clockIn.nameOptional'),\n            value: staffNameInput,\n            onChange: e => setStaffNameInput(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 430,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"tel\",\n            placeholder: t('field.clockIn.phoneOptional'),\n            value: staffPhoneInput,\n            onChange: e => setStaffPhoneInput(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn-primary\",\n            onClick: handleClockIn,\n            children: t('field.clockIn.button')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this), cameraOn && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"camera-preview\",\n          children: /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: videoRef,\n            muted: true,\n            playsInline: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this), !clockInOnly && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [loadingTasks && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"field-loading\",\n          children: t('field.loadingTasks')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 30\n        }, this), tasks.map(task => {\n          const taskTypeKey = (task.task_type || '').toString().toLowerCase().replace(/\\s+/g, '_');\n          const Icon = TASK_ICONS[task.task_type] || TASK_ICONS[taskTypeKey] || CheckCircle2;\n          const isActiveTask = task.status !== 'finished' && Boolean(task.room_id);\n          const taskLabel = t(`field.taskTypes.${taskTypeKey}`, {\n            defaultValue: task.task_type\n          });\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `field-task-card ${task.status}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"task-main\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"task-icon\",\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  size: 18\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 465,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 464,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"task-info\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"task-title\",\n                  children: taskLabel\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 468,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"task-meta\",\n                  children: task.room\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 469,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 467,\n                columnNumber: 21\n              }, this), isActiveTask && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"task-issue-btn\",\n                onClick: () => openIssueModal(task),\n                \"aria-label\": t('field.reportIssue'),\n                children: [/*#__PURE__*/_jsxDEV(AlertTriangle, {\n                  size: 14\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 477,\n                  columnNumber: 25\n                }, this), t('field.reportIssue')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 472,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"task-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"task-action-btn\",\n                onClick: () => handleTaskUpdate(task.id, 'on_my_way'),\n                disabled: task.status === 'finished' || taskActionLoading[`${task.id}-on_my_way`],\n                children: taskActionLoading[`${task.id}-on_my_way`] ? t('common.loading') : t('field.actions.onMyWay')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 483,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"task-action-btn\",\n                onClick: () => handleTaskUpdate(task.id, 'started'),\n                disabled: task.status === 'finished' || taskActionLoading[`${task.id}-started`],\n                children: taskActionLoading[`${task.id}-started`] ? t('common.loading') : t('field.actions.cleaning')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 490,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"task-action-btn primary\",\n                onClick: () => handleFinishClick(task),\n                disabled: task.status === 'finished' || taskActionLoading[`${task.id}-finished`],\n                children: taskActionLoading[`${task.id}-finished`] ? t('common.loading') : t('field.actions.finishedWithPhoto')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 497,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 482,\n              columnNumber: 19\n            }, this)]\n          }, task.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 17\n          }, this);\n        })]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), toast && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field-toast\",\n      children: toast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 17\n    }, this), pointsToast && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field-toast points-toast\",\n      children: pointsToast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 512,\n      columnNumber: 23\n    }, this), levelToast && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field-toast level-toast\",\n      children: levelToast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 513,\n      columnNumber: 22\n    }, this), showIssueModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"report-modal-backdrop is-open\",\n      onClick: () => setShowIssueModal(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"report-modal glass-card\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"report-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: t('field.issueModal.title')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowIssueModal(false),\n            className: \"close-btn\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"report-content\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"issue-form\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              accept: \"image/*\",\n              onChange: e => {\n                var _e$target$files;\n                return setIssuePhoto(((_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0]) || null);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 523,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              placeholder: t('field.issueModal.notePlaceholder'),\n              value: issueNote,\n              onChange: e => setIssueNote(e.target.value)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 528,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn-primary\",\n              onClick: handleIssueSubmit,\n              disabled: issueSending || !issuePhoto,\n              children: issueSending ? t('field.issueModal.sending') : t('field.issueModal.submit')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 533,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 522,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 521,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 515,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 380,\n    columnNumber: 5\n  }, this);\n};\n_s(FieldView, \"B3zl3pNgYSZJj3b/XhKZP6zEw2A=\", false, function () {\n  return [useTranslations, useStore];\n});\n_c = FieldView;\nexport default FieldView;\nvar _c;\n$RefreshReg$(_c, \"FieldView\");","map":{"version":3,"names":["React","useEffect","useRef","useState","CheckCircle2","Languages","Wrench","Sparkles","Brush","AlertTriangle","useTranslations","useStore","setWorkerLanguage","clockInStaff","getStaffTasks","updateStaffTaskStatus","subscribeToStaff","updateStaffLocation","reportIssue","jsxDEV","_jsxDEV","Fragment","_Fragment","MARKET_LANGUAGES","US","code","label","IL","TASK_ICONS","Cleaning","Maintenance","cleaning","maintenance","vip_treats","FieldView","clockInOnly","autoClockInOnScan","_s","_staffProfile$rank","_staffProfile$goldPoi","t","fieldLanguage","setFieldLanguage","market","staffProfile","setStaffProfile","addNotification","marketKey","languages","staffIdInput","setStaffIdInput","staffId","staffNameInput","setStaffNameInput","name","staffPhoneInput","setStaffPhoneInput","phone","tasks","setTasks","loadingTasks","setLoadingTasks","toast","setToast","pointsToast","setPointsToast","levelToast","setLevelToast","showIssueModal","setShowIssueModal","issueTask","setIssueTask","issueNote","setIssueNote","issuePhoto","setIssuePhoto","issueSending","setIssueSending","cameraOn","setCameraOn","pendingFinishTask","setPendingFinishTask","taskActionLoading","setTaskActionLoading","videoRef","finishPhotoRef","scanLoopRef","prevTaskCountRef","autoClockInRef","staffProfileRef","prevGoldPointsRef","goldPoints","current","allowed","map","lang","includes","syncWorkerLanguage","error","console","stopCamera","_videoRef$current","cancelAnimationFrame","stream","srcObject","getTracks","forEach","track","stop","start","navigator","mediaDevices","getUserMedia","video","facingMode","play","window","detector","BarcodeDetector","formats","scan","barcodes","detect","length","value","rawValue","setTimeout","handleClockIn","requestAnimationFrame","loadTasks","data","count","vibrate","ctx","AudioContext","webkitAudioContext","osc","createOscillator","gain","createGain","type","frequency","connect","destination","close","source","update","_update$gold_points","_update$rank","_update$rank_tier","id","gold_points","rank","rankTier","rank_tier","overrideStaffId","staffIdValue","_ref","_result$gold_points","_result$rank","payload","staff_id","language","result","geolocation","getCurrentPosition","position","coords","latitude","longitude","catch","points","handleTaskUpdate","taskId","status","task","find","item","actionKey","prev","undefined","_result$gold_points2","_result$rank2","_result$rank_tier","points_awarded","pointsMessage","room","action","title","handleFinishClick","click","handleFinishPhotoSelected","event","_event$target$files","file","target","files","openIssueModal","handleIssueSubmit","roomId","room_id","roomName","note","photo","message","goldTier","levelMessage","updateLocation","interval","setInterval","clearInterval","className","children","ref","accept","style","display","onChange","fileName","_jsxFileName","lineNumber","columnNumber","size","onClick","placeholder","e","muted","playsInline","taskTypeKey","task_type","toString","toLowerCase","replace","Icon","isActiveTask","Boolean","taskLabel","defaultValue","disabled","stopPropagation","_e$target$files","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/components/features/FieldView.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { CheckCircle2, Languages, Wrench, Sparkles, Brush, AlertTriangle } from 'lucide-react';\nimport useTranslations from '../../hooks/useTranslations';\nimport useStore from '../../store/useStore';\nimport { setWorkerLanguage, clockInStaff, getStaffTasks, updateStaffTaskStatus, subscribeToStaff, updateStaffLocation, reportIssue } from '../../services/api';\nimport './FieldView.css';\n\nconst MARKET_LANGUAGES = {\n  US: [\n    { code: 'en', label: 'English' },\n    { code: 'es', label: 'Spanish' },\n  ],\n  IL: [\n    { code: 'he', label: 'Hebrew' },\n    { code: 'th', label: 'Thai' },\n    { code: 'hi', label: 'Hindi' },\n  ],\n};\n\nconst TASK_ICONS = {\n  Cleaning: Brush,\n  Maintenance: Wrench,\n  'VIP Treats': Sparkles,\n  cleaning: Brush,\n  maintenance: Wrench,\n  vip_treats: Sparkles,\n};\n\nconst FieldView = ({ clockInOnly = false, autoClockInOnScan = false }) => {\n  const { t } = useTranslations();\n  const { fieldLanguage, setFieldLanguage, market, staffProfile, setStaffProfile, addNotification } = useStore();\n  const marketKey = market === 'IL' ? 'IL' : 'US';\n  const languages = MARKET_LANGUAGES[marketKey] || MARKET_LANGUAGES.US;\n  const [staffIdInput, setStaffIdInput] = useState(staffProfile.staffId || '');\n  const [staffNameInput, setStaffNameInput] = useState(staffProfile.name || '');\n  const [staffPhoneInput, setStaffPhoneInput] = useState(staffProfile.phone || '');\n  const [tasks, setTasks] = useState([]);\n  const [loadingTasks, setLoadingTasks] = useState(false);\n  const [toast, setToast] = useState('');\n  const [pointsToast, setPointsToast] = useState('');\n  const [levelToast, setLevelToast] = useState('');\n  const [showIssueModal, setShowIssueModal] = useState(false);\n  const [issueTask, setIssueTask] = useState(null);\n  const [issueNote, setIssueNote] = useState('');\n  const [issuePhoto, setIssuePhoto] = useState(null);\n  const [issueSending, setIssueSending] = useState(false);\n  const [cameraOn, setCameraOn] = useState(false);\n  const [pendingFinishTask, setPendingFinishTask] = useState(null);\n  const [taskActionLoading, setTaskActionLoading] = useState({});\n  const videoRef = useRef(null);\n  const finishPhotoRef = useRef(null);\n  const scanLoopRef = useRef(null);\n  const prevTaskCountRef = useRef(0);\n  const autoClockInRef = useRef(false);\n  const staffProfileRef = useRef(staffProfile);\n  const prevGoldPointsRef = useRef(staffProfile.goldPoints || 0);\n\n  useEffect(() => {\n    staffProfileRef.current = staffProfile;\n  }, [staffProfile]);\n\n  useEffect(() => {\n    const allowed = languages.map((lang) => lang.code);\n    if (!allowed.includes(fieldLanguage)) {\n      setFieldLanguage(allowed[0]);\n    }\n  }, [fieldLanguage, languages, setFieldLanguage]);\n\n  useEffect(() => {\n    const syncWorkerLanguage = async () => {\n      try {\n        await setWorkerLanguage(fieldLanguage);\n      } catch (error) {\n        console.error('Failed to sync worker language:', error);\n      }\n    };\n    syncWorkerLanguage();\n  }, [fieldLanguage]);\n\n  useEffect(() => {\n    const stopCamera = () => {\n      if (scanLoopRef.current) {\n        cancelAnimationFrame(scanLoopRef.current);\n      }\n      const stream = videoRef.current?.srcObject;\n      if (stream) {\n        stream.getTracks().forEach((track) => track.stop());\n        if (videoRef.current) videoRef.current.srcObject = null;\n      }\n    };\n    if (!cameraOn) {\n      stopCamera();\n      return;\n    }\n    const start = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n        if (!videoRef.current) return;\n        videoRef.current.srcObject = stream;\n        await videoRef.current.play();\n        if ('BarcodeDetector' in window) {\n          const detector = new window.BarcodeDetector({ formats: ['qr_code'] });\n          const scan = async () => {\n            if (!videoRef.current) return;\n            try {\n              const barcodes = await detector.detect(videoRef.current);\n              if (barcodes && barcodes.length > 0) {\n                const value = barcodes[0].rawValue || '';\n                if (value) {\n                  setStaffIdInput(value);\n                  setToast(t('field.toast.qrScanned'));\n                  setTimeout(() => setToast(''), 1500);\n                  if (autoClockInOnScan && !autoClockInRef.current) {\n                    autoClockInRef.current = true;\n                    handleClockIn(value);\n                  }\n                  setCameraOn(false);\n                  return;\n                }\n              }\n            } catch (error) {\n              // ignore scan errors\n            }\n            scanLoopRef.current = requestAnimationFrame(scan);\n          };\n          scanLoopRef.current = requestAnimationFrame(scan);\n        }\n      } catch (error) {\n        setToast(t('field.toast.cameraUnavailable'));\n        setTimeout(() => setToast(''), 2000);\n        setCameraOn(false);\n      }\n    };\n    start();\n    return stopCamera;\n  }, [cameraOn]);\n\n  useEffect(() => {\n    const loadTasks = async () => {\n      if (!staffProfile.staffId) return;\n      setLoadingTasks(true);\n      try {\n        const data = await getStaffTasks(staffProfile.staffId);\n        setTasks(data);\n      } catch (error) {\n        console.error('Failed to load tasks:', error);\n      } finally {\n        setLoadingTasks(false);\n      }\n    };\n    loadTasks();\n  }, [staffProfile.staffId]);\n\n  useEffect(() => {\n    const count = tasks.length;\n    if (count > prevTaskCountRef.current) {\n      if (navigator.vibrate) {\n        navigator.vibrate([200, 100, 200]);\n      }\n      try {\n        const ctx = new (window.AudioContext || window.webkitAudioContext)();\n        const osc = ctx.createOscillator();\n        const gain = ctx.createGain();\n        osc.type = 'sine';\n        osc.frequency.value = 880;\n        gain.gain.value = 0.05;\n        osc.connect(gain);\n        gain.connect(ctx.destination);\n        osc.start();\n        setTimeout(() => {\n          osc.stop();\n          ctx.close();\n        }, 150);\n      } catch (error) {\n        // audio not available\n      }\n      setToast(t('field.toast.newTask'));\n      setTimeout(() => setToast(''), 1500);\n    }\n    prevTaskCountRef.current = count;\n  }, [tasks]);\n\n  useEffect(() => {\n    if (!staffProfile.staffId) return;\n    const source = subscribeToStaff((update) => {\n      const current = staffProfileRef.current;\n      if (update?.id !== current.staffId) return;\n      setStaffProfile({\n        ...current,\n        goldPoints: update.gold_points ?? current.goldPoints,\n        rank: update.rank ?? current.rank,\n        rankTier: update.rank_tier ?? current.rankTier,\n      });\n    });\n    return () => {\n      if (source && source.close) source.close();\n    };\n  }, [staffProfile.staffId, setStaffProfile]);\n\n  const handleClockIn = async (overrideStaffId) => {\n    const staffIdValue = overrideStaffId || staffIdInput;\n    if (!staffIdValue) return;\n    try {\n      const payload = {\n        staff_id: staffIdValue,\n        name: staffNameInput,\n        phone: staffPhoneInput,\n      };\n      if (!staffProfile.language) {\n        payload.language = fieldLanguage;\n      }\n      const result = await clockInStaff(payload);\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          (position) => {\n            updateStaffLocation(\n              result.id,\n              position.coords.latitude,\n              position.coords.longitude\n            ).catch(() => {});\n          },\n          () => {}\n        );\n      }\n      setStaffProfile({\n        staffId: result.id,\n        name: result.name,\n        phone: result.phone,\n        goldPoints: result.gold_points ?? result.points ?? 0,\n        rank: result.rank ?? null,\n        rankTier: result.rank_tier || staffProfile.rankTier || 'starter',\n        language: result.language || staffProfile.language || fieldLanguage,\n      });\n      if (result.language) {\n        setFieldLanguage(result.language);\n      }\n      if (!clockInOnly) {\n        const data = await getStaffTasks(result.id);\n        setTasks(data);\n      }\n      setToast(t('field.toast.clockedIn'));\n      setTimeout(() => setToast(''), 1500);\n      autoClockInRef.current = false;\n    } catch (error) {\n      console.error('Clock-in failed:', error);\n      autoClockInRef.current = false;\n    }\n  };\n\n  const handleTaskUpdate = async (taskId, status) => {\n    const task = tasks.find((item) => item.id === taskId);\n    const actionKey = `${taskId}-${status}`;\n    setTaskActionLoading((prev) => ({ ...prev, [actionKey]: true }));\n    try {\n      const result = await updateStaffTaskStatus(taskId, status);\n      const data = await getStaffTasks(staffProfile.staffId);\n      setTasks(data);\n      if (result?.gold_points !== undefined || result?.rank !== undefined || result?.rank_tier) {\n        setStaffProfile({\n          ...staffProfile,\n          goldPoints: result.gold_points ?? staffProfile.goldPoints,\n          rank: result.rank ?? staffProfile.rank,\n          rankTier: result.rank_tier ?? staffProfile.rankTier,\n        });\n      }\n      if (status === 'finished' && result?.points_awarded !== undefined) {\n        const pointsMessage = t('field.toast.goldPoints', { count: result.points_awarded });\n        setPointsToast(pointsMessage);\n        setTimeout(() => setPointsToast(''), 1800);\n      }\n      if (task?.room) {\n        addNotification({\n          type: status === 'finished' ? 'success' : 'activity',\n          action: status,\n          room: task.room,\n          title: t('activity.title', { room: task.room }),\n        });\n      }\n      setToast(status === 'finished' ? t('field.toast.roomReady') : t('field.toast.taskUpdated'));\n      setTimeout(() => setToast(''), 1500);\n    } catch (error) {\n      console.error('Failed to update task:', error);\n    } finally {\n      setTaskActionLoading((prev) => ({ ...prev, [actionKey]: false }));\n    }\n  };\n\n  const handleFinishClick = (task) => {\n    if (taskActionLoading[`${task.id}-finished`]) return;\n    setTaskActionLoading((prev) => ({ ...prev, [`${task.id}-finished`]: true }));\n    setPendingFinishTask(task);\n    if (finishPhotoRef.current) {\n      finishPhotoRef.current.value = '';\n      finishPhotoRef.current.click();\n    }\n  };\n\n  const handleFinishPhotoSelected = (event) => {\n    const file = event.target.files?.[0];\n    if (!pendingFinishTask) return;\n    if (!file) {\n      setTaskActionLoading((prev) => ({ ...prev, [`${pendingFinishTask.id}-finished`]: false }));\n      setPendingFinishTask(null);\n      return;\n    }\n    handleTaskUpdate(pendingFinishTask.id, 'finished');\n    setPendingFinishTask(null);\n  };\n\n  const openIssueModal = (task) => {\n    setIssueTask(task);\n    setIssueNote('');\n    setIssuePhoto(null);\n    setShowIssueModal(true);\n  };\n\n  const handleIssueSubmit = async () => {\n    if (!issueTask || !issuePhoto) return;\n    setIssueSending(true);\n    try {\n      await reportIssue({\n        roomId: issueTask.room_id,\n        roomName: issueTask.room,\n        taskId: issueTask.id,\n        note: issueNote,\n        photo: issuePhoto,\n      });\n      if (issueTask?.room) {\n        addNotification({\n          type: 'damage',\n          action: 'damage_reported',\n          room: issueTask.room,\n          title: t('activity.damageReported', { room: issueTask.room }),\n          message: issueNote || '',\n        });\n      }\n      setToast(t('field.toast.issueReported'));\n      setTimeout(() => setToast(''), 1500);\n      setShowIssueModal(false);\n    } catch (error) {\n      console.error('Failed to report issue:', error);\n    } finally {\n      setIssueSending(false);\n    }\n  };\n\n  const goldPoints = staffProfile.goldPoints || 0;\n  const goldTier = goldPoints >= 100 ? 3 : goldPoints >= 50 ? 2 : goldPoints >= 10 ? 1 : 0;\n\n  useEffect(() => {\n    const prev = prevGoldPointsRef.current;\n    if (prev < 100 && goldPoints >= 100) {\n      const levelMessage = t('field.toast.levelUp');\n      setLevelToast(levelMessage);\n      setTimeout(() => setLevelToast(''), 2200);\n    }\n    prevGoldPointsRef.current = goldPoints;\n  }, [goldPoints, marketKey, staffProfile.rankTier]);\n\n  useEffect(() => {\n    if (!staffProfile.staffId || !navigator.geolocation) return () => {};\n    const updateLocation = () => {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          updateStaffLocation(\n            staffProfile.staffId,\n            position.coords.latitude,\n            position.coords.longitude\n          ).catch(() => {});\n        },\n        () => {}\n      );\n    };\n    updateLocation();\n    const interval = setInterval(updateLocation, 120000);\n    return () => clearInterval(interval);\n  }, [staffProfile.staffId]);\n\n  return (\n    <div className={`field-view gold-tier-${goldTier}`}>\n      <input\n        ref={finishPhotoRef}\n        type=\"file\"\n        accept=\"image/*\"\n        style={{ display: 'none' }}\n        onChange={handleFinishPhotoSelected}\n      />\n      <div className=\"field-header\">\n        <div className=\"field-title\">\n          <h2>{t('field.title')}</h2>\n          <span className=\"field-subtitle\">{t('field.subtitle')}</span>\n        </div>\n        {staffProfile.staffId && (\n          <div className=\"field-rank\">\n            <span className=\"field-rank-label\">{t('field.rank')}</span>\n            <span className=\"field-rank-value\">{staffProfile.rank ?? '-'}</span>\n            <span className=\"field-rank-points\">{t('field.points', { count: staffProfile.goldPoints ?? 0 })}</span>\n            <span className=\"field-rank-tier\">{t(`field.rankTier.${staffProfile.rankTier || 'starter'}`)}</span>\n          </div>\n        )}\n        <div className=\"field-lang-toggle\">\n          <Languages size={16} />\n          <div className=\"field-lang-options\">\n            {languages.map((lang) => (\n              <button\n                key={lang.code}\n                className={`field-lang-btn ${fieldLanguage === lang.code ? 'active' : ''}`}\n                onClick={() => setFieldLanguage(lang.code)}\n              >\n                {lang.label}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"field-task-list\">\n        <div className=\"field-clockin glass-card\">\n              <h3>{t('field.clockIn.title')}</h3>\n          <div className=\"clockin-form\">\n            <input\n              type=\"text\"\n                  placeholder={t('field.clockIn.scanPlaceholder')}\n              value={staffIdInput}\n              onChange={(e) => setStaffIdInput(e.target.value)}\n            />\n            <button className=\"btn-secondary\" onClick={() => setCameraOn((prev) => !prev)}>\n                  {cameraOn ? t('field.clockIn.stopCamera') : t('field.clockIn.scanQr')}\n            </button>\n            <input\n              type=\"text\"\n                  placeholder={t('field.clockIn.nameOptional')}\n              value={staffNameInput}\n              onChange={(e) => setStaffNameInput(e.target.value)}\n            />\n            <input\n              type=\"tel\"\n                  placeholder={t('field.clockIn.phoneOptional')}\n              value={staffPhoneInput}\n              onChange={(e) => setStaffPhoneInput(e.target.value)}\n            />\n            <button className=\"btn-primary\" onClick={handleClockIn}>\n                  {t('field.clockIn.button')}\n            </button>\n          </div>\n          {cameraOn && (\n            <div className=\"camera-preview\">\n              <video ref={videoRef} muted playsInline />\n            </div>\n          )}\n        </div>\n\n        {!clockInOnly && (\n          <>\n            {loadingTasks && <div className=\"field-loading\">{t('field.loadingTasks')}</div>}\n            {tasks.map((task) => {\n              const taskTypeKey = (task.task_type || '').toString().toLowerCase().replace(/\\s+/g, '_');\n              const Icon = TASK_ICONS[task.task_type] || TASK_ICONS[taskTypeKey] || CheckCircle2;\n              const isActiveTask = task.status !== 'finished' && Boolean(task.room_id);\n              const taskLabel = t(`field.taskTypes.${taskTypeKey}`, { defaultValue: task.task_type });\n              return (\n                <div key={task.id} className={`field-task-card ${task.status}`}>\n                  <div className=\"task-main\">\n                    <div className=\"task-icon\">\n                      <Icon size={18} />\n                    </div>\n                    <div className=\"task-info\">\n                      <span className=\"task-title\">{taskLabel}</span>\n                      <span className=\"task-meta\">{task.room}</span>\n                    </div>\n                    {isActiveTask && (\n                      <button\n                        className=\"task-issue-btn\"\n                        onClick={() => openIssueModal(task)}\n                        aria-label={t('field.reportIssue')}\n                      >\n                        <AlertTriangle size={14} />\n                        {t('field.reportIssue')}\n                      </button>\n                    )}\n                  </div>\n                  <div className=\"task-actions\">\n                    <button\n                      className=\"task-action-btn\"\n                      onClick={() => handleTaskUpdate(task.id, 'on_my_way')}\n                      disabled={task.status === 'finished' || taskActionLoading[`${task.id}-on_my_way`]}\n                    >\n                      {taskActionLoading[`${task.id}-on_my_way`] ? t('common.loading') : t('field.actions.onMyWay')}\n                    </button>\n                    <button\n                      className=\"task-action-btn\"\n                      onClick={() => handleTaskUpdate(task.id, 'started')}\n                      disabled={task.status === 'finished' || taskActionLoading[`${task.id}-started`]}\n                    >\n                      {taskActionLoading[`${task.id}-started`] ? t('common.loading') : t('field.actions.cleaning')}\n                    </button>\n                    <button\n                      className=\"task-action-btn primary\"\n                      onClick={() => handleFinishClick(task)}\n                      disabled={task.status === 'finished' || taskActionLoading[`${task.id}-finished`]}\n                    >\n                      {taskActionLoading[`${task.id}-finished`] ? t('common.loading') : t('field.actions.finishedWithPhoto')}\n                    </button>\n                  </div>\n                </div>\n              );\n            })}\n          </>\n        )}\n      </div>\n      {toast && <div className=\"field-toast\">{toast}</div>}\n      {pointsToast && <div className=\"field-toast points-toast\">{pointsToast}</div>}\n      {levelToast && <div className=\"field-toast level-toast\">{levelToast}</div>}\n      {showIssueModal && (\n        <div className=\"report-modal-backdrop is-open\" onClick={() => setShowIssueModal(false)}>\n          <div className=\"report-modal glass-card\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"report-header\">\n              <h2>{t('field.issueModal.title')}</h2>\n              <button onClick={() => setShowIssueModal(false)} className=\"close-btn\"></button>\n            </div>\n            <div className=\"report-content\">\n              <div className=\"issue-form\">\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={(e) => setIssuePhoto(e.target.files?.[0] || null)}\n                />\n                <textarea\n                  placeholder={t('field.issueModal.notePlaceholder')}\n                  value={issueNote}\n                  onChange={(e) => setIssueNote(e.target.value)}\n                />\n                <button className=\"btn-primary\" onClick={handleIssueSubmit} disabled={issueSending || !issuePhoto}>\n                  {issueSending ? t('field.issueModal.sending') : t('field.issueModal.submit')}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FieldView;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}