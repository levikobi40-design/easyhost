{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{Users,Search,Filter,Plus,Mail,Phone,Globe,Calendar,Tag,Star,ArrowUpRight,ExternalLink,MessageCircle,Target,BarChart3,Activity}from'lucide-react';import FinancialStat from'./FinancialStat';import useTranslations from'../../hooks/useTranslations';import useStore from'../../store/useStore';import{maya,AGENT_TYPES}from'../../services/agentOrchestrator';import{getLeads,getAutomationStats,subscribeToLeads,getFinancialSummary}from'../../services/api';import{whatsappService}from'../../services/whatsapp';import'./LeadsCRM.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const sourceIcons={airbnb:'üè†',booking:'üìÖ',direct:'üéØ',referral:'üë•',social:'üì±'};const LeadsCRM=()=>{var _financials$avg_ltv,_financials$conversio,_financials$projected,_automationStats$auto;const{t}=useTranslations();const[searchQuery,setSearchQuery]=useState('');const[statusFilter,setStatusFilter]=useState('all');const[selectedLead,setSelectedLead]=useState(null);const[isScanning,setIsScanning]=useState(false);const[leads,setLeads]=useState([]);const[isLoadingLeads,setIsLoadingLeads]=useState(true);const[financials,setFinancials]=useState(null);const greetedLeadIdsRef=useRef(new Set());const paymentAlertedIdsRef=useRef(new Set());const{addNotification,lang,setLeads:setStoreLeads,automationStats,objectionSuccess,setAutomationStats,setObjectionSuccess,activeTenantId,authToken}=useStore();const isRTL=lang==='he';const statusOptions=[{value:'all',label:t('leadsCRM.status.all'),color:'#64748b'},{value:'new',label:t('leadsCRM.status.new'),color:'#3b82f6'},{value:'contacted',label:t('leadsCRM.status.contacted'),color:'#f59e0b'},{value:'qualified',label:t('leadsCRM.status.qualified'),color:'#8b5cf6'},{value:'converted',label:t('leadsCRM.status.converted'),color:'#10b981'},{value:'lost',label:t('leadsCRM.status.lost'),color:'#ef4444'}];const leadsWithFallback=leads;const filteredLeads=leadsWithFallback.filter(lead=>{const matchesSearch=lead.name.toLowerCase().includes(searchQuery.toLowerCase())||lead.contact.toLowerCase().includes(searchQuery.toLowerCase());const matchesStatus=statusFilter==='all'||lead.status===statusFilter;return matchesSearch&&matchesStatus;});const normalizeLead=lead=>{const safeLead=lead||{};const fallbackId=safeLead.id||safeLead.lead_id||`${safeLead.email||safeLead.phone||Date.now()}`;const name=safeLead.name||safeLead.property_name||safeLead.property||'Unknown Property';const contact=safeLead.contact||safeLead.full_name||safeLead.guest_name||'Guest';return{id:fallbackId,name,contact,email:safeLead.email||'',phone:safeLead.phone||'',source:safeLead.source||'direct',status:safeLead.status||'new',value:safeLead.value||0,rating:safeLead.rating||0,createdAt:safeLead.createdAt||safeLead.created_at||new Date().toISOString(),notes:safeLead.notes||'',photo:safeLead.photo||`https://api.dicebear.com/7.x/personas/svg?seed=${encodeURIComponent(contact)}&backgroundColor=0b1220&radius=20`,property:safeLead.property||name};};useEffect(()=>{let isActive=true;const loadLeads=async()=>{setIsLoadingLeads(true);try{const results=await getLeads(statusFilter==='all'?null:statusFilter);const normalized=Array.isArray(results)?results.map(normalizeLead):[];if(isActive){setLeads(normalized);setStoreLeads(normalized);}}catch(error){console.error('Failed to load leads:',error);}finally{if(isActive)setIsLoadingLeads(false);}};loadLeads();return()=>{isActive=false;};},[statusFilter,setStoreLeads,activeTenantId,authToken]);useEffect(()=>{let isActive=true;const loadFinancials=async()=>{try{const data=await getFinancialSummary();if(isActive)setFinancials(data);}catch(e){if(isActive)setFinancials({avg_ltv:'‚Ç™0',conversion_rate:'0%',projected_revenue:'‚Ç™0'});}};loadFinancials();return()=>{isActive=false;};},[activeTenantId,authToken]);useEffect(()=>{let isActive=true;const loadAutomationStats=async()=>{try{const statsResponse=await getAutomationStats();if(!isActive)return;setAutomationStats(statsResponse.automation_stats);setObjectionSuccess(statsResponse.objection_success);}catch(error){console.error('Failed to load automation stats:',error);}};loadAutomationStats();return()=>{isActive=false;};},[setAutomationStats,setObjectionSuccess,activeTenantId,authToken]);useEffect(()=>{const handleNewLead=async incoming=>{const normalized=normalizeLead(incoming);setLeads(prev=>{const nextLeads=[normalized,...prev];setStoreLeads(nextLeads);return nextLeads;});if(!greetedLeadIdsRef.current.has(normalized.id)){greetedLeadIdsRef.current.add(normalized.id);try{await whatsappService.sendLeadGreeting(normalized,lang);addNotification({type:'success',title:t('leadsCRM.actions.sendDemo'),message:t('leadsCRM.autoGreetingSent',{name:normalized.contact})});}catch(error){console.error('Failed to send greeting:',error);}}};const handleLeadUpdated=incoming=>{const normalized=normalizeLead(incoming);const hasPaymentLink=Boolean(normalized.payment_link);const isPaid=normalized.status==='paid';if((hasPaymentLink||isPaid)&&!paymentAlertedIdsRef.current.has(normalized.id)){paymentAlertedIdsRef.current.add(normalized.id);addNotification({type:'warning',title:t('notifications.paymentLinkReady',{defaultValue:'Payment Link Ready'}),message:t('notifications.paymentLinkMessage',{defaultValue:`${normalized.contact||normalized.name} is ready to finalize payment.`})});}setLeads(prev=>{const nextLeads=prev.map(lead=>lead.id===normalized.id?{...lead,...normalized}:lead);setStoreLeads(nextLeads);return nextLeads;});};const handleAutomationStats=statsUpdate=>{setAutomationStats(statsUpdate);};const eventSource=subscribeToLeads(handleNewLead,handleLeadUpdated,error=>{console.error('Lead stream error:',error);},handleAutomationStats);return()=>{if(eventSource&&eventSource.close)eventSource.close();};},[addNotification,lang,setAutomationStats,setStoreLeads,t,activeTenantId,authToken]);const handleScanLeads=async()=>{setIsScanning(true);try{const result=await maya.executeTask(AGENT_TYPES.SCRAPER,{platforms:['airbnb','booking']});addNotification({type:'success',title:t('leadsCRM.scanNew'),message:result.message});if(result.leads&&result.leads.length>0){result.leads.slice(0,3).forEach(lead=>{addNotification({type:'info',title:t('notifications.newLead'),messageKey:'notifications.messages.newLead',messageValues:{platform:lead.platform||'Airbnb'},data:lead});});}}catch(error){addNotification({type:'error',title:'Error',message:'Lead scan failed'});}finally{setIsScanning(false);}};const handleSendDemo=async lead=>{try{const result=await maya.executeTask(AGENT_TYPES.SALES,{type:'send_demo',lead});addNotification({type:'success',title:t('leadsCRM.actions.sendDemo'),message:result.message});}catch(error){addNotification({type:'error',title:'Error',message:'Demo send failed'});}};const getStatusColor=status=>{var _statusOptions$find;return((_statusOptions$find=statusOptions.find(s=>s.value===status))===null||_statusOptions$find===void 0?void 0:_statusOptions$find.color)||'#64748b';};const getStatusLabel=status=>{var _statusOptions$find2;return((_statusOptions$find2=statusOptions.find(s=>s.value===status))===null||_statusOptions$find2===void 0?void 0:_statusOptions$find2.label)||status;};const objectionMetrics=['price','location','rules'].map(key=>{const stats=(objectionSuccess===null||objectionSuccess===void 0?void 0:objectionSuccess[key])||{yes:0,no:0};const total=stats.yes+stats.no;const rate=total>0?Math.round(stats.yes/total*100):0;return{key,label:key==='price'?'Price':key==='location'?'Location':'Rules',yes:stats.yes,no:stats.no,rate};});return/*#__PURE__*/_jsxs(\"div\",{className:\"crm-container\",dir:isRTL?'rtl':'ltr',children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-10\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-black text-gray-900 mb-1\",children:\"Leads & Revenue\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"\\u05DE\\u05E2\\u05E7\\u05D1 \\u05D0\\u05D7\\u05E8\\u05D9 \\u05D4\\u05DE\\u05E8\\u05D4 \\u05D5\\u05E8\\u05D5\\u05D5\\u05D7\\u05D9\\u05D5\\u05EA \\u05D4\\u05E0\\u05DB\\u05E1\\u05D9\\u05DD \\u05E9\\u05DC\\u05DA.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-10\",children:[/*#__PURE__*/_jsx(FinancialStat,{label:\"LTV \\u05DE\\u05DE\\u05D5\\u05E6\\u05E2\",value:(_financials$avg_ltv=financials===null||financials===void 0?void 0:financials.avg_ltv)!==null&&_financials$avg_ltv!==void 0?_financials$avg_ltv:'‚Ç™0',trend:\"\",icon:Users}),/*#__PURE__*/_jsx(FinancialStat,{label:\"\\u05D9\\u05D7\\u05E1 \\u05D4\\u05DE\\u05E8\\u05D4\",value:(_financials$conversio=financials===null||financials===void 0?void 0:financials.conversion_rate)!==null&&_financials$conversio!==void 0?_financials$conversio:'0%',trend:\"\",icon:Target}),/*#__PURE__*/_jsx(FinancialStat,{label:\"\\u05E8\\u05D5\\u05D5\\u05D7 \\u05EA\\u05E4\\u05E2\\u05D5\\u05DC\\u05D9\",value:(_financials$projected=financials===null||financials===void 0?void 0:financials.projected_revenue)!==null&&_financials$projected!==void 0?_financials$projected:'‚Ç™0',trend:\"\",icon:BarChart3}),/*#__PURE__*/_jsx(FinancialStat,{label:\"\\u05E2\\u05DC\\u05D5\\u05EA \\u05E0\\u05D9\\u05E7\\u05D9\\u05D5\\u05DF \\u05DE\\u05DE\\u05D5\\u05E6\\u05E2\\u05EA\",value:\"\\u20AA350\",trend:\"-2%\",icon:Activity})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"crm-title\",children:[/*#__PURE__*/_jsx(Users,{size:28}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:t('leadsCRM.title')}),/*#__PURE__*/_jsx(\"p\",{children:t('leadsCRM.leadCount',{count:filteredLeads.length})})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleScanLeads,disabled:isScanning,className:\"btn-primary scan-btn\",children:isScanning?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Search,{size:18,className:\"animate-spin\"}),t('common.scanning')]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Search,{size:18}),t('leadsCRM.scanNew')]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-filters glass-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-box\",children:[/*#__PURE__*/_jsx(Search,{size:18}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:t('leadsCRM.searchPlaceholder'),value:searchQuery,onChange:e=>setSearchQuery(e.target.value)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status-filters\",children:statusOptions.map(status=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setStatusFilter(status.value),className:`status-filter-btn ${statusFilter===status.value?'active':''}`,style:{'--status-color':status.color},children:status.label},status.value))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-[40px] border border-gray-100 shadow-sm overflow-hidden mb-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-100 bg-gray-50/50\",children:/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold text-gray-800\",children:\"\\u05DC\\u05D9\\u05D3\\u05D9\\u05DD \\u05D0\\u05D7\\u05E8\\u05D5\\u05E0\\u05D9\\u05DD \\u05DE\\u05D4-Scraper\"})}),isLoadingLeads?/*#__PURE__*/_jsx(\"div\",{className:\"p-12 text-center text-gray-400\",children:\"\\u05D8\\u05D5\\u05E2\\u05DF \\u05DC\\u05D9\\u05D3\\u05D9\\u05DD...\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"overflow-x-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-right min-w-[500px]\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"text-gray-400 text-xs uppercase tracking-wider\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"p-6\",children:\"\\u05DE\\u05E7\\u05D5\\u05E8\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-6\",children:\"\\u05E9\\u05DD \\u05D4\\u05E0\\u05DB\\u05E1\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-6\",children:\"\\u05E1\\u05D8\\u05D8\\u05D5\\u05E1 \\u05D4\\u05DE\\u05E8\\u05D4\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-6\",children:\"\\u05E4\\u05D5\\u05D8\\u05E0\\u05E6\\u05D9\\u05D0\\u05DC \\u05D4\\u05DB\\u05E0\\u05E1\\u05D4\"}),/*#__PURE__*/_jsx(\"th\",{className:\"p-6 w-0\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"text-sm\",children:filteredLeads.slice(0,10).map(lead=>/*#__PURE__*/_jsxs(\"tr\",{className:\"border-t border-gray-50 hover:bg-gray-50/50 transition-colors cursor-pointer\",onClick:()=>setSelectedLead(lead),children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-6 font-bold text-blue-600\",children:lead.source||'direct'}),/*#__PURE__*/_jsx(\"td\",{className:\"p-6 text-gray-800\",children:lead.name}),/*#__PURE__*/_jsx(\"td\",{className:\"p-6\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-[10px] font-bold\",style:{backgroundColor:`${getStatusColor(lead.status)}20`,color:getStatusColor(lead.status)},children:getStatusLabel(lead.status).toUpperCase()})}),/*#__PURE__*/_jsxs(\"td\",{className:\"p-6 font-black\",children:[\"\\u20AA\",Number(lead.value||0).toLocaleString()]}),/*#__PURE__*/_jsx(\"td\",{className:\"p-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"p-2 text-gray-400 hover:text-blue-600\",onClick:e=>{e.stopPropagation();setSelectedLead(lead);},children:/*#__PURE__*/_jsx(ArrowUpRight,{size:16})})})]},lead.id))})]}),filteredLeads.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"p-12 text-center text-gray-400\",children:\"\\u05D0\\u05D9\\u05DF \\u05DC\\u05D9\\u05D3\\u05D9\\u05DD \\u05DC\\u05D4\\u05E6\\u05D2\\u05D4\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"crm-stat glass-card\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-value text-gradient\",children:leadsWithFallback.filter(l=>l.status==='new').length}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:t('leadsCRM.stats.newLeads')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-stat glass-card\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",style:{color:'#f59e0b'},children:leadsWithFallback.filter(l=>l.status==='contacted').length}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:t('leadsCRM.stats.inProgress')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-stat glass-card\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",style:{color:'#8b5cf6'},children:leadsWithFallback.filter(l=>l.status==='qualified').length}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:t('leadsCRM.stats.qualified')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-stat glass-card\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"stat-value\",style:{color:'#10b981'},children:[\"\\u20AA\",leadsWithFallback.reduce((sum,l)=>sum+l.value,0).toLocaleString()]}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:t('leadsCRM.stats.totalValue')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"crm-stat glass-card\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",style:{color:'#38bdf8'},children:(_automationStats$auto=automationStats===null||automationStats===void 0?void 0:automationStats.automated_messages)!==null&&_automationStats$auto!==void 0?_automationStats$auto:0}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"AI Messages\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"success-meter glass-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"success-meter-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Success Meter\"}),/*#__PURE__*/_jsx(\"span\",{className:\"success-meter-subtitle\",children:\"Objection conversion performance\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"success-meter-grid\",children:objectionMetrics.map(metric=>/*#__PURE__*/_jsxs(\"div\",{className:\"success-meter-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"success-meter-label\",children:[/*#__PURE__*/_jsx(\"span\",{children:metric.label}),/*#__PURE__*/_jsxs(\"span\",{children:[metric.rate,\"%\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"success-meter-bar\",children:/*#__PURE__*/_jsx(\"span\",{style:{width:`${metric.rate}%`}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"success-meter-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Yes: \",metric.yes]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"No: \",metric.no]})]})]},metric.key))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"leads-grid\",children:filteredLeads.map(lead=>/*#__PURE__*/_jsxs(\"div\",{className:\"lead-card glass-card\",onClick:()=>setSelectedLead(lead),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead-card-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"lead-avatar\",style:{backgroundImage:`url(${lead.photo})`}}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-header-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"lead-name\",children:lead.name}),/*#__PURE__*/_jsx(\"span\",{className:\"lead-contact\",children:lead.contact})]}),/*#__PURE__*/_jsx(\"span\",{className:\"lead-status\",style:{'--status-color':getStatusColor(lead.status),boxShadow:`0 0 16px ${getStatusColor(lead.status)}`},children:getStatusLabel(lead.status)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"lead-card-body\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"lead-meta-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead-meta-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"meta-label\",children:t('leadsCRM.table.source')}),/*#__PURE__*/_jsxs(\"span\",{className:\"meta-value\",children:[sourceIcons[lead.source],\" \",lead.source]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-meta-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"meta-label\",children:t('leadsCRM.table.value')}),/*#__PURE__*/_jsxs(\"span\",{className:\"meta-value\",children:[\"\\u20AA\",lead.value.toLocaleString(),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"per-night\",children:t('leadsCRM.perNight')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-meta-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"meta-label\",children:t('leadsCRM.table.rating')}),/*#__PURE__*/_jsxs(\"span\",{className:\"meta-value rating\",children:[/*#__PURE__*/_jsx(Star,{size:14,fill:\"#fbbf24\",color:\"#fbbf24\"}),lead.rating]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-card-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"lead-action whatsapp\",title:\"WhatsApp\",onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(MessageCircle,{size:16})}),/*#__PURE__*/_jsx(\"button\",{className:\"lead-action call\",title:t('leadsCRM.actions.call'),onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsx(Phone,{size:16})})]})]},lead.id))}),selectedLead&&/*#__PURE__*/_jsx(\"div\",{className:\"lead-modal-backdrop\",onClick:()=>setSelectedLead(null),children:/*#__PURE__*/_jsxs(\"div\",{className:\"lead-modal glass-card\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead-modal-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"source-icon large\",children:sourceIcons[selectedLead.source]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:selectedLead.name}),/*#__PURE__*/_jsx(\"p\",{children:selectedLead.contact})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedLead(null),className:\"close-modal-btn\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lead-details-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Mail,{size:18}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:t('leadsCRM.modal.email')}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedLead.email})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Phone,{size:18}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:t('leadsCRM.modal.phone')}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedLead.phone})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Globe,{size:18}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:t('leadsCRM.modal.source')}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:selectedLead.source})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Calendar,{size:18}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"label\",children:t('leadsCRM.modal.createdAt')}),/*#__PURE__*/_jsx(\"span\",{className:\"value\",children:new Date(selectedLead.createdAt).toLocaleDateString(lang==='he'?'he-IL':lang==='el'?'el-GR':'en-US')})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-notes\",children:[/*#__PURE__*/_jsx(\"h4\",{children:t('leadsCRM.modal.notes')}),/*#__PURE__*/_jsx(\"p\",{children:selectedLead.notes})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lead-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSendDemo(selectedLead),className:\"btn-primary\",children:[/*#__PURE__*/_jsx(Mail,{size:18}),t('leadsCRM.actions.sendDemo')]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn-secondary\",children:[/*#__PURE__*/_jsx(MessageCircle,{size:18}),t('leadsCRM.modal.sendMessage')]})]})]})]})})]});};export default LeadsCRM;","map":{"version":3,"names":["React","useEffect","useRef","useState","Users","Search","Filter","Plus","Mail","Phone","Globe","Calendar","Tag","Star","ArrowUpRight","ExternalLink","MessageCircle","Target","BarChart3","Activity","FinancialStat","useTranslations","useStore","maya","AGENT_TYPES","getLeads","getAutomationStats","subscribeToLeads","getFinancialSummary","whatsappService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","sourceIcons","airbnb","booking","direct","referral","social","LeadsCRM","_financials$avg_ltv","_financials$conversio","_financials$projected","_automationStats$auto","t","searchQuery","setSearchQuery","statusFilter","setStatusFilter","selectedLead","setSelectedLead","isScanning","setIsScanning","leads","setLeads","isLoadingLeads","setIsLoadingLeads","financials","setFinancials","greetedLeadIdsRef","Set","paymentAlertedIdsRef","addNotification","lang","setStoreLeads","automationStats","objectionSuccess","setAutomationStats","setObjectionSuccess","activeTenantId","authToken","isRTL","statusOptions","value","label","color","leadsWithFallback","filteredLeads","filter","lead","matchesSearch","name","toLowerCase","includes","contact","matchesStatus","status","normalizeLead","safeLead","fallbackId","id","lead_id","email","phone","Date","now","property_name","property","full_name","guest_name","source","rating","createdAt","created_at","toISOString","notes","photo","encodeURIComponent","isActive","loadLeads","results","normalized","Array","isArray","map","error","console","loadFinancials","data","e","avg_ltv","conversion_rate","projected_revenue","loadAutomationStats","statsResponse","automation_stats","objection_success","handleNewLead","incoming","prev","nextLeads","current","has","add","sendLeadGreeting","type","title","message","handleLeadUpdated","hasPaymentLink","Boolean","payment_link","isPaid","defaultValue","handleAutomationStats","statsUpdate","eventSource","close","handleScanLeads","result","executeTask","SCRAPER","platforms","length","slice","forEach","messageKey","messageValues","platform","handleSendDemo","SALES","getStatusColor","_statusOptions$find","find","s","getStatusLabel","_statusOptions$find2","objectionMetrics","key","stats","yes","no","total","rate","Math","round","className","dir","children","trend","icon","size","count","onClick","disabled","placeholder","onChange","target","style","backgroundColor","toUpperCase","Number","toLocaleString","stopPropagation","l","reduce","sum","automated_messages","metric","width","backgroundImage","boxShadow","fill","toLocaleDateString"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/components/crm/LeadsCRM.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport {\n  Users, Search, Filter, Plus,\n  Mail, Phone, Globe, Calendar, Tag, Star,\n  ArrowUpRight, ExternalLink, MessageCircle,\n  Target, BarChart3, Activity\n} from 'lucide-react';\nimport FinancialStat from './FinancialStat';\nimport useTranslations from '../../hooks/useTranslations';\nimport useStore from '../../store/useStore';\nimport { maya, AGENT_TYPES } from '../../services/agentOrchestrator';\nimport { getLeads, getAutomationStats, subscribeToLeads, getFinancialSummary } from '../../services/api';\nimport { whatsappService } from '../../services/whatsapp';\nimport './LeadsCRM.css';\n\nconst sourceIcons = {\n  airbnb: 'üè†',\n  booking: 'üìÖ',\n  direct: 'üéØ',\n  referral: 'üë•',\n  social: 'üì±',\n};\n\nconst LeadsCRM = () => {\n  const { t } = useTranslations();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [selectedLead, setSelectedLead] = useState(null);\n  const [isScanning, setIsScanning] = useState(false);\n  const [leads, setLeads] = useState([]);\n  const [isLoadingLeads, setIsLoadingLeads] = useState(true);\n  const [financials, setFinancials] = useState(null);\n  const greetedLeadIdsRef = useRef(new Set());\n  const paymentAlertedIdsRef = useRef(new Set());\n  const {\n    addNotification,\n    lang,\n    setLeads: setStoreLeads,\n    automationStats,\n    objectionSuccess,\n    setAutomationStats,\n    setObjectionSuccess,\n    activeTenantId,\n    authToken,\n  } = useStore();\n\n  const isRTL = lang === 'he';\n\n  const statusOptions = [\n    { value: 'all', label: t('leadsCRM.status.all'), color: '#64748b' },\n    { value: 'new', label: t('leadsCRM.status.new'), color: '#3b82f6' },\n    { value: 'contacted', label: t('leadsCRM.status.contacted'), color: '#f59e0b' },\n    { value: 'qualified', label: t('leadsCRM.status.qualified'), color: '#8b5cf6' },\n    { value: 'converted', label: t('leadsCRM.status.converted'), color: '#10b981' },\n    { value: 'lost', label: t('leadsCRM.status.lost'), color: '#ef4444' },\n  ];\n\n  const leadsWithFallback = leads;\n  const filteredLeads = leadsWithFallback.filter((lead) => {\n    const matchesSearch =\n      lead.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      lead.contact.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesStatus = statusFilter === 'all' || lead.status === statusFilter;\n    return matchesSearch && matchesStatus;\n  });\n\n  const normalizeLead = (lead) => {\n    const safeLead = lead || {};\n    const fallbackId = safeLead.id || safeLead.lead_id || `${safeLead.email || safeLead.phone || Date.now()}`;\n    const name = safeLead.name || safeLead.property_name || safeLead.property || 'Unknown Property';\n    const contact = safeLead.contact || safeLead.full_name || safeLead.guest_name || 'Guest';\n    return {\n      id: fallbackId,\n      name,\n      contact,\n      email: safeLead.email || '',\n      phone: safeLead.phone || '',\n      source: safeLead.source || 'direct',\n      status: safeLead.status || 'new',\n      value: safeLead.value || 0,\n      rating: safeLead.rating || 0,\n      createdAt: safeLead.createdAt || safeLead.created_at || new Date().toISOString(),\n      notes: safeLead.notes || '',\n      photo: safeLead.photo || `https://api.dicebear.com/7.x/personas/svg?seed=${encodeURIComponent(contact)}&backgroundColor=0b1220&radius=20`,\n      property: safeLead.property || name,\n    };\n  };\n\n  useEffect(() => {\n    let isActive = true;\n    const loadLeads = async () => {\n      setIsLoadingLeads(true);\n      try {\n        const results = await getLeads(statusFilter === 'all' ? null : statusFilter);\n        const normalized = Array.isArray(results) ? results.map(normalizeLead) : [];\n        if (isActive) {\n          setLeads(normalized);\n          setStoreLeads(normalized);\n        }\n      } catch (error) {\n        console.error('Failed to load leads:', error);\n      } finally {\n        if (isActive) setIsLoadingLeads(false);\n      }\n    };\n\n    loadLeads();\n    return () => {\n      isActive = false;\n    };\n  }, [statusFilter, setStoreLeads, activeTenantId, authToken]);\n\n  useEffect(() => {\n    let isActive = true;\n    const loadFinancials = async () => {\n      try {\n        const data = await getFinancialSummary();\n        if (isActive) setFinancials(data);\n      } catch (e) {\n        if (isActive) setFinancials({ avg_ltv: '‚Ç™0', conversion_rate: '0%', projected_revenue: '‚Ç™0' });\n      }\n    };\n    loadFinancials();\n    return () => { isActive = false; };\n  }, [activeTenantId, authToken]);\n\n  useEffect(() => {\n    let isActive = true;\n    const loadAutomationStats = async () => {\n      try {\n        const statsResponse = await getAutomationStats();\n        if (!isActive) return;\n        setAutomationStats(statsResponse.automation_stats);\n        setObjectionSuccess(statsResponse.objection_success);\n      } catch (error) {\n        console.error('Failed to load automation stats:', error);\n      }\n    };\n\n    loadAutomationStats();\n    return () => {\n      isActive = false;\n    };\n  }, [setAutomationStats, setObjectionSuccess, activeTenantId, authToken]);\n\n  useEffect(() => {\n    const handleNewLead = async (incoming) => {\n      const normalized = normalizeLead(incoming);\n      setLeads((prev) => {\n        const nextLeads = [normalized, ...prev];\n        setStoreLeads(nextLeads);\n        return nextLeads;\n      });\n\n      if (!greetedLeadIdsRef.current.has(normalized.id)) {\n        greetedLeadIdsRef.current.add(normalized.id);\n        try {\n          await whatsappService.sendLeadGreeting(normalized, lang);\n          addNotification({\n            type: 'success',\n            title: t('leadsCRM.actions.sendDemo'),\n            message: t('leadsCRM.autoGreetingSent', { name: normalized.contact }),\n          });\n        } catch (error) {\n          console.error('Failed to send greeting:', error);\n        }\n      }\n    };\n\n    const handleLeadUpdated = (incoming) => {\n      const normalized = normalizeLead(incoming);\n    const hasPaymentLink = Boolean(normalized.payment_link);\n    const isPaid = normalized.status === 'paid';\n    if ((hasPaymentLink || isPaid) && !paymentAlertedIdsRef.current.has(normalized.id)) {\n      paymentAlertedIdsRef.current.add(normalized.id);\n      addNotification({\n        type: 'warning',\n        title: t('notifications.paymentLinkReady', { defaultValue: 'Payment Link Ready' }),\n        message: t('notifications.paymentLinkMessage', {\n          defaultValue: `${normalized.contact || normalized.name} is ready to finalize payment.`,\n        }),\n      });\n    }\n      setLeads((prev) => {\n        const nextLeads = prev.map((lead) =>\n          lead.id === normalized.id ? { ...lead, ...normalized } : lead\n        );\n        setStoreLeads(nextLeads);\n        return nextLeads;\n      });\n    };\n\n    const handleAutomationStats = (statsUpdate) => {\n      setAutomationStats(statsUpdate);\n    };\n\n    const eventSource = subscribeToLeads(\n      handleNewLead,\n      handleLeadUpdated,\n      (error) => {\n        console.error('Lead stream error:', error);\n      },\n      handleAutomationStats\n    );\n\n    return () => {\n      if (eventSource && eventSource.close) eventSource.close();\n    };\n  }, [addNotification, lang, setAutomationStats, setStoreLeads, t, activeTenantId, authToken]);\n\n  const handleScanLeads = async () => {\n    setIsScanning(true);\n    try {\n      const result = await maya.executeTask(AGENT_TYPES.SCRAPER, {\n        platforms: ['airbnb', 'booking'],\n      });\n      \n      addNotification({\n        type: 'success',\n        title: t('leadsCRM.scanNew'),\n        message: result.message,\n      });\n\n      if (result.leads && result.leads.length > 0) {\n        result.leads.slice(0, 3).forEach((lead) => {\n          addNotification({\n            type: 'info',\n            title: t('notifications.newLead'),\n            messageKey: 'notifications.messages.newLead',\n            messageValues: { platform: lead.platform || 'Airbnb' },\n            data: lead,\n          });\n        });\n      }\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Error',\n        message: 'Lead scan failed',\n      });\n    } finally {\n      setIsScanning(false);\n    }\n  };\n\n  const handleSendDemo = async (lead) => {\n    try {\n      const result = await maya.executeTask(AGENT_TYPES.SALES, {\n        type: 'send_demo',\n        lead,\n      });\n      \n      addNotification({\n        type: 'success',\n        title: t('leadsCRM.actions.sendDemo'),\n        message: result.message,\n      });\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Error',\n        message: 'Demo send failed',\n      });\n    }\n  };\n\n  const getStatusColor = (status) => {\n    return statusOptions.find((s) => s.value === status)?.color || '#64748b';\n  };\n\n  const getStatusLabel = (status) => {\n    return statusOptions.find((s) => s.value === status)?.label || status;\n  };\n\n  const objectionMetrics = ['price', 'location', 'rules'].map((key) => {\n    const stats = objectionSuccess?.[key] || { yes: 0, no: 0 };\n    const total = stats.yes + stats.no;\n    const rate = total > 0 ? Math.round((stats.yes / total) * 100) : 0;\n    return {\n      key,\n      label: key === 'price' ? 'Price' : key === 'location' ? 'Location' : 'Rules',\n      yes: stats.yes,\n      no: stats.no,\n      rate,\n    };\n  });\n\n  return (\n    <div className=\"crm-container\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Financial Stats */}\n      <div className=\"mb-10\">\n        <h1 className=\"text-3xl font-black text-gray-900 mb-1\">Leads & Revenue</h1>\n        <p className=\"text-gray-500\">◊û◊¢◊ß◊ë ◊ê◊ó◊®◊ô ◊î◊û◊®◊î ◊ï◊®◊ï◊ï◊ó◊ô◊ï◊™ ◊î◊†◊õ◊°◊ô◊ù ◊©◊ú◊ö.</p>\n      </div>\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-10\">\n        <FinancialStat\n          label=\"LTV ◊û◊û◊ï◊¶◊¢\"\n          value={financials?.avg_ltv ?? '‚Ç™0'}\n          trend=\"\"\n          icon={Users}\n        />\n        <FinancialStat\n          label=\"◊ô◊ó◊° ◊î◊û◊®◊î\"\n          value={financials?.conversion_rate ?? '0%'}\n          trend=\"\"\n          icon={Target}\n        />\n        <FinancialStat\n          label=\"◊®◊ï◊ï◊ó ◊™◊§◊¢◊ï◊ú◊ô\"\n          value={financials?.projected_revenue ?? '‚Ç™0'}\n          trend=\"\"\n          icon={BarChart3}\n        />\n        <FinancialStat\n          label=\"◊¢◊ú◊ï◊™ ◊†◊ô◊ß◊ô◊ï◊ü ◊û◊û◊ï◊¶◊¢◊™\"\n          value=\"‚Ç™350\"\n          trend=\"-2%\"\n          icon={Activity}\n        />\n      </div>\n\n      {/* Header */}\n      <div className=\"crm-header\">\n        <div className=\"crm-title\">\n          <Users size={28} />\n          <div>\n            <h2>{t('leadsCRM.title')}</h2>\n            <p>{t('leadsCRM.leadCount', { count: filteredLeads.length })}</p>\n          </div>\n        </div>\n        <button\n          onClick={handleScanLeads}\n          disabled={isScanning}\n          className=\"btn-primary scan-btn\"\n        >\n          {isScanning ? (\n            <>\n              <Search size={18} className=\"animate-spin\" />\n              {t('common.scanning')}\n            </>\n          ) : (\n            <>\n              <Search size={18} />\n              {t('leadsCRM.scanNew')}\n            </>\n          )}\n        </button>\n      </div>\n\n      {/* Filters */}\n      <div className=\"crm-filters glass-card\">\n        <div className=\"search-box\">\n          <Search size={18} />\n          <input\n            type=\"text\"\n            placeholder={t('leadsCRM.searchPlaceholder')}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n          />\n        </div>\n        <div className=\"status-filters\">\n          {statusOptions.map((status) => (\n            <button\n              key={status.value}\n              onClick={() => setStatusFilter(status.value)}\n              className={`status-filter-btn ${\n                statusFilter === status.value ? 'active' : ''\n              }`}\n              style={{\n                '--status-color': status.color,\n              }}\n            >\n              {status.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* ◊ú◊ô◊ì◊ô◊ù ◊ê◊ó◊®◊ï◊†◊ô◊ù ◊û◊î-Scraper */}\n      <div className=\"bg-white rounded-[40px] border border-gray-100 shadow-sm overflow-hidden mb-10\">\n        <div className=\"p-6 border-b border-gray-100 bg-gray-50/50\">\n          <h4 className=\"font-bold text-gray-800\">◊ú◊ô◊ì◊ô◊ù ◊ê◊ó◊®◊ï◊†◊ô◊ù ◊û◊î-Scraper</h4>\n        </div>\n        {isLoadingLeads ? (\n          <div className=\"p-12 text-center text-gray-400\">◊ò◊ï◊¢◊ü ◊ú◊ô◊ì◊ô◊ù...</div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-right min-w-[500px]\">\n              <thead>\n                <tr className=\"text-gray-400 text-xs uppercase tracking-wider\">\n                  <th className=\"p-6\">◊û◊ß◊ï◊®</th>\n                  <th className=\"p-6\">◊©◊ù ◊î◊†◊õ◊°</th>\n                  <th className=\"p-6\">◊°◊ò◊ò◊ï◊° ◊î◊û◊®◊î</th>\n                  <th className=\"p-6\">◊§◊ï◊ò◊†◊¶◊ô◊ê◊ú ◊î◊õ◊†◊°◊î</th>\n                  <th className=\"p-6 w-0\" />\n                </tr>\n              </thead>\n              <tbody className=\"text-sm\">\n                {filteredLeads.slice(0, 10).map((lead) => (\n                  <tr\n                    key={lead.id}\n                    className=\"border-t border-gray-50 hover:bg-gray-50/50 transition-colors cursor-pointer\"\n                    onClick={() => setSelectedLead(lead)}\n                  >\n                    <td className=\"p-6 font-bold text-blue-600\">{lead.source || 'direct'}</td>\n                    <td className=\"p-6 text-gray-800\">{lead.name}</td>\n                    <td className=\"p-6\">\n                      <span\n                        className=\"px-3 py-1 rounded-full text-[10px] font-bold\"\n                        style={{\n                          backgroundColor: `${getStatusColor(lead.status)}20`,\n                          color: getStatusColor(lead.status),\n                        }}\n                      >\n                        {getStatusLabel(lead.status).toUpperCase()}\n                      </span>\n                    </td>\n                    <td className=\"p-6 font-black\">‚Ç™{Number(lead.value || 0).toLocaleString()}</td>\n                    <td className=\"p-2\">\n                      <button\n                        type=\"button\"\n                        className=\"p-2 text-gray-400 hover:text-blue-600\"\n                        onClick={(e) => { e.stopPropagation(); setSelectedLead(lead); }}\n                      >\n                        <ArrowUpRight size={16} />\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n            {filteredLeads.length === 0 && (\n              <div className=\"p-12 text-center text-gray-400\">◊ê◊ô◊ü ◊ú◊ô◊ì◊ô◊ù ◊ú◊î◊¶◊í◊î</div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Stats Row */}\n      <div className=\"crm-stats\">\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value text-gradient\">\n            {leadsWithFallback.filter((l) => l.status === 'new').length}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.newLeads')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#f59e0b' }}>\n            {leadsWithFallback.filter((l) => l.status === 'contacted').length}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.inProgress')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#8b5cf6' }}>\n            {leadsWithFallback.filter((l) => l.status === 'qualified').length}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.qualified')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#10b981' }}>\n            ‚Ç™{leadsWithFallback.reduce((sum, l) => sum + l.value, 0).toLocaleString()}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.totalValue')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#38bdf8' }}>\n            {automationStats?.automated_messages ?? 0}\n          </span>\n          <span className=\"stat-label\">AI Messages</span>\n        </div>\n      </div>\n\n      {/* Success Meter */}\n      <div className=\"success-meter glass-card\">\n        <div className=\"success-meter-header\">\n          <h3>Success Meter</h3>\n          <span className=\"success-meter-subtitle\">Objection conversion performance</span>\n        </div>\n        <div className=\"success-meter-grid\">\n          {objectionMetrics.map((metric) => (\n            <div key={metric.key} className=\"success-meter-item\">\n              <div className=\"success-meter-label\">\n                <span>{metric.label}</span>\n                <span>{metric.rate}%</span>\n              </div>\n              <div className=\"success-meter-bar\">\n                <span style={{ width: `${metric.rate}%` }} />\n              </div>\n              <div className=\"success-meter-meta\">\n                <span>Yes: {metric.yes}</span>\n                <span>No: {metric.no}</span>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Leads Grid */}\n      <div className=\"leads-grid\">\n        {filteredLeads.map((lead) => (\n          <div\n            key={lead.id}\n            className=\"lead-card glass-card\"\n            onClick={() => setSelectedLead(lead)}\n          >\n              <div className=\"lead-card-header\">\n                <div\n                  className=\"lead-avatar\"\n                  style={{ backgroundImage: `url(${lead.photo})` }}\n                />\n                <div className=\"lead-header-info\">\n                  <span className=\"lead-name\">{lead.name}</span>\n                  <span className=\"lead-contact\">{lead.contact}</span>\n                </div>\n                <span\n                  className=\"lead-status\"\n                  style={{\n                    '--status-color': getStatusColor(lead.status),\n                    boxShadow: `0 0 16px ${getStatusColor(lead.status)}`,\n                  }}\n                >\n                  {getStatusLabel(lead.status)}\n                </span>\n              </div>\n\n              <div className=\"lead-card-body\">\n                <div className=\"lead-meta-grid\">\n                  <div className=\"lead-meta-item\">\n                    <span className=\"meta-label\">{t('leadsCRM.table.source')}</span>\n                    <span className=\"meta-value\">{sourceIcons[lead.source]} {lead.source}</span>\n                  </div>\n                  <div className=\"lead-meta-item\">\n                    <span className=\"meta-label\">{t('leadsCRM.table.value')}</span>\n                    <span className=\"meta-value\">‚Ç™{lead.value.toLocaleString()} <span className=\"per-night\">{t('leadsCRM.perNight')}</span></span>\n                  </div>\n                  <div className=\"lead-meta-item\">\n                    <span className=\"meta-label\">{t('leadsCRM.table.rating')}</span>\n                    <span className=\"meta-value rating\">\n                      <Star size={14} fill=\"#fbbf24\" color=\"#fbbf24\" />\n                      {lead.rating}\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"lead-card-actions\">\n                <button\n                  className=\"lead-action whatsapp\"\n                  title=\"WhatsApp\"\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  <MessageCircle size={16} />\n                </button>\n                <button\n                  className=\"lead-action call\"\n                  title={t('leadsCRM.actions.call')}\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  <Phone size={16} />\n                </button>\n              </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Lead Detail Modal */}\n      {selectedLead && (\n        <div\n          className=\"lead-modal-backdrop\"\n          onClick={() => setSelectedLead(null)}\n        >\n          <div\n            className=\"lead-modal glass-card\"\n            onClick={(e) => e.stopPropagation()}\n          >\n              <div className=\"lead-modal-header\">\n                <div className=\"lead-info\">\n                  <span className=\"source-icon large\">\n                    {sourceIcons[selectedLead.source]}\n                  </span>\n                  <div>\n                    <h3>{selectedLead.name}</h3>\n                    <p>{selectedLead.contact}</p>\n                  </div>\n                </div>\n                <button\n                  onClick={() => setSelectedLead(null)}\n                  className=\"close-modal-btn\"\n                >\n                  √ó\n                </button>\n              </div>\n\n              <div className=\"lead-modal-content\">\n                <div className=\"lead-details-grid\">\n                  <div className=\"detail-item\">\n                    <Mail size={18} />\n                    <div>\n                    <span className=\"label\">{t('leadsCRM.modal.email')}</span>\n                      <span className=\"value\">{selectedLead.email}</span>\n                    </div>\n                  </div>\n                  <div className=\"detail-item\">\n                    <Phone size={18} />\n                    <div>\n                  <span className=\"label\">{t('leadsCRM.modal.phone')}</span>\n                      <span className=\"value\">{selectedLead.phone}</span>\n                    </div>\n                  </div>\n                  <div className=\"detail-item\">\n                    <Globe size={18} />\n                    <div>\n                  <span className=\"label\">{t('leadsCRM.modal.source')}</span>\n                      <span className=\"value\">{selectedLead.source}</span>\n                    </div>\n                  </div>\n                  <div className=\"detail-item\">\n                    <Calendar size={18} />\n                    <div>\n                  <span className=\"label\">{t('leadsCRM.modal.createdAt')}</span>\n                      <span className=\"value\">\n                    {new Date(selectedLead.createdAt).toLocaleDateString(lang === 'he' ? 'he-IL' : lang === 'el' ? 'el-GR' : 'en-US')}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"lead-notes\">\n              <h4>{t('leadsCRM.modal.notes')}</h4>\n                  <p>{selectedLead.notes}</p>\n                </div>\n\n                <div className=\"lead-actions\">\n                  <button\n                    onClick={() => handleSendDemo(selectedLead)}\n                    className=\"btn-primary\"\n                  >\n                    <Mail size={18} />\n                  {t('leadsCRM.actions.sendDemo')}\n                  </button>\n                  <button className=\"btn-secondary\">\n                    <MessageCircle size={18} />\n                  {t('leadsCRM.modal.sendMessage')}\n                  </button>\n                </div>\n              </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LeadsCRM;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}