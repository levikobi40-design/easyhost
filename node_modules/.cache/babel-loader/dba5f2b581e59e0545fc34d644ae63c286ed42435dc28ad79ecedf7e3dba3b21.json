{"ast":null,"code":"import { API_BASE_URL as IMPORTED_API_URL } from '../utils/constants';\nimport i18n from '../i18n';\n\n/**\r\n * API service layer for backend communication\r\n * HARDCODED URL to bypass .env issues - connects to local backend\r\n */\n\n// HARDCODED API URL - fallback to local server if env not set\nconst API_BASE_URL = IMPORTED_API_URL || 'http://127.0.0.1:5000';\nconsole.log('[Easy Host AI API] Using backend URL:', API_BASE_URL);\n\n// Debug helper - logs all API requests\nconst logRequest = (method, url, payload) => {\n  console.log(`[API] ${method} ${url}`);\n  if (payload) console.log('[API] Payload:', payload);\n};\nconst logResponse = (url, status, data) => {\n  console.log(`[API] Response from ${url}:`, status, data);\n};\nconst getAuthContext = () => {\n  try {\n    var _parsed$state, _parsed$state2;\n    const raw = localStorage.getItem('hotel-enterprise-storage');\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return {\n      token: parsed === null || parsed === void 0 ? void 0 : (_parsed$state = parsed.state) === null || _parsed$state === void 0 ? void 0 : _parsed$state.authToken,\n      tenantId: parsed === null || parsed === void 0 ? void 0 : (_parsed$state2 = parsed.state) === null || _parsed$state2 === void 0 ? void 0 : _parsed$state2.activeTenantId\n    };\n  } catch (error) {\n    return {};\n  }\n};\nconst getAuthHeaders = () => {\n  const {\n    token,\n    tenantId\n  } = getAuthContext();\n  const headers = {};\n  if (token) headers.Authorization = `Bearer ${token}`;\n  if (tenantId) headers['X-Tenant-Id'] = tenantId;\n  return headers;\n};\n\n/**\r\n * Health check - get server status\r\n * @returns {Promise<object>} { ok, status, openai_configured, sse_clients }\r\n */\nexport const getHealth = async () => {\n  const url = `${API_BASE_URL}/health`;\n  logRequest('GET', url);\n  try {\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      console.error(`[API] Health check failed: HTTP ${response.status}`);\n      throw new Error('Health check failed');\n    }\n    const data = await response.json();\n    logResponse(url, response.status, data);\n    return data;\n  } catch (error) {\n    console.error('[API] Error checking health:', error);\n    throw error;\n  }\n};\nexport const getDemoAuthToken = async tenantId => {\n  const url = `${API_BASE_URL}/api/auth/demo`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      tenant_id: tenantId\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to get demo token');\n  }\n  return await response.json();\n};\nexport const getPilotAccessToken = async tenantName => {\n  const url = `${API_BASE_URL}/api/auth/pilot`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      tenant_name: tenantName\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to get pilot token');\n  }\n  return await response.json();\n};\nexport const connectCalendar = async (icalUrl, nightlyRate) => {\n  const url = `${API_BASE_URL}/api/onboarding/ical`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      ical_url: icalUrl,\n      nightly_rate: nightlyRate\n    })\n  });\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(errorText || 'Failed to sync calendar');\n  }\n  return await response.json();\n};\nexport const getCalendarStatus = async () => {\n  const url = `${API_BASE_URL}/api/onboarding/status`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch calendar status');\n  }\n  return await response.json();\n};\nexport const setWorkerLanguage = async language => {\n  const url = `${API_BASE_URL}/api/worker/language`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      language\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to set worker language');\n  }\n  return await response.json();\n};\nexport const getMessages = async (limit = 50) => {\n  const url = `${API_BASE_URL}/api/messages?limit=${limit}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch messages');\n  }\n  return await response.json();\n};\nexport const clockInStaff = async payload => {\n  const url = `${API_BASE_URL}/api/staff/clock-in`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(payload)\n  });\n  if (!response.ok) {\n    throw new Error('Failed to clock in staff');\n  }\n  return await response.json();\n};\nexport const clockOutStaff = async staffId => {\n  const url = `${API_BASE_URL}/api/staff/clock-out`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      staff_id: staffId\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to clock out staff');\n  }\n  return await response.json();\n};\nexport const getStaffList = async () => {\n  const url = `${API_BASE_URL}/api/staff`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch staff');\n  }\n  return await response.json();\n};\nexport const toggleStaffActive = async (staffId, active) => {\n  const url = `${API_BASE_URL}/api/staff/${staffId}/active`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      active\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to toggle staff');\n  }\n  return await response.json();\n};\nexport const getLeaderboard = async () => {\n  const url = `${API_BASE_URL}/api/staff/leaderboard`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch leaderboard');\n  }\n  return await response.json();\n};\nexport const getStaffTasks = async staffId => {\n  const url = `${API_BASE_URL}/api/staff/tasks?staff_id=${encodeURIComponent(staffId)}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch tasks');\n  }\n  return await response.json();\n};\nexport const updateStaffTaskStatus = async (taskId, status) => {\n  const url = `${API_BASE_URL}/api/staff/tasks/${taskId}/status`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      status\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update task');\n  }\n  return await response.json();\n};\nexport const endShiftStaff = async staffId => {\n  const url = `${API_BASE_URL}/api/staff/${staffId}/end-shift`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to end shift');\n  }\n  return await response.json();\n};\nexport const updateStaffPhoto = async (staffId, photoUrl) => {\n  const url = `${API_BASE_URL}/api/staff/${staffId}/photo`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      photo_url: photoUrl\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update staff photo');\n  }\n  return await response.json();\n};\nexport const getDispatchStatus = async () => {\n  const url = `${API_BASE_URL}/api/dispatch/status`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch dispatch status');\n  }\n  return await response.json();\n};\nexport const setDispatchStatus = async (enabled, intervalSeconds) => {\n  const url = `${API_BASE_URL}/api/dispatch/status`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      enabled,\n      interval_seconds: intervalSeconds\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update dispatch status');\n  }\n  return await response.json();\n};\n\n/**\r\n * Send an AI action request\r\n * @param {string} type - Action type (e.g., 'checkout', 'towels', 'restaurant')\r\n * @param {string} room - Room identifier\r\n * @param {string} role - User role ('owner', 'staff', 'guest')\r\n * @param {string} lang - Language code\r\n * @returns {Promise<object>} Response with { success, intent, draft, auto_send, is_safe }\r\n */\nexport const sendAIAction = async (type, room, role, lang) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/ai_action`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        type,\n        room,\n        role,\n        lang\n      })\n    });\n    if (!response.ok) {\n      throw new Error('Failed to send AI action');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error sending AI action:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Create a new booking\r\n * @param {object} bookingData - Booking data { room_name, customer_name }\r\n * @returns {Promise<object>}\r\n */\nexport const createBooking = async bookingData => {\n  const url = `${API_BASE_URL}/api/book`;\n  logRequest('POST', url, bookingData);\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(bookingData)\n    });\n    const responseText = await response.text();\n    console.log(`[API] createBooking response: status=${response.status}, body=${responseText}`);\n    if (!response.ok) {\n      throw new Error(`Failed to create booking: HTTP ${response.status}`);\n    }\n    return JSON.parse(responseText);\n  } catch (error) {\n    console.error('[API] Error creating booking:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Get all bookings\r\n * @returns {Promise<Array>}\r\n */\nexport const getBookings = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/bookings`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch bookings');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching bookings:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Get AI insights\r\n * Returns fallback message if OpenAI not configured on backend\r\n * @returns {Promise<object>} { insight, bookings_count }\r\n */\nexport const getAIInsights = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/ai-insights`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch AI insights');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching AI insights:', error);\n    // Return fallback insight on error\n    return {\n      insight: i18n.t('common.readyToHelp'),\n      bookings_count: 0\n    };\n  }\n};\n\n/**\r\n * Get latest booking info (for polling fallback)\r\n * @returns {Promise<object>} { latest_id, latest_room, latest_customer, latest_time, total_count }\r\n */\nexport const getLatestBooking = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/bookings/latest`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch latest booking');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching latest booking:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Get daily ROI report\r\n * @returns {Promise<object>}\r\n */\nexport const getDailyReport = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/reports/daily`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch daily report');\n    }\n    const data = await response.json();\n    return data.report || data;\n  } catch (error) {\n    console.error('Error fetching daily report:', error);\n    return {\n      date: new Date().toISOString().split('T')[0],\n      roi_metrics: {\n        hours_saved: 0,\n        cleanings_triggered: 0,\n        leads_captured: 0\n      },\n      recommendations: [],\n      agent_performance: [],\n      savings: {\n        automation_rate: 0\n      }\n    };\n  }\n};\n\n/**\r\n * Get automation stats (messages sent, last scan, objection success)\r\n * @returns {Promise<object>}\r\n */\nexport const getAutomationStats = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/stats`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch automation stats');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching automation stats:', error);\n    return {\n      automation_stats: {\n        automated_messages: 0,\n        last_scan: null,\n        leads_total: 0\n      },\n      objection_success: {}\n    };\n  }\n};\n\n/**\r\n * Send welcome WhatsApp message for a lead\r\n * @param {string} leadId\r\n * @returns {Promise<object>}\r\n */\nexport const sendWelcomeMessage = async leadId => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/whatsapp/welcome`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        lead_id: leadId\n      })\n    });\n    if (!response.ok) {\n      throw new Error('Failed to send welcome message');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error sending welcome message:', error);\n    throw error;\n  }\n};\n\n// ============== Leads API ==============\n\n/**\r\n * Create a new lead\r\n * @param {object} leadData - { name, email, phone, guests, checkin, checkout, source }\r\n * @returns {Promise<object>} { success, id, score }\r\n */\nexport const createLead = async leadData => {\n  const url = `${API_BASE_URL}/api/leads`;\n  logRequest('POST', url, leadData);\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      },\n      body: JSON.stringify(leadData)\n    });\n    const responseText = await response.text();\n    console.log(`[API] createLead response: status=${response.status}, body=${responseText}`);\n    if (!response.ok) {\n      throw new Error(`Failed to create lead: HTTP ${response.status}`);\n    }\n    return JSON.parse(responseText);\n  } catch (error) {\n    console.error('[API] Error creating lead:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Get all leads\r\n * @param {string} status - Optional status filter ('new', 'contacted', 'qualified', 'booked', 'lost')\r\n * @returns {Promise<Array>}\r\n */\nexport const getLeads = async (status = null) => {\n  const url = status ? `${API_BASE_URL}/api/leads?status=${status}` : `${API_BASE_URL}/api/leads`;\n  logRequest('GET', url);\n  try {\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      console.error(`[API] getLeads failed: HTTP ${response.status}`);\n      throw new Error('Failed to fetch leads');\n    }\n    const data = await response.json();\n\n    // IMPORTANT: Ensure we always return an array\n    if (Array.isArray(data)) {\n      console.log(`[API] getLeads: received ${data.length} leads`);\n      return data;\n    } else if (data && typeof data === 'object') {\n      // If backend returns a single object, wrap it in an array\n      console.warn('[API] getLeads: received object instead of array, wrapping');\n      return [data];\n    } else {\n      console.warn('[API] getLeads: unexpected response format, returning empty array');\n      return [];\n    }\n  } catch (error) {\n    console.error('[API] Error fetching leads:', error);\n    // Return empty array on error instead of throwing\n    return [];\n  }\n};\n\n/**\r\n * Get a single lead by ID\r\n * @param {number} leadId - Lead ID\r\n * @returns {Promise<object>}\r\n */\nexport const getLead = async leadId => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/leads/${leadId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch lead');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching lead:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Get leads statistics\r\n * @returns {Promise<object>} { total, new, contacted, qualified, won, lost, avg_score }\r\n */\nexport const getLeadsStats = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/leads/stats`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch leads stats');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching leads stats:', error);\n    // Return default stats on error\n    return {\n      total: 0,\n      new: 0,\n      contacted: 0,\n      qualified: 0,\n      won: 0,\n      lost: 0,\n      avg_score: 0\n    };\n  }\n};\n\n/**\r\n * Update lead status, score, or notes\r\n * @param {number} leadId - Lead ID\r\n * @param {object} data - { status, score, notes }\r\n * @returns {Promise<object>}\r\n */\nexport const updateLead = async (leadId, data) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/leads/${leadId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      },\n      body: JSON.stringify(data)\n    });\n    if (!response.ok) {\n      throw new Error('Failed to update lead');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error updating lead:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Update room status or details\r\n * @param {number} roomId\r\n * @param {object} data\r\n * @returns {Promise<object>}\r\n */\nexport const updateRoomStatus = async (roomId, data) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/api/rooms/${roomId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    });\n    if (!response.ok) {\n      throw new Error('Failed to update room');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error updating room:', error);\n    throw error;\n  }\n};\n\n/**\r\n * Subscribe to leads SSE stream\r\n * @param {function} onNewLead - Callback for new lead events\r\n * @param {function} onLeadUpdated - Callback for lead updated events\r\n * @param {function} onError - Callback for errors\r\n * @returns {EventSource} - The event source (call .close() to disconnect)\r\n */\nexport const subscribeToLeads = (onNewLead, onLeadUpdated, onError, onAutomationStats) => {\n  const {\n    token,\n    tenantId\n  } = getAuthContext();\n  const query = new URLSearchParams();\n  if (token) query.set('token', token);\n  if (tenantId) query.set('tenant_id', tenantId);\n  const url = `${API_BASE_URL}/api/stream/leads?${query.toString()}`;\n  const eventSource = new EventSource(url);\n  eventSource.addEventListener('new_lead', event => {\n    try {\n      const lead = JSON.parse(event.data);\n      onNewLead(lead);\n    } catch (e) {\n      console.error('Error parsing lead event:', e);\n    }\n  });\n  eventSource.addEventListener('lead_updated', event => {\n    try {\n      const lead = JSON.parse(event.data);\n      if (onLeadUpdated) onLeadUpdated(lead);\n    } catch (e) {\n      console.error('Error parsing lead_updated event:', e);\n    }\n  });\n  eventSource.addEventListener('automation_stats', event => {\n    try {\n      const stats = JSON.parse(event.data);\n      if (onAutomationStats) onAutomationStats(stats);\n    } catch (e) {\n      console.error('Error parsing automation_stats event:', e);\n    }\n  });\n  eventSource.addEventListener('connected', event => {\n    console.log('Connected to leads stream:', event.data);\n  });\n  eventSource.onerror = error => {\n    console.error('Leads SSE error:', error);\n    if (onError) onError(error);\n  };\n  return eventSource;\n};\n\n// ============== AI Marketing Agent API ==============\n\n/**\r\n * Get AI Agent profile and capabilities\r\n */\nexport const getAgentProfile = async () => {\n  const url = `${API_BASE_URL}/api/agent/profile`;\n  logRequest('GET', url);\n  try {\n    const response = await fetch(url);\n    if (!response.ok) throw new Error('Failed to fetch agent profile');\n    return await response.json();\n  } catch (error) {\n    console.error('[API] Error fetching agent profile:', error);\n    return {\n      success: true,\n      agent: {\n        name: \"Maya\",\n        title: \"AI Marketing & Sales Agent\",\n        avatar: \"https://api.dicebear.com/7.x/personas/svg?seed=Maya&backgroundColor=667eea\"\n      },\n      capabilities: [\"Marketing\", \"Lead Generation\", \"Sales\"]\n    };\n  }\n};\n\n/**\r\n * Generate a marketing post\r\n */\nexport const generateMarketingPost = async params => {\n  const url = `${API_BASE_URL}/api/agent/generate-post`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to generate post');\n  return await response.json();\n};\n\n/**\r\n * Search for property owner leads\r\n */\nexport const searchPropertyLeads = async params => {\n  const url = `${API_BASE_URL}/api/agent/search-leads`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to search leads');\n  return await response.json();\n};\n\n/**\r\n * Draft outreach email to property owner\r\n */\nexport const draftOutreachEmail = async params => {\n  const url = `${API_BASE_URL}/api/agent/draft-email`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to draft email');\n  return await response.json();\n};\n\n/**\r\n * Generate client acquisition strategy\r\n */\nexport const generateAcquisitionStrategy = async params => {\n  const url = `${API_BASE_URL}/api/agent/acquisition-strategy`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to generate strategy');\n  return await response.json();\n};\n\n/**\r\n * Simulate publishing a post\r\n */\nexport const publishPost = async params => {\n  const url = `${API_BASE_URL}/api/agent/publish`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to publish');\n  return await response.json();\n};\n\n/**\r\n * Simulate sending an email\r\n */\nexport const sendOutreachEmail = async params => {\n  const url = `${API_BASE_URL}/api/agent/send-email`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to send email');\n  return await response.json();\n};\nexport default {\n  getHealth,\n  getDemoAuthToken,\n  getPilotAccessToken,\n  connectCalendar,\n  getCalendarStatus,\n  setWorkerLanguage,\n  getMessages,\n  clockInStaff,\n  clockOutStaff,\n  getStaffList,\n  toggleStaffActive,\n  getLeaderboard,\n  getStaffTasks,\n  updateStaffTaskStatus,\n  getDispatchStatus,\n  setDispatchStatus,\n  sendAIAction,\n  createBooking,\n  getBookings,\n  getAIInsights,\n  getLatestBooking,\n  getDailyReport,\n  getAutomationStats,\n  createLead,\n  getLeads,\n  getLead,\n  getLeadsStats,\n  updateLead,\n  updateRoomStatus,\n  subscribeToLeads,\n  getAgentProfile,\n  generateMarketingPost,\n  searchPropertyLeads,\n  draftOutreachEmail,\n  generateAcquisitionStrategy,\n  publishPost,\n  sendOutreachEmail\n};","map":{"version":3,"names":["API_BASE_URL","IMPORTED_API_URL","i18n","console","log","logRequest","method","url","payload","logResponse","status","data","getAuthContext","_parsed$state","_parsed$state2","raw","localStorage","getItem","parsed","JSON","parse","token","state","authToken","tenantId","activeTenantId","error","getAuthHeaders","headers","Authorization","getHealth","response","fetch","ok","Error","json","getDemoAuthToken","body","stringify","tenant_id","getPilotAccessToken","tenantName","tenant_name","connectCalendar","icalUrl","nightlyRate","ical_url","nightly_rate","errorText","text","getCalendarStatus","setWorkerLanguage","language","getMessages","limit","clockInStaff","clockOutStaff","staffId","staff_id","getStaffList","toggleStaffActive","active","getLeaderboard","getStaffTasks","encodeURIComponent","updateStaffTaskStatus","taskId","endShiftStaff","updateStaffPhoto","photoUrl","photo_url","getDispatchStatus","setDispatchStatus","enabled","intervalSeconds","interval_seconds","sendAIAction","type","room","role","lang","createBooking","bookingData","responseText","getBookings","getAIInsights","insight","t","bookings_count","getLatestBooking","getDailyReport","report","date","Date","toISOString","split","roi_metrics","hours_saved","cleanings_triggered","leads_captured","recommendations","agent_performance","savings","automation_rate","getAutomationStats","automation_stats","automated_messages","last_scan","leads_total","objection_success","sendWelcomeMessage","leadId","lead_id","createLead","leadData","getLeads","Array","isArray","length","warn","getLead","getLeadsStats","total","new","contacted","qualified","won","lost","avg_score","updateLead","updateRoomStatus","roomId","subscribeToLeads","onNewLead","onLeadUpdated","onError","onAutomationStats","query","URLSearchParams","set","toString","eventSource","EventSource","addEventListener","event","lead","e","stats","onerror","getAgentProfile","success","agent","name","title","avatar","capabilities","generateMarketingPost","params","searchPropertyLeads","draftOutreachEmail","generateAcquisitionStrategy","publishPost","sendOutreachEmail"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/services/api.js"],"sourcesContent":["import { API_BASE_URL as IMPORTED_API_URL } from '../utils/constants';\r\nimport i18n from '../i18n';\r\n\r\n/**\r\n * API service layer for backend communication\r\n * HARDCODED URL to bypass .env issues - connects to local backend\r\n */\r\n\r\n// HARDCODED API URL - fallback to local server if env not set\r\nconst API_BASE_URL = IMPORTED_API_URL || 'http://127.0.0.1:5000';\r\n\r\nconsole.log('[Easy Host AI API] Using backend URL:', API_BASE_URL);\r\n\r\n// Debug helper - logs all API requests\r\nconst logRequest = (method, url, payload) => {\r\n  console.log(`[API] ${method} ${url}`);\r\n  if (payload) console.log('[API] Payload:', payload);\r\n};\r\n\r\nconst logResponse = (url, status, data) => {\r\n  console.log(`[API] Response from ${url}:`, status, data);\r\n};\r\n\r\nconst getAuthContext = () => {\r\n  try {\r\n    const raw = localStorage.getItem('hotel-enterprise-storage');\r\n    if (!raw) return {};\r\n    const parsed = JSON.parse(raw);\r\n    return {\r\n      token: parsed?.state?.authToken,\r\n      tenantId: parsed?.state?.activeTenantId,\r\n    };\r\n  } catch (error) {\r\n    return {};\r\n  }\r\n};\r\n\r\nconst getAuthHeaders = () => {\r\n  const { token, tenantId } = getAuthContext();\r\n  const headers = {};\r\n  if (token) headers.Authorization = `Bearer ${token}`;\r\n  if (tenantId) headers['X-Tenant-Id'] = tenantId;\r\n  return headers;\r\n};\r\n\r\n/**\r\n * Health check - get server status\r\n * @returns {Promise<object>} { ok, status, openai_configured, sse_clients }\r\n */\r\nexport const getHealth = async () => {\r\n  const url = `${API_BASE_URL}/health`;\r\n  logRequest('GET', url);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      console.error(`[API] Health check failed: HTTP ${response.status}`);\r\n      throw new Error('Health check failed');\r\n    }\r\n\r\n    const data = await response.json();\r\n    logResponse(url, response.status, data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error('[API] Error checking health:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getDemoAuthToken = async (tenantId) => {\r\n  const url = `${API_BASE_URL}/api/auth/demo`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ tenant_id: tenantId }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to get demo token');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getPilotAccessToken = async (tenantName) => {\r\n  const url = `${API_BASE_URL}/api/auth/pilot`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ tenant_name: tenantName }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to get pilot token');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const connectCalendar = async (icalUrl, nightlyRate) => {\r\n  const url = `${API_BASE_URL}/api/onboarding/ical`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ ical_url: icalUrl, nightly_rate: nightlyRate }),\r\n  });\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    throw new Error(errorText || 'Failed to sync calendar');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getCalendarStatus = async () => {\r\n  const url = `${API_BASE_URL}/api/onboarding/status`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch calendar status');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const setWorkerLanguage = async (language) => {\r\n  const url = `${API_BASE_URL}/api/worker/language`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ language }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to set worker language');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getMessages = async (limit = 50) => {\r\n  const url = `${API_BASE_URL}/api/messages?limit=${limit}`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch messages');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const clockInStaff = async (payload) => {\r\n  const url = `${API_BASE_URL}/api/staff/clock-in`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify(payload),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to clock in staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const clockOutStaff = async (staffId) => {\r\n  const url = `${API_BASE_URL}/api/staff/clock-out`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ staff_id: staffId }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to clock out staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getStaffList = async () => {\r\n  const url = `${API_BASE_URL}/api/staff`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const toggleStaffActive = async (staffId, active) => {\r\n  const url = `${API_BASE_URL}/api/staff/${staffId}/active`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ active }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to toggle staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getLeaderboard = async () => {\r\n  const url = `${API_BASE_URL}/api/staff/leaderboard`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch leaderboard');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getStaffTasks = async (staffId) => {\r\n  const url = `${API_BASE_URL}/api/staff/tasks?staff_id=${encodeURIComponent(staffId)}`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch tasks');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const updateStaffTaskStatus = async (taskId, status) => {\r\n  const url = `${API_BASE_URL}/api/staff/tasks/${taskId}/status`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ status }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update task');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const endShiftStaff = async (staffId) => {\r\n  const url = `${API_BASE_URL}/api/staff/${staffId}/end-shift`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to end shift');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const updateStaffPhoto = async (staffId, photoUrl) => {\r\n  const url = `${API_BASE_URL}/api/staff/${staffId}/photo`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ photo_url: photoUrl }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update staff photo');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getDispatchStatus = async () => {\r\n  const url = `${API_BASE_URL}/api/dispatch/status`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch dispatch status');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const setDispatchStatus = async (enabled, intervalSeconds) => {\r\n  const url = `${API_BASE_URL}/api/dispatch/status`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ enabled, interval_seconds: intervalSeconds }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update dispatch status');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Send an AI action request\r\n * @param {string} type - Action type (e.g., 'checkout', 'towels', 'restaurant')\r\n * @param {string} room - Room identifier\r\n * @param {string} role - User role ('owner', 'staff', 'guest')\r\n * @param {string} lang - Language code\r\n * @returns {Promise<object>} Response with { success, intent, draft, auto_send, is_safe }\r\n */\r\nexport const sendAIAction = async (type, room, role, lang) => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/ai_action`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ type, room, role, lang }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to send AI action');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error sending AI action:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Create a new booking\r\n * @param {object} bookingData - Booking data { room_name, customer_name }\r\n * @returns {Promise<object>}\r\n */\r\nexport const createBooking = async (bookingData) => {\r\n  const url = `${API_BASE_URL}/api/book`;\r\n  logRequest('POST', url, bookingData);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(bookingData),\r\n    });\r\n\r\n    const responseText = await response.text();\r\n    console.log(`[API] createBooking response: status=${response.status}, body=${responseText}`);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to create booking: HTTP ${response.status}`);\r\n    }\r\n\r\n    return JSON.parse(responseText);\r\n  } catch (error) {\r\n    console.error('[API] Error creating booking:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get all bookings\r\n * @returns {Promise<Array>}\r\n */\r\nexport const getBookings = async () => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/bookings`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch bookings');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching bookings:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get AI insights\r\n * Returns fallback message if OpenAI not configured on backend\r\n * @returns {Promise<object>} { insight, bookings_count }\r\n */\r\nexport const getAIInsights = async () => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/ai-insights`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch AI insights');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching AI insights:', error);\r\n    // Return fallback insight on error\r\n    return {\r\n      insight: i18n.t('common.readyToHelp'),\r\n      bookings_count: 0\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get latest booking info (for polling fallback)\r\n * @returns {Promise<object>} { latest_id, latest_room, latest_customer, latest_time, total_count }\r\n */\r\nexport const getLatestBooking = async () => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/bookings/latest`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch latest booking');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching latest booking:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get daily ROI report\r\n * @returns {Promise<object>}\r\n */\r\nexport const getDailyReport = async () => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/reports/daily`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch daily report');\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.report || data;\r\n  } catch (error) {\r\n    console.error('Error fetching daily report:', error);\r\n    return {\r\n      date: new Date().toISOString().split('T')[0],\r\n      roi_metrics: {\r\n        hours_saved: 0,\r\n        cleanings_triggered: 0,\r\n        leads_captured: 0\r\n      },\r\n      recommendations: [],\r\n      agent_performance: [],\r\n      savings: { automation_rate: 0 }\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get automation stats (messages sent, last scan, objection success)\r\n * @returns {Promise<object>}\r\n */\r\nexport const getAutomationStats = async () => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/stats`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch automation stats');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching automation stats:', error);\r\n    return {\r\n      automation_stats: { automated_messages: 0, last_scan: null, leads_total: 0 },\r\n      objection_success: {},\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Send welcome WhatsApp message for a lead\r\n * @param {string} leadId\r\n * @returns {Promise<object>}\r\n */\r\nexport const sendWelcomeMessage = async (leadId) => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/whatsapp/welcome`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ lead_id: leadId }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to send welcome message');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error sending welcome message:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// ============== Leads API ==============\r\n\r\n/**\r\n * Create a new lead\r\n * @param {object} leadData - { name, email, phone, guests, checkin, checkout, source }\r\n * @returns {Promise<object>} { success, id, score }\r\n */\r\nexport const createLead = async (leadData) => {\r\n  const url = `${API_BASE_URL}/api/leads`;\r\n  logRequest('POST', url, leadData);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n      body: JSON.stringify(leadData),\r\n    });\r\n\r\n    const responseText = await response.text();\r\n    console.log(`[API] createLead response: status=${response.status}, body=${responseText}`);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to create lead: HTTP ${response.status}`);\r\n    }\r\n\r\n    return JSON.parse(responseText);\r\n  } catch (error) {\r\n    console.error('[API] Error creating lead:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get all leads\r\n * @param {string} status - Optional status filter ('new', 'contacted', 'qualified', 'booked', 'lost')\r\n * @returns {Promise<Array>}\r\n */\r\nexport const getLeads = async (status = null) => {\r\n  const url = status\r\n    ? `${API_BASE_URL}/api/leads?status=${status}`\r\n    : `${API_BASE_URL}/api/leads`;\r\n  logRequest('GET', url);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      console.error(`[API] getLeads failed: HTTP ${response.status}`);\r\n      throw new Error('Failed to fetch leads');\r\n    }\r\n\r\n    const data = await response.json();\r\n\r\n    // IMPORTANT: Ensure we always return an array\r\n    if (Array.isArray(data)) {\r\n      console.log(`[API] getLeads: received ${data.length} leads`);\r\n      return data;\r\n    } else if (data && typeof data === 'object') {\r\n      // If backend returns a single object, wrap it in an array\r\n      console.warn('[API] getLeads: received object instead of array, wrapping');\r\n      return [data];\r\n    } else {\r\n      console.warn('[API] getLeads: unexpected response format, returning empty array');\r\n      return [];\r\n    }\r\n  } catch (error) {\r\n    console.error('[API] Error fetching leads:', error);\r\n    // Return empty array on error instead of throwing\r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Get a single lead by ID\r\n * @param {number} leadId - Lead ID\r\n * @returns {Promise<object>}\r\n */\r\nexport const getLead = async (leadId) => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/leads/${leadId}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch lead');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching lead:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get leads statistics\r\n * @returns {Promise<object>} { total, new, contacted, qualified, won, lost, avg_score }\r\n */\r\nexport const getLeadsStats = async () => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/leads/stats`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch leads stats');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching leads stats:', error);\r\n    // Return default stats on error\r\n    return {\r\n      total: 0,\r\n      new: 0,\r\n      contacted: 0,\r\n      qualified: 0,\r\n      won: 0,\r\n      lost: 0,\r\n      avg_score: 0\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Update lead status, score, or notes\r\n * @param {number} leadId - Lead ID\r\n * @param {object} data - { status, score, notes }\r\n * @returns {Promise<object>}\r\n */\r\nexport const updateLead = async (leadId, data) => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/leads/${leadId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to update lead');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error updating lead:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Update room status or details\r\n * @param {number} roomId\r\n * @param {object} data\r\n * @returns {Promise<object>}\r\n */\r\nexport const updateRoomStatus = async (roomId, data) => {\r\n  try {\r\n    const response = await fetch(`${API_BASE_URL}/api/rooms/${roomId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to update room');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error updating room:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Subscribe to leads SSE stream\r\n * @param {function} onNewLead - Callback for new lead events\r\n * @param {function} onLeadUpdated - Callback for lead updated events\r\n * @param {function} onError - Callback for errors\r\n * @returns {EventSource} - The event source (call .close() to disconnect)\r\n */\r\nexport const subscribeToLeads = (onNewLead, onLeadUpdated, onError, onAutomationStats) => {\r\n  const { token, tenantId } = getAuthContext();\r\n  const query = new URLSearchParams();\r\n  if (token) query.set('token', token);\r\n  if (tenantId) query.set('tenant_id', tenantId);\r\n  const url = `${API_BASE_URL}/api/stream/leads?${query.toString()}`;\r\n  const eventSource = new EventSource(url);\r\n\r\n  eventSource.addEventListener('new_lead', (event) => {\r\n    try {\r\n      const lead = JSON.parse(event.data);\r\n      onNewLead(lead);\r\n    } catch (e) {\r\n      console.error('Error parsing lead event:', e);\r\n    }\r\n  });\r\n\r\n  eventSource.addEventListener('lead_updated', (event) => {\r\n    try {\r\n      const lead = JSON.parse(event.data);\r\n      if (onLeadUpdated) onLeadUpdated(lead);\r\n    } catch (e) {\r\n      console.error('Error parsing lead_updated event:', e);\r\n    }\r\n  });\r\n\r\n  eventSource.addEventListener('automation_stats', (event) => {\r\n    try {\r\n      const stats = JSON.parse(event.data);\r\n      if (onAutomationStats) onAutomationStats(stats);\r\n    } catch (e) {\r\n      console.error('Error parsing automation_stats event:', e);\r\n    }\r\n  });\r\n\r\n  eventSource.addEventListener('connected', (event) => {\r\n    console.log('Connected to leads stream:', event.data);\r\n  });\r\n\r\n  eventSource.onerror = (error) => {\r\n    console.error('Leads SSE error:', error);\r\n    if (onError) onError(error);\r\n  };\r\n\r\n  return eventSource;\r\n};\r\n\r\n// ============== AI Marketing Agent API ==============\r\n\r\n/**\r\n * Get AI Agent profile and capabilities\r\n */\r\nexport const getAgentProfile = async () => {\r\n  const url = `${API_BASE_URL}/api/agent/profile`;\r\n  logRequest('GET', url);\r\n\r\n  try {\r\n    const response = await fetch(url);\r\n    if (!response.ok) throw new Error('Failed to fetch agent profile');\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('[API] Error fetching agent profile:', error);\r\n    return {\r\n      success: true,\r\n      agent: {\r\n        name: \"Maya\",\r\n        title: \"AI Marketing & Sales Agent\",\r\n        avatar: \"https://api.dicebear.com/7.x/personas/svg?seed=Maya&backgroundColor=667eea\"\r\n      },\r\n      capabilities: [\"Marketing\", \"Lead Generation\", \"Sales\"]\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Generate a marketing post\r\n */\r\nexport const generateMarketingPost = async (params) => {\r\n  const url = `${API_BASE_URL}/api/agent/generate-post`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to generate post');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Search for property owner leads\r\n */\r\nexport const searchPropertyLeads = async (params) => {\r\n  const url = `${API_BASE_URL}/api/agent/search-leads`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to search leads');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Draft outreach email to property owner\r\n */\r\nexport const draftOutreachEmail = async (params) => {\r\n  const url = `${API_BASE_URL}/api/agent/draft-email`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to draft email');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Generate client acquisition strategy\r\n */\r\nexport const generateAcquisitionStrategy = async (params) => {\r\n  const url = `${API_BASE_URL}/api/agent/acquisition-strategy`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to generate strategy');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Simulate publishing a post\r\n */\r\nexport const publishPost = async (params) => {\r\n  const url = `${API_BASE_URL}/api/agent/publish`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to publish');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Simulate sending an email\r\n */\r\nexport const sendOutreachEmail = async (params) => {\r\n  const url = `${API_BASE_URL}/api/agent/send-email`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to send email');\r\n  return await response.json();\r\n};\r\n\r\nexport default {\r\n  getHealth,\r\n  getDemoAuthToken,\r\n  getPilotAccessToken,\r\n  connectCalendar,\r\n  getCalendarStatus,\r\n  setWorkerLanguage,\r\n  getMessages,\r\n  clockInStaff,\r\n  clockOutStaff,\r\n  getStaffList,\r\n  toggleStaffActive,\r\n  getLeaderboard,\r\n  getStaffTasks,\r\n  updateStaffTaskStatus,\r\n  getDispatchStatus,\r\n  setDispatchStatus,\r\n  sendAIAction,\r\n  createBooking,\r\n  getBookings,\r\n  getAIInsights,\r\n  getLatestBooking,\r\n  getDailyReport,\r\n  getAutomationStats,\r\n  createLead,\r\n  getLeads,\r\n  getLead,\r\n  getLeadsStats,\r\n  updateLead,\r\n  updateRoomStatus,\r\n  subscribeToLeads,\r\n  getAgentProfile,\r\n  generateMarketingPost,\r\n  searchPropertyLeads,\r\n  draftOutreachEmail,\r\n  generateAcquisitionStrategy,\r\n  publishPost,\r\n  sendOutreachEmail,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}