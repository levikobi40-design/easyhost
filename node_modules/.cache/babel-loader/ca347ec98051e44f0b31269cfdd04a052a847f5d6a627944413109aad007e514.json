{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\hotel_ai_assistant\\\\hotel_dashboard\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport useTranslations from './hooks/useTranslations';\nimport useStore from './store/useStore';\nimport { wsService } from './services/websocket';\nimport './styles/tailwind.css';\nimport './App.css';\nimport Layout from './components/layout/Layout';\nimport Login from './components/auth/Login';\nimport EnterpriseDashboard from './components/dashboard/EnterpriseDashboard';\nimport PremiumDashboard from './components/dashboard/PremiumDashboard';\nimport PropertiesDashboard from './components/dashboard/PropertiesDashboard';\nimport LeadsCRM from './components/crm/LeadsCRM';\nimport FieldView from './components/features/FieldView';\nimport WhatsAppMonitor from './components/operator/WhatsAppMonitor';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst parseJwtPayload = token => {\n  try {\n    const payload = token.split('.')[1];\n    const normalized = payload.replace(/-/g, '+').replace(/_/g, '/');\n    const decoded = JSON.parse(atob(normalized));\n    return decoded || {};\n  } catch (error) {\n    return {};\n  }\n};\nfunction App() {\n  _s();\n  const {\n    lang,\n    activeTenantId,\n    authToken,\n    setAuthToken,\n    setActiveTenantId,\n    role,\n    hasHydrated,\n    setLang,\n    market\n  } = useStore();\n  const {\n    i18n\n  } = useTranslations();\n  const isRTL = lang === 'he';\n  const [activeView, setActiveView] = useState('dashboard');\n  const isClockInRoute = typeof window !== 'undefined' && window.location.pathname === '/clock-in';\n  useEffect(() => {\n    // Connect to WebSocket on mount\n    wsService.connect();\n    return () => {\n      wsService.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    if (authToken) return;\n    const params = new URLSearchParams(window.location.search);\n    const tokenParam = params.get('token');\n    if (tokenParam) {\n      const payload = parseJwtPayload(tokenParam);\n      if (payload !== null && payload !== void 0 && payload.tenant_id) {\n        setActiveTenantId(payload.tenant_id);\n      }\n      setAuthToken(tokenParam);\n      params.delete('token');\n      const next = `${window.location.pathname}${params.toString() ? `?${params}` : ''}`;\n      window.history.replaceState({}, '', next);\n    }\n  }, [authToken, setAuthToken, setActiveTenantId]);\n  useEffect(() => {\n    i18n.changeLanguage(lang);\n    if (typeof document !== 'undefined') {\n      document.documentElement.dir = isRTL ? 'rtl' : 'ltr';\n      document.documentElement.lang = lang;\n    }\n  }, [i18n, isRTL, lang]);\n  useEffect(() => {\n    const marketKey = market === 'IL' ? 'IL' : 'US';\n    const allowed = marketKey === 'IL' ? ['he', 'th', 'hi'] : ['en', 'es'];\n    if (!allowed.includes(lang)) {\n      setLang(allowed[0]);\n    }\n  }, [market, lang, setLang]);\n  useEffect(() => {\n    const roleViews = {\n      host: ['dashboard', 'premium', 'properties', 'crm'],\n      operator: ['operator'],\n      field: ['field']\n    };\n    const allowed = roleViews[role] || ['dashboard'];\n    if (!allowed.includes(activeView)) {\n      setActiveView(allowed[0]);\n    }\n  }, [role, activeView]);\n  const renderRoleView = () => {\n    switch (role) {\n      case 'operator':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(LeadsCRM, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(WhatsAppMonitor, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)]\n        }, \"operator-view\", true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this);\n      case 'field':\n        return /*#__PURE__*/_jsxDEV(FieldView, {}, \"field-view\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 16\n        }, this);\n      case 'host':\n      default:\n        if (activeView === 'crm') return /*#__PURE__*/_jsxDEV(LeadsCRM, {}, \"host-crm\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 42\n        }, this);\n        if (activeView === 'premium') return /*#__PURE__*/_jsxDEV(PremiumDashboard, {}, \"host-premium\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 46\n        }, this);\n        if (activeView === 'properties') return /*#__PURE__*/_jsxDEV(PropertiesDashboard, {}, \"host-properties\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 49\n        }, this);\n        return /*#__PURE__*/_jsxDEV(EnterpriseDashboard, {}, \"host-dashboard\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  const showLogin = hasHydrated && !authToken && !isClockInRoute;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    dir: isRTL ? 'rtl' : 'ltr',\n    children: hasHydrated ? showLogin ? /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }, this) : isClockInRoute ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"clockin-shell\",\n      children: /*#__PURE__*/_jsxDEV(FieldView, {\n        clockInOnly: true,\n        autoClockInOnScan: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(Layout, {\n      activeView: activeView,\n      setActiveView: setActiveView,\n      children: renderRoleView()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }, this) : null\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"2FFjKlyN3GB0A7xmrC+TlWarxt0=\", false, function () {\n  return [useStore, useTranslations];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","useTranslations","useStore","wsService","Layout","Login","EnterpriseDashboard","PremiumDashboard","PropertiesDashboard","LeadsCRM","FieldView","WhatsAppMonitor","jsxDEV","_jsxDEV","parseJwtPayload","token","payload","split","normalized","replace","decoded","JSON","parse","atob","error","App","_s","lang","activeTenantId","authToken","setAuthToken","setActiveTenantId","role","hasHydrated","setLang","market","i18n","isRTL","activeView","setActiveView","isClockInRoute","window","location","pathname","connect","disconnect","params","URLSearchParams","search","tokenParam","get","tenant_id","delete","next","toString","history","replaceState","changeLanguage","document","documentElement","dir","marketKey","allowed","includes","roleViews","host","operator","field","renderRoleView","children","fileName","_jsxFileName","lineNumber","columnNumber","showLogin","className","clockInOnly","autoClockInOnScan","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport useTranslations from './hooks/useTranslations';\nimport useStore from './store/useStore';\nimport { wsService } from './services/websocket';\nimport './styles/tailwind.css';\nimport './App.css';\nimport Layout from './components/layout/Layout';\nimport Login from './components/auth/Login';\nimport EnterpriseDashboard from './components/dashboard/EnterpriseDashboard';\nimport PremiumDashboard from './components/dashboard/PremiumDashboard';\nimport PropertiesDashboard from './components/dashboard/PropertiesDashboard';\nimport LeadsCRM from './components/crm/LeadsCRM';\nimport FieldView from './components/features/FieldView';\nimport WhatsAppMonitor from './components/operator/WhatsAppMonitor';\n\nconst parseJwtPayload = (token) => {\n  try {\n    const payload = token.split('.')[1];\n    const normalized = payload.replace(/-/g, '+').replace(/_/g, '/');\n    const decoded = JSON.parse(atob(normalized));\n    return decoded || {};\n  } catch (error) {\n    return {};\n  }\n};\n\nfunction App() {\n  const { lang, activeTenantId, authToken, setAuthToken, setActiveTenantId, role, hasHydrated, setLang, market } = useStore();\n  const { i18n } = useTranslations();\n  const isRTL = lang === 'he';\n  const [activeView, setActiveView] = useState('dashboard');\n  const isClockInRoute = typeof window !== 'undefined' && window.location.pathname === '/clock-in';\n\n  useEffect(() => {\n    // Connect to WebSocket on mount\n    wsService.connect();\n    \n    return () => {\n      wsService.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    if (authToken) return;\n    const params = new URLSearchParams(window.location.search);\n    const tokenParam = params.get('token');\n    if (tokenParam) {\n      const payload = parseJwtPayload(tokenParam);\n      if (payload?.tenant_id) {\n        setActiveTenantId(payload.tenant_id);\n      }\n      setAuthToken(tokenParam);\n      params.delete('token');\n      const next = `${window.location.pathname}${params.toString() ? `?${params}` : ''}`;\n      window.history.replaceState({}, '', next);\n    }\n  }, [authToken, setAuthToken, setActiveTenantId]);\n\n  useEffect(() => {\n    i18n.changeLanguage(lang);\n    if (typeof document !== 'undefined') {\n      document.documentElement.dir = isRTL ? 'rtl' : 'ltr';\n      document.documentElement.lang = lang;\n    }\n  }, [i18n, isRTL, lang]);\n\n  useEffect(() => {\n    const marketKey = market === 'IL' ? 'IL' : 'US';\n    const allowed = marketKey === 'IL' ? ['he', 'th', 'hi'] : ['en', 'es'];\n    if (!allowed.includes(lang)) {\n      setLang(allowed[0]);\n    }\n  }, [market, lang, setLang]);\n\n  useEffect(() => {\n    const roleViews = {\n      host: ['dashboard', 'premium', 'properties', 'crm'],\n      operator: ['operator'],\n      field: ['field'],\n    };\n    const allowed = roleViews[role] || ['dashboard'];\n    if (!allowed.includes(activeView)) {\n      setActiveView(allowed[0]);\n    }\n  }, [role, activeView]);\n\n  const renderRoleView = () => {\n    switch (role) {\n      case 'operator':\n        return (\n          <div key=\"operator-view\">\n            <LeadsCRM />\n            <WhatsAppMonitor />\n          </div>\n        );\n      case 'field':\n        return <FieldView key=\"field-view\" />;\n      case 'host':\n      default:\n        if (activeView === 'crm') return <LeadsCRM key=\"host-crm\" />;\n        if (activeView === 'premium') return <PremiumDashboard key=\"host-premium\" />;\n        if (activeView === 'properties') return <PropertiesDashboard key=\"host-properties\" />;\n        return <EnterpriseDashboard key=\"host-dashboard\" />;\n    }\n  };\n\n  const showLogin = hasHydrated && !authToken && !isClockInRoute;\n\n  return (\n    <div dir={isRTL ? 'rtl' : 'ltr'}>\n      {hasHydrated ? (\n        showLogin ? (\n          <Login />\n        ) : isClockInRoute ? (\n          <div className=\"clockin-shell\">\n            <FieldView clockInOnly autoClockInOnScan />\n          </div>\n        ) : (\n          <Layout activeView={activeView} setActiveView={setActiveView}>\n            {renderRoleView()}\n          </Layout>\n        )\n      ) : null}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}