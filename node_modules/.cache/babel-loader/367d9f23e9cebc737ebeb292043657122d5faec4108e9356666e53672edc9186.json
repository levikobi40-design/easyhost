{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\hotel_ai_assistant\\\\hotel_dashboard\\\\src\\\\components\\\\features\\\\OwnerView.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Building2, Sparkles, RefreshCw, Bell, Wifi, WifiOff } from 'lucide-react';\nimport Card from '../ui/Card';\nimport Button from '../ui/Button';\nimport { getAIInsights, getLatestBooking } from '../../services/api';\nimport { SSE_STREAM_URL, POLL_INTERVAL, SSE_RECONNECT_DELAY } from '../../utils/constants';\nimport './OwnerView.css';\n\n/**\r\n * Owner view component with AI insights panel and real-time SSE updates\r\n * Falls back to polling if SSE connection fails\r\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst OwnerView = ({\n  aiLog,\n  onShowSummary,\n  onAIAction,\n  t\n}) => {\n  _s();\n  const [aiInsight, setAiInsight] = useState(null);\n  const [insightLoading, setInsightLoading] = useState(false);\n  const [insightError, setInsightError] = useState(null);\n  const [latestBooking, setLatestBooking] = useState(null);\n  const [newBookingAlert, setNewBookingAlert] = useState(false);\n  const [connectionStatus, setConnectionStatus] = useState('connecting'); // 'sse', 'polling', 'connecting', 'error'\n\n  // Refs for cleanup\n  const eventSourceRef = useRef(null);\n  const pollIntervalRef = useRef(null);\n  const lastBookingIdRef = useRef(null);\n  const reconnectTimeoutRef = useRef(null);\n\n  // Fetch AI insights\n  const fetchInsights = useCallback(async (showLoading = true) => {\n    if (showLoading) setInsightLoading(true);\n    setInsightError(null);\n    try {\n      const data = await getAIInsights();\n      setAiInsight(data);\n    } catch (error) {\n      console.error('Error fetching AI insights:', error);\n      setInsightError('Unable to load AI insights');\n      setAiInsight({\n        insight: '注专转  注专 !',\n        bookings_count: 0\n      });\n    } finally {\n      if (showLoading) setInsightLoading(false);\n    }\n  }, []);\n\n  // Handle new booking event (from SSE or polling)\n  const handleNewBooking = useCallback(bookingData => {\n    console.log('New booking received:', bookingData);\n\n    // Update latest booking state\n    setLatestBooking({\n      latest_id: bookingData.id,\n      latest_room: bookingData.room,\n      latest_customer: bookingData.customer,\n      latest_time: bookingData.time,\n      total_count: bookingData.total_count\n    });\n\n    // Show alert\n    setNewBookingAlert(true);\n\n    // Auto-refresh AI insights\n    fetchInsights(false);\n\n    // Clear alert after 5 seconds\n    setTimeout(() => setNewBookingAlert(false), 5000);\n\n    // Update last known ID\n    lastBookingIdRef.current = bookingData.id;\n  }, [fetchInsights]);\n\n  // Start SSE connection\n  const startSSE = useCallback(() => {\n    // Clean up existing connection\n    if (eventSourceRef.current) {\n      eventSourceRef.current.close();\n    }\n    setConnectionStatus('connecting');\n    console.log('Connecting to SSE...');\n    const eventSource = new EventSource(SSE_STREAM_URL);\n    eventSourceRef.current = eventSource;\n\n    // Connection opened\n    eventSource.addEventListener('connected', event => {\n      const data = JSON.parse(event.data);\n      console.log('SSE connected:', data);\n      setConnectionStatus('sse');\n\n      // Stop polling if running\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n        pollIntervalRef.current = null;\n      }\n    });\n\n    // New booking event\n    eventSource.addEventListener('new_booking', event => {\n      const bookingData = JSON.parse(event.data);\n      handleNewBooking(bookingData);\n    });\n\n    // Heartbeat (keeps connection alive)\n    eventSource.addEventListener('heartbeat', event => {\n      // Connection is alive, nothing to do\n      console.debug('SSE heartbeat received');\n    });\n\n    // Connection error\n    eventSource.onerror = error => {\n      console.error('SSE connection error:', error);\n      eventSource.close();\n      eventSourceRef.current = null;\n\n      // Fall back to polling\n      setConnectionStatus('polling');\n      startPolling();\n\n      // Try to reconnect SSE after delay\n      reconnectTimeoutRef.current = setTimeout(() => {\n        console.log('Attempting SSE reconnection...');\n        startSSE();\n      }, SSE_RECONNECT_DELAY);\n    };\n    return eventSource;\n  }, [handleNewBooking]);\n\n  // Start polling (fallback)\n  const startPolling = useCallback(() => {\n    if (pollIntervalRef.current) return; // Already polling\n\n    console.log('Starting polling fallback...');\n    const checkForNewBookings = async () => {\n      try {\n        const data = await getLatestBooking();\n\n        // If we have a new booking (ID changed)\n        if (data.latest_id && lastBookingIdRef.current !== null && data.latest_id !== lastBookingIdRef.current) {\n          handleNewBooking({\n            id: data.latest_id,\n            room: data.latest_room,\n            customer: data.latest_customer,\n            time: data.latest_time,\n            total_count: data.total_count\n          });\n        }\n\n        // Update last known ID\n        if (data.latest_id) {\n          lastBookingIdRef.current = data.latest_id;\n        }\n      } catch (error) {\n        console.error('Polling error:', error);\n        setConnectionStatus('error');\n      }\n    };\n    pollIntervalRef.current = setInterval(checkForNewBookings, POLL_INTERVAL);\n  }, [handleNewBooking]);\n\n  // Initial setup\n  useEffect(() => {\n    // Fetch initial data\n    fetchInsights();\n\n    // Get initial booking ID\n    getLatestBooking().then(data => {\n      lastBookingIdRef.current = data.latest_id;\n      setLatestBooking(data);\n    }).catch(console.error);\n\n    // Start SSE connection\n    startSSE();\n\n    // Cleanup on unmount\n    return () => {\n      if (eventSourceRef.current) {\n        eventSourceRef.current.close();\n      }\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current);\n      }\n      if (reconnectTimeoutRef.current) {\n        clearTimeout(reconnectTimeoutRef.current);\n      }\n    };\n  }, [fetchInsights, startSSE]);\n  const handleAIAction = async (type, room) => {\n    if (onAIAction) {\n      onAIAction(type, room);\n    }\n  };\n\n  // Connection status indicator\n  const renderConnectionStatus = () => {\n    switch (connectionStatus) {\n      case 'sse':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"connection-status connected\",\n          children: [/*#__PURE__*/_jsxDEV(Wifi, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Real-time (SSE)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this);\n      case 'polling':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"connection-status polling\",\n          children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Polling (fallback)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this);\n      case 'connecting':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"connection-status connecting\",\n          children: [/*#__PURE__*/_jsxDEV(Wifi, {\n            size: 14,\n            className: \"blink\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Connecting...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this);\n      case 'error':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"connection-status error\",\n          children: [/*#__PURE__*/_jsxDEV(WifiOff, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Disconnected\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"owner-view fade-in\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"owner-actions\",\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"secondary\",\n        onClick: onShowSummary,\n        children: [\"\\uD83D\\uDCCA \", t.summary]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 7\n    }, this), newBookingAlert && latestBooking && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"new-booking-alert fade-in\",\n      children: [/*#__PURE__*/_jsxDEV(Bell, {\n        size: 20\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"\\u05D4\\u05D6\\u05DE\\u05E0\\u05D4 \\u05D7\\u05D3\\u05E9\\u05D4! \", latestBooking.latest_customer, \" - \", latestBooking.latest_room]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      variant: \"gradient\",\n      className: \"ai-insight-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"card-title\",\n          children: [/*#__PURE__*/_jsxDEV(Sparkles, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 13\n          }, this), \"AI Insight\", latestBooking && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"booking-count-badge\",\n            children: [latestBooking.total_count, \" bookings\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"ghost\",\n          size: \"sm\",\n          onClick: () => fetchInsights(true),\n          disabled: insightLoading,\n          children: /*#__PURE__*/_jsxDEV(RefreshCw, {\n            size: 16,\n            className: insightLoading ? 'spin' : ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: insightLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"insight-loading\",\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this) : insightError ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"insight-error\",\n          children: insightError\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"insight-text\",\n            children: (aiInsight === null || aiInsight === void 0 ? void 0 : aiInsight.insight) || 'System Ready...'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 15\n          }, this), (aiInsight === null || aiInsight === void 0 ? void 0 : aiInsight.bookings_count) > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"insight-meta\",\n            children: [\"Based on \", aiInsight.bookings_count, \" bookings\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"live-indicator\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"live-dot\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this), \"Live updates enabled\", renderConnectionStatus()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      variant: \"outlined\",\n      className: \"ai-log-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header\",\n        children: /*#__PURE__*/_jsxDEV(\"h4\", {\n          className: \"card-title\",\n          children: t.logTitle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: aiLog.map((log, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"log-entry\",\n          children: log\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      className: \"room-management-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"room-title\",\n          children: [/*#__PURE__*/_jsxDEV(Building2, {\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this), \"\\u05D5\\u05D9\\u05DC\\u05D4 \\u05E7\\u05D9\\u05E1\\u05E8\\u05D9\\u05D4 / Villa Mykonos\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"room-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"room-name\",\n            children: [t.suite, \" 101\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"room-actions\",\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              variant: \"danger\",\n              size: \"sm\",\n              onClick: () => handleAIAction('checkout', '101'),\n              children: t.exit\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"accent\",\n              size: \"sm\",\n              onClick: () => handleAIAction('towels', '101'),\n              children: t.towels\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 234,\n    columnNumber: 5\n  }, this);\n};\n_s(OwnerView, \"EOIRp+k/KyTaApNdxqv5JxH5Iy0=\");\n_c = OwnerView;\nexport default OwnerView;\nvar _c;\n$RefreshReg$(_c, \"OwnerView\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Building2","Sparkles","RefreshCw","Bell","Wifi","WifiOff","Card","Button","getAIInsights","getLatestBooking","SSE_STREAM_URL","POLL_INTERVAL","SSE_RECONNECT_DELAY","jsxDEV","_jsxDEV","Fragment","_Fragment","OwnerView","aiLog","onShowSummary","onAIAction","t","_s","aiInsight","setAiInsight","insightLoading","setInsightLoading","insightError","setInsightError","latestBooking","setLatestBooking","newBookingAlert","setNewBookingAlert","connectionStatus","setConnectionStatus","eventSourceRef","pollIntervalRef","lastBookingIdRef","reconnectTimeoutRef","fetchInsights","showLoading","data","error","console","insight","bookings_count","handleNewBooking","bookingData","log","latest_id","id","latest_room","room","latest_customer","customer","latest_time","time","total_count","setTimeout","current","startSSE","close","eventSource","EventSource","addEventListener","event","JSON","parse","clearInterval","debug","onerror","startPolling","checkForNewBookings","setInterval","then","catch","clearTimeout","handleAIAction","type","renderConnectionStatus","className","children","size","fileName","_jsxFileName","lineNumber","columnNumber","variant","onClick","summary","disabled","logTitle","map","i","suite","exit","towels","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/components/features/OwnerView.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { Building2, Sparkles, RefreshCw, Bell, Wifi, WifiOff } from 'lucide-react';\r\nimport Card from '../ui/Card';\r\nimport Button from '../ui/Button';\r\nimport { getAIInsights, getLatestBooking } from '../../services/api';\r\nimport { SSE_STREAM_URL, POLL_INTERVAL, SSE_RECONNECT_DELAY } from '../../utils/constants';\r\nimport './OwnerView.css';\r\n\r\n/**\r\n * Owner view component with AI insights panel and real-time SSE updates\r\n * Falls back to polling if SSE connection fails\r\n */\r\nconst OwnerView = ({ aiLog, onShowSummary, onAIAction, t }) => {\r\n  const [aiInsight, setAiInsight] = useState(null);\r\n  const [insightLoading, setInsightLoading] = useState(false);\r\n  const [insightError, setInsightError] = useState(null);\r\n  const [latestBooking, setLatestBooking] = useState(null);\r\n  const [newBookingAlert, setNewBookingAlert] = useState(false);\r\n  const [connectionStatus, setConnectionStatus] = useState('connecting'); // 'sse', 'polling', 'connecting', 'error'\r\n\r\n  // Refs for cleanup\r\n  const eventSourceRef = useRef(null);\r\n  const pollIntervalRef = useRef(null);\r\n  const lastBookingIdRef = useRef(null);\r\n  const reconnectTimeoutRef = useRef(null);\r\n\r\n  // Fetch AI insights\r\n  const fetchInsights = useCallback(async (showLoading = true) => {\r\n    if (showLoading) setInsightLoading(true);\r\n    setInsightError(null);\r\n    try {\r\n      const data = await getAIInsights();\r\n      setAiInsight(data);\r\n    } catch (error) {\r\n      console.error('Error fetching AI insights:', error);\r\n      setInsightError('Unable to load AI insights');\r\n      setAiInsight({ insight: '注专转  注专 !', bookings_count: 0 });\r\n    } finally {\r\n      if (showLoading) setInsightLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Handle new booking event (from SSE or polling)\r\n  const handleNewBooking = useCallback((bookingData) => {\r\n    console.log('New booking received:', bookingData);\r\n\r\n    // Update latest booking state\r\n    setLatestBooking({\r\n      latest_id: bookingData.id,\r\n      latest_room: bookingData.room,\r\n      latest_customer: bookingData.customer,\r\n      latest_time: bookingData.time,\r\n      total_count: bookingData.total_count\r\n    });\r\n\r\n    // Show alert\r\n    setNewBookingAlert(true);\r\n\r\n    // Auto-refresh AI insights\r\n    fetchInsights(false);\r\n\r\n    // Clear alert after 5 seconds\r\n    setTimeout(() => setNewBookingAlert(false), 5000);\r\n\r\n    // Update last known ID\r\n    lastBookingIdRef.current = bookingData.id;\r\n  }, [fetchInsights]);\r\n\r\n  // Start SSE connection\r\n  const startSSE = useCallback(() => {\r\n    // Clean up existing connection\r\n    if (eventSourceRef.current) {\r\n      eventSourceRef.current.close();\r\n    }\r\n\r\n    setConnectionStatus('connecting');\r\n    console.log('Connecting to SSE...');\r\n\r\n    const eventSource = new EventSource(SSE_STREAM_URL);\r\n    eventSourceRef.current = eventSource;\r\n\r\n    // Connection opened\r\n    eventSource.addEventListener('connected', (event) => {\r\n      const data = JSON.parse(event.data);\r\n      console.log('SSE connected:', data);\r\n      setConnectionStatus('sse');\r\n\r\n      // Stop polling if running\r\n      if (pollIntervalRef.current) {\r\n        clearInterval(pollIntervalRef.current);\r\n        pollIntervalRef.current = null;\r\n      }\r\n    });\r\n\r\n    // New booking event\r\n    eventSource.addEventListener('new_booking', (event) => {\r\n      const bookingData = JSON.parse(event.data);\r\n      handleNewBooking(bookingData);\r\n    });\r\n\r\n    // Heartbeat (keeps connection alive)\r\n    eventSource.addEventListener('heartbeat', (event) => {\r\n      // Connection is alive, nothing to do\r\n      console.debug('SSE heartbeat received');\r\n    });\r\n\r\n    // Connection error\r\n    eventSource.onerror = (error) => {\r\n      console.error('SSE connection error:', error);\r\n      eventSource.close();\r\n      eventSourceRef.current = null;\r\n\r\n      // Fall back to polling\r\n      setConnectionStatus('polling');\r\n      startPolling();\r\n\r\n      // Try to reconnect SSE after delay\r\n      reconnectTimeoutRef.current = setTimeout(() => {\r\n        console.log('Attempting SSE reconnection...');\r\n        startSSE();\r\n      }, SSE_RECONNECT_DELAY);\r\n    };\r\n\r\n    return eventSource;\r\n  }, [handleNewBooking]);\r\n\r\n  // Start polling (fallback)\r\n  const startPolling = useCallback(() => {\r\n    if (pollIntervalRef.current) return; // Already polling\r\n\r\n    console.log('Starting polling fallback...');\r\n\r\n    const checkForNewBookings = async () => {\r\n      try {\r\n        const data = await getLatestBooking();\r\n\r\n        // If we have a new booking (ID changed)\r\n        if (data.latest_id && lastBookingIdRef.current !== null && data.latest_id !== lastBookingIdRef.current) {\r\n          handleNewBooking({\r\n            id: data.latest_id,\r\n            room: data.latest_room,\r\n            customer: data.latest_customer,\r\n            time: data.latest_time,\r\n            total_count: data.total_count\r\n          });\r\n        }\r\n\r\n        // Update last known ID\r\n        if (data.latest_id) {\r\n          lastBookingIdRef.current = data.latest_id;\r\n        }\r\n      } catch (error) {\r\n        console.error('Polling error:', error);\r\n        setConnectionStatus('error');\r\n      }\r\n    };\r\n\r\n    pollIntervalRef.current = setInterval(checkForNewBookings, POLL_INTERVAL);\r\n  }, [handleNewBooking]);\r\n\r\n  // Initial setup\r\n  useEffect(() => {\r\n    // Fetch initial data\r\n    fetchInsights();\r\n\r\n    // Get initial booking ID\r\n    getLatestBooking()\r\n      .then(data => {\r\n        lastBookingIdRef.current = data.latest_id;\r\n        setLatestBooking(data);\r\n      })\r\n      .catch(console.error);\r\n\r\n    // Start SSE connection\r\n    startSSE();\r\n\r\n    // Cleanup on unmount\r\n    return () => {\r\n      if (eventSourceRef.current) {\r\n        eventSourceRef.current.close();\r\n      }\r\n      if (pollIntervalRef.current) {\r\n        clearInterval(pollIntervalRef.current);\r\n      }\r\n      if (reconnectTimeoutRef.current) {\r\n        clearTimeout(reconnectTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [fetchInsights, startSSE]);\r\n\r\n  const handleAIAction = async (type, room) => {\r\n    if (onAIAction) {\r\n      onAIAction(type, room);\r\n    }\r\n  };\r\n\r\n  // Connection status indicator\r\n  const renderConnectionStatus = () => {\r\n    switch (connectionStatus) {\r\n      case 'sse':\r\n        return (\r\n          <div className=\"connection-status connected\">\r\n            <Wifi size={14} />\r\n            <span>Real-time (SSE)</span>\r\n          </div>\r\n        );\r\n      case 'polling':\r\n        return (\r\n          <div className=\"connection-status polling\">\r\n            <RefreshCw size={14} />\r\n            <span>Polling (fallback)</span>\r\n          </div>\r\n        );\r\n      case 'connecting':\r\n        return (\r\n          <div className=\"connection-status connecting\">\r\n            <Wifi size={14} className=\"blink\" />\r\n            <span>Connecting...</span>\r\n          </div>\r\n        );\r\n      case 'error':\r\n        return (\r\n          <div className=\"connection-status error\">\r\n            <WifiOff size={14} />\r\n            <span>Disconnected</span>\r\n          </div>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"owner-view fade-in\">\r\n      <div className=\"owner-actions\">\r\n        <Button variant=\"secondary\" onClick={onShowSummary}>\r\n           {t.summary}\r\n        </Button>\r\n      </div>\r\n\r\n      {/* New Booking Alert */}\r\n      {newBookingAlert && latestBooking && (\r\n        <div className=\"new-booking-alert fade-in\">\r\n          <Bell size={20} />\r\n          <span>\r\n             砖! {latestBooking.latest_customer} - {latestBooking.latest_room}\r\n          </span>\r\n        </div>\r\n      )}\r\n\r\n      {/* AI Insights Panel */}\r\n      <Card variant=\"gradient\" className=\"ai-insight-card\">\r\n        <div className=\"card-header\">\r\n          <h4 className=\"card-title\">\r\n            <Sparkles size={20} />\r\n            AI Insight\r\n            {latestBooking && (\r\n              <span className=\"booking-count-badge\">\r\n                {latestBooking.total_count} bookings\r\n              </span>\r\n            )}\r\n          </h4>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={() => fetchInsights(true)}\r\n            disabled={insightLoading}\r\n          >\r\n            <RefreshCw size={16} className={insightLoading ? 'spin' : ''} />\r\n          </Button>\r\n        </div>\r\n        <div className=\"card-body\">\r\n          {insightLoading ? (\r\n            <div className=\"insight-loading\">Loading...</div>\r\n          ) : insightError ? (\r\n            <div className=\"insight-error\">{insightError}</div>\r\n          ) : (\r\n            <>\r\n              <p className=\"insight-text\">{aiInsight?.insight || 'System Ready...'}</p>\r\n              {aiInsight?.bookings_count > 0 && (\r\n                <span className=\"insight-meta\">\r\n                  Based on {aiInsight.bookings_count} bookings\r\n                </span>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n        <div className=\"live-indicator\">\r\n          <span className=\"live-dot\"></span>\r\n          Live updates enabled\r\n          {renderConnectionStatus()}\r\n        </div>\r\n      </Card>\r\n\r\n      <Card variant=\"outlined\" className=\"ai-log-card\">\r\n        <div className=\"card-header\">\r\n          <h4 className=\"card-title\">{t.logTitle}</h4>\r\n        </div>\r\n        <div className=\"card-body\">\r\n          {aiLog.map((log, i) => (\r\n            <div key={i} className=\"log-entry\">\r\n              {log}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </Card>\r\n\r\n      <Card className=\"room-management-card\">\r\n        <div className=\"card-header\">\r\n          <h3 className=\"room-title\">\r\n            <Building2 size={24} />\r\n             拽住专 / Villa Mykonos\r\n          </h3>\r\n        </div>\r\n        <div className=\"card-body\">\r\n          <div className=\"room-item\">\r\n            <span className=\"room-name\">{t.suite} 101</span>\r\n            <div className=\"room-actions\">\r\n              <Button\r\n                variant=\"danger\"\r\n                size=\"sm\"\r\n                onClick={() => handleAIAction('checkout', '101')}\r\n              >\r\n                {t.exit}\r\n              </Button>\r\n              <Button\r\n                variant=\"accent\"\r\n                size=\"sm\"\r\n                onClick={() => handleAIAction('towels', '101')}\r\n              >\r\n                {t.towels}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OwnerView;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,EAAEC,WAAW,QAAQ,OAAO;AACvE,SAASC,SAAS,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,IAAI,EAAEC,IAAI,EAAEC,OAAO,QAAQ,cAAc;AAClF,OAAOC,IAAI,MAAM,YAAY;AAC7B,OAAOC,MAAM,MAAM,cAAc;AACjC,SAASC,aAAa,EAAEC,gBAAgB,QAAQ,oBAAoB;AACpE,SAASC,cAAc,EAAEC,aAAa,EAAEC,mBAAmB,QAAQ,uBAAuB;AAC1F,OAAO,iBAAiB;;AAExB;AACA;AACA;AACA;AAHA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAIA,MAAMC,SAAS,GAAGA,CAAC;EAAEC,KAAK;EAAEC,aAAa;EAAEC,UAAU;EAAEC;AAAE,CAAC,KAAK;EAAAC,EAAA;EAC7D,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAG5B,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAAC6B,cAAc,EAAEC,iBAAiB,CAAC,GAAG9B,QAAQ,CAAC,KAAK,CAAC;EAC3D,MAAM,CAAC+B,YAAY,EAAEC,eAAe,CAAC,GAAGhC,QAAQ,CAAC,IAAI,CAAC;EACtD,MAAM,CAACiC,aAAa,EAAEC,gBAAgB,CAAC,GAAGlC,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAM,CAACmC,eAAe,EAAEC,kBAAkB,CAAC,GAAGpC,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACqC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGtC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC;;EAExE;EACA,MAAMuC,cAAc,GAAGrC,MAAM,CAAC,IAAI,CAAC;EACnC,MAAMsC,eAAe,GAAGtC,MAAM,CAAC,IAAI,CAAC;EACpC,MAAMuC,gBAAgB,GAAGvC,MAAM,CAAC,IAAI,CAAC;EACrC,MAAMwC,mBAAmB,GAAGxC,MAAM,CAAC,IAAI,CAAC;;EAExC;EACA,MAAMyC,aAAa,GAAGxC,WAAW,CAAC,OAAOyC,WAAW,GAAG,IAAI,KAAK;IAC9D,IAAIA,WAAW,EAAEd,iBAAiB,CAAC,IAAI,CAAC;IACxCE,eAAe,CAAC,IAAI,CAAC;IACrB,IAAI;MACF,MAAMa,IAAI,GAAG,MAAMjC,aAAa,CAAC,CAAC;MAClCgB,YAAY,CAACiB,IAAI,CAAC;IACpB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC;MACnDd,eAAe,CAAC,4BAA4B,CAAC;MAC7CJ,YAAY,CAAC;QAAEoB,OAAO,EAAE,wBAAwB;QAAEC,cAAc,EAAE;MAAE,CAAC,CAAC;IACxE,CAAC,SAAS;MACR,IAAIL,WAAW,EAAEd,iBAAiB,CAAC,KAAK,CAAC;IAC3C;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMoB,gBAAgB,GAAG/C,WAAW,CAAEgD,WAAW,IAAK;IACpDJ,OAAO,CAACK,GAAG,CAAC,uBAAuB,EAAED,WAAW,CAAC;;IAEjD;IACAjB,gBAAgB,CAAC;MACfmB,SAAS,EAAEF,WAAW,CAACG,EAAE;MACzBC,WAAW,EAAEJ,WAAW,CAACK,IAAI;MAC7BC,eAAe,EAAEN,WAAW,CAACO,QAAQ;MACrCC,WAAW,EAAER,WAAW,CAACS,IAAI;MAC7BC,WAAW,EAAEV,WAAW,CAACU;IAC3B,CAAC,CAAC;;IAEF;IACAzB,kBAAkB,CAAC,IAAI,CAAC;;IAExB;IACAO,aAAa,CAAC,KAAK,CAAC;;IAEpB;IACAmB,UAAU,CAAC,MAAM1B,kBAAkB,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC;;IAEjD;IACAK,gBAAgB,CAACsB,OAAO,GAAGZ,WAAW,CAACG,EAAE;EAC3C,CAAC,EAAE,CAACX,aAAa,CAAC,CAAC;;EAEnB;EACA,MAAMqB,QAAQ,GAAG7D,WAAW,CAAC,MAAM;IACjC;IACA,IAAIoC,cAAc,CAACwB,OAAO,EAAE;MAC1BxB,cAAc,CAACwB,OAAO,CAACE,KAAK,CAAC,CAAC;IAChC;IAEA3B,mBAAmB,CAAC,YAAY,CAAC;IACjCS,OAAO,CAACK,GAAG,CAAC,sBAAsB,CAAC;IAEnC,MAAMc,WAAW,GAAG,IAAIC,WAAW,CAACrD,cAAc,CAAC;IACnDyB,cAAc,CAACwB,OAAO,GAAGG,WAAW;;IAEpC;IACAA,WAAW,CAACE,gBAAgB,CAAC,WAAW,EAAGC,KAAK,IAAK;MACnD,MAAMxB,IAAI,GAAGyB,IAAI,CAACC,KAAK,CAACF,KAAK,CAACxB,IAAI,CAAC;MACnCE,OAAO,CAACK,GAAG,CAAC,gBAAgB,EAAEP,IAAI,CAAC;MACnCP,mBAAmB,CAAC,KAAK,CAAC;;MAE1B;MACA,IAAIE,eAAe,CAACuB,OAAO,EAAE;QAC3BS,aAAa,CAAChC,eAAe,CAACuB,OAAO,CAAC;QACtCvB,eAAe,CAACuB,OAAO,GAAG,IAAI;MAChC;IACF,CAAC,CAAC;;IAEF;IACAG,WAAW,CAACE,gBAAgB,CAAC,aAAa,EAAGC,KAAK,IAAK;MACrD,MAAMlB,WAAW,GAAGmB,IAAI,CAACC,KAAK,CAACF,KAAK,CAACxB,IAAI,CAAC;MAC1CK,gBAAgB,CAACC,WAAW,CAAC;IAC/B,CAAC,CAAC;;IAEF;IACAe,WAAW,CAACE,gBAAgB,CAAC,WAAW,EAAGC,KAAK,IAAK;MACnD;MACAtB,OAAO,CAAC0B,KAAK,CAAC,wBAAwB,CAAC;IACzC,CAAC,CAAC;;IAEF;IACAP,WAAW,CAACQ,OAAO,GAAI5B,KAAK,IAAK;MAC/BC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC7CoB,WAAW,CAACD,KAAK,CAAC,CAAC;MACnB1B,cAAc,CAACwB,OAAO,GAAG,IAAI;;MAE7B;MACAzB,mBAAmB,CAAC,SAAS,CAAC;MAC9BqC,YAAY,CAAC,CAAC;;MAEd;MACAjC,mBAAmB,CAACqB,OAAO,GAAGD,UAAU,CAAC,MAAM;QAC7Cf,OAAO,CAACK,GAAG,CAAC,gCAAgC,CAAC;QAC7CY,QAAQ,CAAC,CAAC;MACZ,CAAC,EAAEhD,mBAAmB,CAAC;IACzB,CAAC;IAED,OAAOkD,WAAW;EACpB,CAAC,EAAE,CAAChB,gBAAgB,CAAC,CAAC;;EAEtB;EACA,MAAMyB,YAAY,GAAGxE,WAAW,CAAC,MAAM;IACrC,IAAIqC,eAAe,CAACuB,OAAO,EAAE,OAAO,CAAC;;IAErChB,OAAO,CAACK,GAAG,CAAC,8BAA8B,CAAC;IAE3C,MAAMwB,mBAAmB,GAAG,MAAAA,CAAA,KAAY;MACtC,IAAI;QACF,MAAM/B,IAAI,GAAG,MAAMhC,gBAAgB,CAAC,CAAC;;QAErC;QACA,IAAIgC,IAAI,CAACQ,SAAS,IAAIZ,gBAAgB,CAACsB,OAAO,KAAK,IAAI,IAAIlB,IAAI,CAACQ,SAAS,KAAKZ,gBAAgB,CAACsB,OAAO,EAAE;UACtGb,gBAAgB,CAAC;YACfI,EAAE,EAAET,IAAI,CAACQ,SAAS;YAClBG,IAAI,EAAEX,IAAI,CAACU,WAAW;YACtBG,QAAQ,EAAEb,IAAI,CAACY,eAAe;YAC9BG,IAAI,EAAEf,IAAI,CAACc,WAAW;YACtBE,WAAW,EAAEhB,IAAI,CAACgB;UACpB,CAAC,CAAC;QACJ;;QAEA;QACA,IAAIhB,IAAI,CAACQ,SAAS,EAAE;UAClBZ,gBAAgB,CAACsB,OAAO,GAAGlB,IAAI,CAACQ,SAAS;QAC3C;MACF,CAAC,CAAC,OAAOP,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,gBAAgB,EAAEA,KAAK,CAAC;QACtCR,mBAAmB,CAAC,OAAO,CAAC;MAC9B;IACF,CAAC;IAEDE,eAAe,CAACuB,OAAO,GAAGc,WAAW,CAACD,mBAAmB,EAAE7D,aAAa,CAAC;EAC3E,CAAC,EAAE,CAACmC,gBAAgB,CAAC,CAAC;;EAEtB;EACAjD,SAAS,CAAC,MAAM;IACd;IACA0C,aAAa,CAAC,CAAC;;IAEf;IACA9B,gBAAgB,CAAC,CAAC,CACfiE,IAAI,CAACjC,IAAI,IAAI;MACZJ,gBAAgB,CAACsB,OAAO,GAAGlB,IAAI,CAACQ,SAAS;MACzCnB,gBAAgB,CAACW,IAAI,CAAC;IACxB,CAAC,CAAC,CACDkC,KAAK,CAAChC,OAAO,CAACD,KAAK,CAAC;;IAEvB;IACAkB,QAAQ,CAAC,CAAC;;IAEV;IACA,OAAO,MAAM;MACX,IAAIzB,cAAc,CAACwB,OAAO,EAAE;QAC1BxB,cAAc,CAACwB,OAAO,CAACE,KAAK,CAAC,CAAC;MAChC;MACA,IAAIzB,eAAe,CAACuB,OAAO,EAAE;QAC3BS,aAAa,CAAChC,eAAe,CAACuB,OAAO,CAAC;MACxC;MACA,IAAIrB,mBAAmB,CAACqB,OAAO,EAAE;QAC/BiB,YAAY,CAACtC,mBAAmB,CAACqB,OAAO,CAAC;MAC3C;IACF,CAAC;EACH,CAAC,EAAE,CAACpB,aAAa,EAAEqB,QAAQ,CAAC,CAAC;EAE7B,MAAMiB,cAAc,GAAG,MAAAA,CAAOC,IAAI,EAAE1B,IAAI,KAAK;IAC3C,IAAIhC,UAAU,EAAE;MACdA,UAAU,CAAC0D,IAAI,EAAE1B,IAAI,CAAC;IACxB;EACF,CAAC;;EAED;EACA,MAAM2B,sBAAsB,GAAGA,CAAA,KAAM;IACnC,QAAQ9C,gBAAgB;MACtB,KAAK,KAAK;QACR,oBACEnB,OAAA;UAAKkE,SAAS,EAAC,6BAA6B;UAAAC,QAAA,gBAC1CnE,OAAA,CAACV,IAAI;YAAC8E,IAAI,EAAE;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAClBxE,OAAA;YAAAmE,QAAA,EAAM;UAAe;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACzB,CAAC;MAEV,KAAK,SAAS;QACZ,oBACExE,OAAA;UAAKkE,SAAS,EAAC,2BAA2B;UAAAC,QAAA,gBACxCnE,OAAA,CAACZ,SAAS;YAACgF,IAAI,EAAE;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACvBxE,OAAA;YAAAmE,QAAA,EAAM;UAAkB;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC5B,CAAC;MAEV,KAAK,YAAY;QACf,oBACExE,OAAA;UAAKkE,SAAS,EAAC,8BAA8B;UAAAC,QAAA,gBAC3CnE,OAAA,CAACV,IAAI;YAAC8E,IAAI,EAAE,EAAG;YAACF,SAAS,EAAC;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACpCxE,OAAA;YAAAmE,QAAA,EAAM;UAAa;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC;MAEV,KAAK,OAAO;QACV,oBACExE,OAAA;UAAKkE,SAAS,EAAC,yBAAyB;UAAAC,QAAA,gBACtCnE,OAAA,CAACT,OAAO;YAAC6E,IAAI,EAAE;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eACrBxE,OAAA;YAAAmE,QAAA,EAAM;UAAY;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtB,CAAC;MAEV;QACE,OAAO,IAAI;IACf;EACF,CAAC;EAED,oBACExE,OAAA;IAAKkE,SAAS,EAAC,oBAAoB;IAAAC,QAAA,gBACjCnE,OAAA;MAAKkE,SAAS,EAAC,eAAe;MAAAC,QAAA,eAC5BnE,OAAA,CAACP,MAAM;QAACgF,OAAO,EAAC,WAAW;QAACC,OAAO,EAAErE,aAAc;QAAA8D,QAAA,GAAC,eAC/C,EAAC5D,CAAC,CAACoE,OAAO;MAAA;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACP;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC,EAGLvD,eAAe,IAAIF,aAAa,iBAC/Bf,OAAA;MAAKkE,SAAS,EAAC,2BAA2B;MAAAC,QAAA,gBACxCnE,OAAA,CAACX,IAAI;QAAC+E,IAAI,EAAE;MAAG;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAClBxE,OAAA;QAAAmE,QAAA,GAAM,2DACQ,EAACpD,aAAa,CAACwB,eAAe,EAAC,KAAG,EAACxB,aAAa,CAACsB,WAAW;MAAA;QAAAgC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CACN,eAGDxE,OAAA,CAACR,IAAI;MAACiF,OAAO,EAAC,UAAU;MAACP,SAAS,EAAC,iBAAiB;MAAAC,QAAA,gBAClDnE,OAAA;QAAKkE,SAAS,EAAC,aAAa;QAAAC,QAAA,gBAC1BnE,OAAA;UAAIkE,SAAS,EAAC,YAAY;UAAAC,QAAA,gBACxBnE,OAAA,CAACb,QAAQ;YAACiF,IAAI,EAAE;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,cAEtB,EAACzD,aAAa,iBACZf,OAAA;YAAMkE,SAAS,EAAC,qBAAqB;YAAAC,QAAA,GAClCpD,aAAa,CAAC4B,WAAW,EAAC,WAC7B;UAAA;YAAA0B,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CACP;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC,eACLxE,OAAA,CAACP,MAAM;UACLgF,OAAO,EAAC,OAAO;UACfL,IAAI,EAAC,IAAI;UACTM,OAAO,EAAEA,CAAA,KAAMjD,aAAa,CAAC,IAAI,CAAE;UACnCmD,QAAQ,EAAEjE,cAAe;UAAAwD,QAAA,eAEzBnE,OAAA,CAACZ,SAAS;YAACgF,IAAI,EAAE,EAAG;YAACF,SAAS,EAAEvD,cAAc,GAAG,MAAM,GAAG;UAAG;YAAA0D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC1D,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACN,CAAC,eACNxE,OAAA;QAAKkE,SAAS,EAAC,WAAW;QAAAC,QAAA,EACvBxD,cAAc,gBACbX,OAAA;UAAKkE,SAAS,EAAC,iBAAiB;UAAAC,QAAA,EAAC;QAAU;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,GAC/C3D,YAAY,gBACdb,OAAA;UAAKkE,SAAS,EAAC,eAAe;UAAAC,QAAA,EAAEtD;QAAY;UAAAwD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,gBAEnDxE,OAAA,CAAAE,SAAA;UAAAiE,QAAA,gBACEnE,OAAA;YAAGkE,SAAS,EAAC,cAAc;YAAAC,QAAA,EAAE,CAAA1D,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEqB,OAAO,KAAI;UAAiB;YAAAuC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EACxE,CAAA/D,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEsB,cAAc,IAAG,CAAC,iBAC5B/B,OAAA;YAAMkE,SAAS,EAAC,cAAc;YAAAC,QAAA,GAAC,WACpB,EAAC1D,SAAS,CAACsB,cAAc,EAAC,WACrC;UAAA;YAAAsC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CACP;QAAA,eACD;MACH;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACE,CAAC,eACNxE,OAAA;QAAKkE,SAAS,EAAC,gBAAgB;QAAAC,QAAA,gBAC7BnE,OAAA;UAAMkE,SAAS,EAAC;QAAU;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,wBAElC,EAACP,sBAAsB,CAAC,CAAC;MAAA;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtB,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAEPxE,OAAA,CAACR,IAAI;MAACiF,OAAO,EAAC,UAAU;MAACP,SAAS,EAAC,aAAa;MAAAC,QAAA,gBAC9CnE,OAAA;QAAKkE,SAAS,EAAC,aAAa;QAAAC,QAAA,eAC1BnE,OAAA;UAAIkE,SAAS,EAAC,YAAY;UAAAC,QAAA,EAAE5D,CAAC,CAACsE;QAAQ;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzC,CAAC,eACNxE,OAAA;QAAKkE,SAAS,EAAC,WAAW;QAAAC,QAAA,EACvB/D,KAAK,CAAC0E,GAAG,CAAC,CAAC5C,GAAG,EAAE6C,CAAC,kBAChB/E,OAAA;UAAakE,SAAS,EAAC,WAAW;UAAAC,QAAA,EAC/BjC;QAAG,GADI6C,CAAC;UAAAV,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAEN,CACN;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAEPxE,OAAA,CAACR,IAAI;MAAC0E,SAAS,EAAC,sBAAsB;MAAAC,QAAA,gBACpCnE,OAAA;QAAKkE,SAAS,EAAC,aAAa;QAAAC,QAAA,eAC1BnE,OAAA;UAAIkE,SAAS,EAAC,YAAY;UAAAC,QAAA,gBACxBnE,OAAA,CAACd,SAAS;YAACkF,IAAI,EAAE;UAAG;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,iFAEzB;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACF,CAAC,eACNxE,OAAA;QAAKkE,SAAS,EAAC,WAAW;QAAAC,QAAA,eACxBnE,OAAA;UAAKkE,SAAS,EAAC,WAAW;UAAAC,QAAA,gBACxBnE,OAAA;YAAMkE,SAAS,EAAC,WAAW;YAAAC,QAAA,GAAE5D,CAAC,CAACyE,KAAK,EAAC,MAAI;UAAA;YAAAX,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAChDxE,OAAA;YAAKkE,SAAS,EAAC,cAAc;YAAAC,QAAA,gBAC3BnE,OAAA,CAACP,MAAM;cACLgF,OAAO,EAAC,QAAQ;cAChBL,IAAI,EAAC,IAAI;cACTM,OAAO,EAAEA,CAAA,KAAMX,cAAc,CAAC,UAAU,EAAE,KAAK,CAAE;cAAAI,QAAA,EAEhD5D,CAAC,CAAC0E;YAAI;cAAAZ,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACD,CAAC,eACTxE,OAAA,CAACP,MAAM;cACLgF,OAAO,EAAC,QAAQ;cAChBL,IAAI,EAAC,IAAI;cACTM,OAAO,EAAEA,CAAA,KAAMX,cAAc,CAAC,QAAQ,EAAE,KAAK,CAAE;cAAAI,QAAA,EAE9C5D,CAAC,CAAC2E;YAAM;cAAAb,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACJ,CAAC;AAEV,CAAC;AAAChE,EAAA,CAtUIL,SAAS;AAAAgF,EAAA,GAAThF,SAAS;AAwUf,eAAeA,SAAS;AAAC,IAAAgF,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}