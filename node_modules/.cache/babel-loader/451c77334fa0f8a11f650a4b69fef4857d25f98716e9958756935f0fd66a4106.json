{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\hotel_ai_assistant\\\\hotel_dashboard\\\\src\\\\components\\\\crm\\\\LeadsCRM.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { Users, Search, Filter, Plus, Mail, Phone, Globe, Calendar, Tag, Star, ArrowUpRight, ExternalLink, MessageCircle } from 'lucide-react';\nimport useTranslations from '../../hooks/useTranslations';\nimport useStore from '../../store/useStore';\nimport { maya, AGENT_TYPES } from '../../services/agentOrchestrator';\nimport { getLeads, getAutomationStats, subscribeToLeads } from '../../services/api';\nimport { whatsappService } from '../../services/whatsapp';\nimport './LeadsCRM.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst sourceIcons = {\n  airbnb: 'ðŸ ',\n  booking: 'ðŸ“…',\n  direct: 'ðŸŽ¯',\n  referral: 'ðŸ‘¥',\n  social: 'ðŸ“±'\n};\n\n// Sample leads data\nconst sampleLeads = [{\n  id: 1,\n  name: 'Luxury Property in Herzliya',\n  contact: 'David Cohen',\n  photo: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=240&fit=crop&auto=format',\n  email: 'david@example.com',\n  phone: '050-1234567',\n  source: 'airbnb',\n  status: 'new',\n  value: 1200,\n  rating: 4.8,\n  createdAt: '2026-01-25T10:30:00Z',\n  notes: 'Seaview property with 3 bedrooms'\n}, {\n  id: 2,\n  name: 'Seaside Villa - Netanya',\n  contact: 'Sarah Levy',\n  photo: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=240&fit=crop&auto=format',\n  email: 'sarah@example.com',\n  phone: '052-9876543',\n  source: 'booking',\n  status: 'contacted',\n  value: 850,\n  rating: 4.5,\n  createdAt: '2026-01-24T14:20:00Z',\n  notes: 'High intent, awaiting proposal'\n}, {\n  id: 3,\n  name: 'Penthouse in Tel Aviv',\n  contact: 'Yossi Mizrahi',\n  photo: 'https://images.unsplash.com/photo-1544723795-3fb6469f5b39?w=240&fit=crop&auto=format',\n  email: 'yossi@example.com',\n  phone: '054-5555555',\n  source: 'direct',\n  status: 'qualified',\n  value: 2000,\n  rating: 4.9,\n  createdAt: '2026-01-23T09:15:00Z',\n  notes: 'Premium property, closing expected'\n}, {\n  id: 4,\n  name: 'Vacation Apartment - Eilat',\n  contact: 'Michal Barak',\n  photo: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=240&fit=crop&auto=format',\n  email: 'michal@example.com',\n  phone: '053-3333333',\n  source: 'social',\n  status: 'converted',\n  value: 600,\n  rating: 4.3,\n  createdAt: '2026-01-22T16:45:00Z',\n  notes: 'Deal closed!'\n}, {\n  id: 5,\n  name: 'Guesthouse in the North',\n  contact: 'Avi Shimon',\n  photo: 'https://images.unsplash.com/photo-1525134479668-1bee5c7c6845?w=240&fit=crop&auto=format',\n  email: 'avi@example.com',\n  phone: '050-7777777',\n  source: 'referral',\n  status: 'new',\n  value: 750,\n  rating: 4.6,\n  createdAt: '2026-01-25T08:00:00Z',\n  notes: 'Referral lead, high potential'\n}];\nconst LeadsCRM = () => {\n  _s();\n  const {\n    t\n  } = useTranslations();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [selectedLead, setSelectedLead] = useState(null);\n  const [isScanning, setIsScanning] = useState(false);\n  const [leads, setLeads] = useState([]);\n  const [isLoadingLeads, setIsLoadingLeads] = useState(true);\n  const greetedLeadIdsRef = useRef(new Set());\n  const {\n    addNotification,\n    lang,\n    setLeads: setStoreLeads\n  } = useStore();\n  const isRTL = lang === 'he';\n  const statusOptions = [{\n    value: 'all',\n    label: t('leadsCRM.status.all'),\n    color: '#64748b'\n  }, {\n    value: 'new',\n    label: t('leadsCRM.status.new'),\n    color: '#3b82f6'\n  }, {\n    value: 'contacted',\n    label: t('leadsCRM.status.contacted'),\n    color: '#f59e0b'\n  }, {\n    value: 'qualified',\n    label: t('leadsCRM.status.qualified'),\n    color: '#8b5cf6'\n  }, {\n    value: 'converted',\n    label: t('leadsCRM.status.converted'),\n    color: '#10b981'\n  }, {\n    value: 'lost',\n    label: t('leadsCRM.status.lost'),\n    color: '#ef4444'\n  }];\n  const leadsWithFallback = leads.length > 0 ? leads : sampleLeads;\n  const filteredLeads = leadsWithFallback.filter(lead => {\n    const matchesSearch = lead.name.toLowerCase().includes(searchQuery.toLowerCase()) || lead.contact.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesStatus = statusFilter === 'all' || lead.status === statusFilter;\n    return matchesSearch && matchesStatus;\n  });\n  const normalizeLead = lead => {\n    const safeLead = lead || {};\n    const fallbackId = safeLead.id || safeLead.lead_id || `${safeLead.email || safeLead.phone || Date.now()}`;\n    const name = safeLead.name || safeLead.property_name || safeLead.property || 'Unknown Property';\n    const contact = safeLead.contact || safeLead.full_name || safeLead.guest_name || 'Guest';\n    return {\n      id: fallbackId,\n      name,\n      contact,\n      email: safeLead.email || '',\n      phone: safeLead.phone || '',\n      source: safeLead.source || 'direct',\n      status: safeLead.status || 'new',\n      value: safeLead.value || 0,\n      rating: safeLead.rating || 0,\n      createdAt: safeLead.createdAt || safeLead.created_at || new Date().toISOString(),\n      notes: safeLead.notes || '',\n      photo: safeLead.photo || `https://api.dicebear.com/7.x/personas/svg?seed=${encodeURIComponent(contact)}&backgroundColor=0b1220&radius=20`,\n      property: safeLead.property || name,\n      payment_link: safeLead.payment_link || safeLead.paymentLink || '',\n      last_objection: safeLead.last_objection || '',\n      lead_quality: safeLead.lead_quality || 0\n    };\n  };\n  useEffect(() => {\n    let isActive = true;\n    const loadLeads = async () => {\n      setIsLoadingLeads(true);\n      try {\n        const results = await getLeads(statusFilter === 'all' ? null : statusFilter);\n        const normalized = Array.isArray(results) ? results.map(normalizeLead) : [];\n        if (isActive) {\n          setLeads(normalized);\n          setStoreLeads(normalized);\n        }\n      } catch (error) {\n        console.error('Failed to load leads:', error);\n      } finally {\n        if (isActive) setIsLoadingLeads(false);\n      }\n    };\n    loadLeads();\n    return () => {\n      isActive = false;\n    };\n  }, [statusFilter, setStoreLeads]);\n  useEffect(() => {\n    const handleNewLead = async incoming => {\n      const normalized = normalizeLead(incoming);\n      setLeads(prev => {\n        const nextLeads = [normalized, ...prev];\n        setStoreLeads(nextLeads);\n        return nextLeads;\n      });\n      if (!greetedLeadIdsRef.current.has(normalized.id)) {\n        greetedLeadIdsRef.current.add(normalized.id);\n        try {\n          await whatsappService.sendLeadGreeting(normalized, lang);\n          addNotification({\n            type: 'success',\n            title: t('leadsCRM.actions.sendDemo'),\n            message: t('leadsCRM.autoGreetingSent', {\n              name: normalized.contact\n            })\n          });\n        } catch (error) {\n          console.error('Failed to send greeting:', error);\n        }\n      }\n    };\n    const handleLeadUpdated = incoming => {\n      const normalized = normalizeLead(incoming);\n      setLeads(prev => {\n        const nextLeads = prev.map(lead => lead.id === normalized.id ? {\n          ...lead,\n          ...normalized\n        } : lead);\n        setStoreLeads(nextLeads);\n        return nextLeads;\n      });\n    };\n    const eventSource = subscribeToLeads(handleNewLead, handleLeadUpdated, error => {\n      console.error('Lead stream error:', error);\n    });\n    return () => {\n      if (eventSource && eventSource.close) eventSource.close();\n    };\n  }, [addNotification, lang, setStoreLeads, t]);\n  const handleScanLeads = async () => {\n    setIsScanning(true);\n    try {\n      const result = await maya.executeTask(AGENT_TYPES.SCRAPER, {\n        platforms: ['airbnb', 'booking']\n      });\n      addNotification({\n        type: 'success',\n        title: t('leadsCRM.scanNew'),\n        message: result.message\n      });\n      if (result.leads && result.leads.length > 0) {\n        result.leads.slice(0, 3).forEach(lead => {\n          addNotification({\n            type: 'info',\n            title: t('notifications.newLead'),\n            messageKey: 'notifications.messages.newLead',\n            messageValues: {\n              platform: lead.platform || 'Airbnb'\n            },\n            data: lead\n          });\n        });\n      }\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Error',\n        message: 'Lead scan failed'\n      });\n    } finally {\n      setIsScanning(false);\n    }\n  };\n  const handleSendDemo = async lead => {\n    try {\n      const result = await maya.executeTask(AGENT_TYPES.SALES, {\n        type: 'send_demo',\n        lead\n      });\n      addNotification({\n        type: 'success',\n        title: t('leadsCRM.actions.sendDemo'),\n        message: result.message\n      });\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Error',\n        message: 'Demo send failed'\n      });\n    }\n  };\n  const getStatusColor = status => {\n    var _statusOptions$find;\n    return ((_statusOptions$find = statusOptions.find(s => s.value === status)) === null || _statusOptions$find === void 0 ? void 0 : _statusOptions$find.color) || '#64748b';\n  };\n  const getStatusLabel = status => {\n    var _statusOptions$find2;\n    return ((_statusOptions$find2 = statusOptions.find(s => s.value === status)) === null || _statusOptions$find2 === void 0 ? void 0 : _statusOptions$find2.label) || status;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"crm-container\",\n    dir: isRTL ? 'rtl' : 'ltr',\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"crm-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"crm-title\",\n        children: [/*#__PURE__*/_jsxDEV(Users, {\n          size: 28\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: t('leadsCRM.title')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: t('leadsCRM.leadCount', {\n              count: filteredLeads.length\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(motion.button, {\n        whileHover: {\n          scale: 1.02\n        },\n        whileTap: {\n          scale: 0.98\n        },\n        onClick: handleScanLeads,\n        disabled: isScanning,\n        className: \"btn-primary scan-btn\",\n        children: isScanning ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Search, {\n            size: 18,\n            className: \"animate-spin\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 15\n          }, this), t('common.scanning')]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Search, {\n            size: 18\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 15\n          }, this), t('leadsCRM.scanNew')]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"crm-filters glass-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"search-box\",\n        children: [/*#__PURE__*/_jsxDEV(Search, {\n          size: 18\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: t('leadsCRM.searchPlaceholder'),\n          value: searchQuery,\n          onChange: e => setSearchQuery(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-filters\",\n        children: statusOptions.map(status => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setStatusFilter(status.value),\n          className: `status-filter-btn ${statusFilter === status.value ? 'active' : ''}`,\n          style: {\n            '--status-color': status.color\n          },\n          children: status.label\n        }, status.value, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"crm-stats\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"crm-stat glass-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-value text-gradient\",\n          children: leadsWithFallback.filter(l => l.status === 'new').length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-label\",\n          children: t('leadsCRM.stats.newLeads')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"crm-stat glass-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-value\",\n          style: {\n            color: '#f59e0b'\n          },\n          children: leadsWithFallback.filter(l => l.status === 'contacted').length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-label\",\n          children: t('leadsCRM.stats.inProgress')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"crm-stat glass-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-value\",\n          style: {\n            color: '#8b5cf6'\n          },\n          children: leadsWithFallback.filter(l => l.status === 'qualified').length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-label\",\n          children: t('leadsCRM.stats.qualified')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"crm-stat glass-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-value\",\n          style: {\n            color: '#10b981'\n          },\n          children: [\"\\u20AA\", leadsWithFallback.reduce((sum, l) => sum + l.value, 0).toLocaleString()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"stat-label\",\n          children: t('leadsCRM.stats.totalValue')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"leads-grid\",\n      children: filteredLeads.map((lead, index) => /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        transition: {\n          delay: index * 0.05\n        },\n        className: \"lead-card glass-card\",\n        onClick: () => setSelectedLead(lead),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lead-card-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-avatar\",\n            style: {\n              backgroundImage: `url(${lead.photo})`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-header-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"lead-name\",\n              children: lead.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"lead-contact\",\n              children: lead.contact\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"lead-status\",\n            style: {\n              '--status-color': getStatusColor(lead.status),\n              boxShadow: `0 0 16px ${getStatusColor(lead.status)}`\n            },\n            children: getStatusLabel(lead.status)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lead-card-body\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-meta-grid\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lead-meta-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"meta-label\",\n                children: t('leadsCRM.table.source')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 408,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"meta-value\",\n                children: [sourceIcons[lead.source], \" \", lead.source]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 409,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 407,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lead-meta-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"meta-label\",\n                children: t('leadsCRM.table.value')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 412,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"meta-value\",\n                children: [\"\\u20AA\", lead.value.toLocaleString(), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"per-night\",\n                  children: t('leadsCRM.perNight')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 413,\n                  columnNumber: 81\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 413,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"lead-meta-item\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"meta-label\",\n                children: t('leadsCRM.table.rating')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"meta-value rating\",\n                children: [/*#__PURE__*/_jsxDEV(Star, {\n                  size: 14,\n                  fill: \"#fbbf24\",\n                  color: \"#fbbf24\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 418,\n                  columnNumber: 23\n                }, this), lead.rating]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 406,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lead-card-actions\",\n          children: [/*#__PURE__*/_jsxDEV(motion.button, {\n            whileHover: {\n              scale: 1.05\n            },\n            whileTap: {\n              scale: 0.95\n            },\n            className: \"lead-action whatsapp\",\n            title: \"WhatsApp\",\n            onClick: e => e.stopPropagation(),\n            children: /*#__PURE__*/_jsxDEV(MessageCircle, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(motion.button, {\n            whileHover: {\n              scale: 1.05\n            },\n            whileTap: {\n              scale: 0.95\n            },\n            className: \"lead-action call\",\n            title: t('leadsCRM.actions.call'),\n            onClick: e => e.stopPropagation(),\n            children: /*#__PURE__*/_jsxDEV(Phone, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 15\n        }, this)]\n      }, lead.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 7\n    }, this), selectedLead && /*#__PURE__*/_jsxDEV(motion.div, {\n      initial: {\n        opacity: 0\n      },\n      animate: {\n        opacity: 1\n      },\n      className: \"lead-modal-backdrop\",\n      onClick: () => setSelectedLead(null),\n      children: /*#__PURE__*/_jsxDEV(motion.div, {\n        initial: {\n          opacity: 0,\n          scale: 0.9\n        },\n        animate: {\n          opacity: 1,\n          scale: 1\n        },\n        className: \"lead-modal glass-card\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lead-modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"source-icon large\",\n              children: sourceIcons[selectedLead.source]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: selectedLead.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: selectedLead.contact\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSelectedLead(null),\n            className: \"close-modal-btn\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lead-modal-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-details-grid\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail-item\",\n              children: [/*#__PURE__*/_jsxDEV(Mail, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 484,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"label\",\n                  children: t('leadsCRM.modal.email')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 486,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"value\",\n                  children: selectedLead.email\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 487,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 485,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail-item\",\n              children: [/*#__PURE__*/_jsxDEV(Phone, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 491,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"label\",\n                  children: t('leadsCRM.modal.phone')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 493,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"value\",\n                  children: selectedLead.phone\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail-item\",\n              children: [/*#__PURE__*/_jsxDEV(Globe, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 498,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"label\",\n                  children: t('leadsCRM.modal.source')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 500,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"value\",\n                  children: selectedLead.source\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 501,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 499,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"detail-item\",\n              children: [/*#__PURE__*/_jsxDEV(Calendar, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 505,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"label\",\n                  children: t('leadsCRM.modal.createdAt')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 507,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"value\",\n                  children: new Date(selectedLead.createdAt).toLocaleDateString(lang === 'he' ? 'he-IL' : lang === 'el' ? 'el-GR' : 'en-US')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 508,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 506,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 504,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-notes\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: t('leadsCRM.modal.notes')\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 516,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: selectedLead.notes\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 517,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 515,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"lead-actions\",\n            children: [/*#__PURE__*/_jsxDEV(motion.button, {\n              whileHover: {\n                scale: 1.02\n              },\n              whileTap: {\n                scale: 0.98\n              },\n              onClick: () => handleSendDemo(selectedLead),\n              className: \"btn-primary\",\n              children: [/*#__PURE__*/_jsxDEV(Mail, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 527,\n                columnNumber: 21\n              }, this), t('leadsCRM.actions.sendDemo')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(motion.button, {\n              whileHover: {\n                scale: 1.02\n              },\n              whileTap: {\n                scale: 0.98\n              },\n              className: \"btn-secondary\",\n              children: [/*#__PURE__*/_jsxDEV(MessageCircle, {\n                size: 18\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 535,\n                columnNumber: 21\n              }, this), t('leadsCRM.modal.sendMessage')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 530,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 520,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 286,\n    columnNumber: 5\n  }, this);\n};\n_s(LeadsCRM, \"D87Nhhq9CSjAtdfq8KkA+WkjCbo=\", false, function () {\n  return [useTranslations, useStore];\n});\n_c = LeadsCRM;\nexport default LeadsCRM;\nvar _c;\n$RefreshReg$(_c, \"LeadsCRM\");","map":{"version":3,"names":["React","useEffect","useRef","useState","motion","Users","Search","Filter","Plus","Mail","Phone","Globe","Calendar","Tag","Star","ArrowUpRight","ExternalLink","MessageCircle","useTranslations","useStore","maya","AGENT_TYPES","getLeads","getAutomationStats","subscribeToLeads","whatsappService","jsxDEV","_jsxDEV","Fragment","_Fragment","sourceIcons","airbnb","booking","direct","referral","social","sampleLeads","id","name","contact","photo","email","phone","source","status","value","rating","createdAt","notes","LeadsCRM","_s","t","searchQuery","setSearchQuery","statusFilter","setStatusFilter","selectedLead","setSelectedLead","isScanning","setIsScanning","leads","setLeads","isLoadingLeads","setIsLoadingLeads","greetedLeadIdsRef","Set","addNotification","lang","setStoreLeads","isRTL","statusOptions","label","color","leadsWithFallback","length","filteredLeads","filter","lead","matchesSearch","toLowerCase","includes","matchesStatus","normalizeLead","safeLead","fallbackId","lead_id","Date","now","property_name","property","full_name","guest_name","created_at","toISOString","encodeURIComponent","payment_link","paymentLink","last_objection","lead_quality","isActive","loadLeads","results","normalized","Array","isArray","map","error","console","handleNewLead","incoming","prev","nextLeads","current","has","add","sendLeadGreeting","type","title","message","handleLeadUpdated","eventSource","close","handleScanLeads","result","executeTask","SCRAPER","platforms","slice","forEach","messageKey","messageValues","platform","data","handleSendDemo","SALES","getStatusColor","_statusOptions$find","find","s","getStatusLabel","_statusOptions$find2","className","dir","children","size","fileName","_jsxFileName","lineNumber","columnNumber","count","button","whileHover","scale","whileTap","onClick","disabled","placeholder","onChange","e","target","style","l","reduce","sum","toLocaleString","index","div","initial","opacity","y","animate","transition","delay","backgroundImage","boxShadow","fill","stopPropagation","toLocaleDateString","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/components/crm/LeadsCRM.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { motion } from 'framer-motion';\nimport {\n  Users, Search, Filter, Plus,\n  Mail, Phone, Globe, Calendar, Tag, Star,\n  ArrowUpRight, ExternalLink, MessageCircle\n} from 'lucide-react';\nimport useTranslations from '../../hooks/useTranslations';\nimport useStore from '../../store/useStore';\nimport { maya, AGENT_TYPES } from '../../services/agentOrchestrator';\nimport { getLeads, getAutomationStats, subscribeToLeads } from '../../services/api';\nimport { whatsappService } from '../../services/whatsapp';\nimport './LeadsCRM.css';\n\nconst sourceIcons = {\n  airbnb: 'ðŸ ',\n  booking: 'ðŸ“…',\n  direct: 'ðŸŽ¯',\n  referral: 'ðŸ‘¥',\n  social: 'ðŸ“±',\n};\n\n// Sample leads data\nconst sampleLeads = [\n  {\n    id: 1,\n    name: 'Luxury Property in Herzliya',\n    contact: 'David Cohen',\n    photo: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=240&fit=crop&auto=format',\n    email: 'david@example.com',\n    phone: '050-1234567',\n    source: 'airbnb',\n    status: 'new',\n    value: 1200,\n    rating: 4.8,\n    createdAt: '2026-01-25T10:30:00Z',\n    notes: 'Seaview property with 3 bedrooms',\n  },\n  {\n    id: 2,\n    name: 'Seaside Villa - Netanya',\n    contact: 'Sarah Levy',\n    photo: 'https://images.unsplash.com/photo-1487412720507-e7ab37603c6f?w=240&fit=crop&auto=format',\n    email: 'sarah@example.com',\n    phone: '052-9876543',\n    source: 'booking',\n    status: 'contacted',\n    value: 850,\n    rating: 4.5,\n    createdAt: '2026-01-24T14:20:00Z',\n    notes: 'High intent, awaiting proposal',\n  },\n  {\n    id: 3,\n    name: 'Penthouse in Tel Aviv',\n    contact: 'Yossi Mizrahi',\n    photo: 'https://images.unsplash.com/photo-1544723795-3fb6469f5b39?w=240&fit=crop&auto=format',\n    email: 'yossi@example.com',\n    phone: '054-5555555',\n    source: 'direct',\n    status: 'qualified',\n    value: 2000,\n    rating: 4.9,\n    createdAt: '2026-01-23T09:15:00Z',\n    notes: 'Premium property, closing expected',\n  },\n  {\n    id: 4,\n    name: 'Vacation Apartment - Eilat',\n    contact: 'Michal Barak',\n    photo: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=240&fit=crop&auto=format',\n    email: 'michal@example.com',\n    phone: '053-3333333',\n    source: 'social',\n    status: 'converted',\n    value: 600,\n    rating: 4.3,\n    createdAt: '2026-01-22T16:45:00Z',\n    notes: 'Deal closed!',\n  },\n  {\n    id: 5,\n    name: 'Guesthouse in the North',\n    contact: 'Avi Shimon',\n    photo: 'https://images.unsplash.com/photo-1525134479668-1bee5c7c6845?w=240&fit=crop&auto=format',\n    email: 'avi@example.com',\n    phone: '050-7777777',\n    source: 'referral',\n    status: 'new',\n    value: 750,\n    rating: 4.6,\n    createdAt: '2026-01-25T08:00:00Z',\n    notes: 'Referral lead, high potential',\n  },\n];\n\nconst LeadsCRM = () => {\n  const { t } = useTranslations();\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [selectedLead, setSelectedLead] = useState(null);\n  const [isScanning, setIsScanning] = useState(false);\n  const [leads, setLeads] = useState([]);\n  const [isLoadingLeads, setIsLoadingLeads] = useState(true);\n  const greetedLeadIdsRef = useRef(new Set());\n  const { addNotification, lang, setLeads: setStoreLeads } = useStore();\n\n  const isRTL = lang === 'he';\n\n  const statusOptions = [\n    { value: 'all', label: t('leadsCRM.status.all'), color: '#64748b' },\n    { value: 'new', label: t('leadsCRM.status.new'), color: '#3b82f6' },\n    { value: 'contacted', label: t('leadsCRM.status.contacted'), color: '#f59e0b' },\n    { value: 'qualified', label: t('leadsCRM.status.qualified'), color: '#8b5cf6' },\n    { value: 'converted', label: t('leadsCRM.status.converted'), color: '#10b981' },\n    { value: 'lost', label: t('leadsCRM.status.lost'), color: '#ef4444' },\n  ];\n\n  const leadsWithFallback = leads.length > 0 ? leads : sampleLeads;\n  const filteredLeads = leadsWithFallback.filter((lead) => {\n    const matchesSearch =\n      lead.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      lead.contact.toLowerCase().includes(searchQuery.toLowerCase());\n    const matchesStatus = statusFilter === 'all' || lead.status === statusFilter;\n    return matchesSearch && matchesStatus;\n  });\n\n  const normalizeLead = (lead) => {\n    const safeLead = lead || {};\n    const fallbackId = safeLead.id || safeLead.lead_id || `${safeLead.email || safeLead.phone || Date.now()}`;\n    const name = safeLead.name || safeLead.property_name || safeLead.property || 'Unknown Property';\n    const contact = safeLead.contact || safeLead.full_name || safeLead.guest_name || 'Guest';\n    return {\n      id: fallbackId,\n      name,\n      contact,\n      email: safeLead.email || '',\n      phone: safeLead.phone || '',\n      source: safeLead.source || 'direct',\n      status: safeLead.status || 'new',\n      value: safeLead.value || 0,\n      rating: safeLead.rating || 0,\n      createdAt: safeLead.createdAt || safeLead.created_at || new Date().toISOString(),\n      notes: safeLead.notes || '',\n      photo: safeLead.photo || `https://api.dicebear.com/7.x/personas/svg?seed=${encodeURIComponent(contact)}&backgroundColor=0b1220&radius=20`,\n      property: safeLead.property || name,\n      payment_link: safeLead.payment_link || safeLead.paymentLink || '',\n      last_objection: safeLead.last_objection || '',\n      lead_quality: safeLead.lead_quality || 0,\n    };\n  };\n\n  useEffect(() => {\n    let isActive = true;\n    const loadLeads = async () => {\n      setIsLoadingLeads(true);\n      try {\n        const results = await getLeads(statusFilter === 'all' ? null : statusFilter);\n      const normalized = Array.isArray(results) ? results.map(normalizeLead) : [];\n        if (isActive) {\n          setLeads(normalized);\n        setStoreLeads(normalized);\n        }\n      } catch (error) {\n        console.error('Failed to load leads:', error);\n      } finally {\n        if (isActive) setIsLoadingLeads(false);\n      }\n    };\n\n    loadLeads();\n    return () => {\n      isActive = false;\n    };\n  }, [statusFilter, setStoreLeads]);\n\n  useEffect(() => {\n    const handleNewLead = async (incoming) => {\n      const normalized = normalizeLead(incoming);\n      setLeads((prev) => {\n        const nextLeads = [normalized, ...prev];\n        setStoreLeads(nextLeads);\n        return nextLeads;\n      });\n\n      if (!greetedLeadIdsRef.current.has(normalized.id)) {\n        greetedLeadIdsRef.current.add(normalized.id);\n        try {\n          await whatsappService.sendLeadGreeting(normalized, lang);\n          addNotification({\n            type: 'success',\n            title: t('leadsCRM.actions.sendDemo'),\n            message: t('leadsCRM.autoGreetingSent', { name: normalized.contact }),\n          });\n        } catch (error) {\n          console.error('Failed to send greeting:', error);\n        }\n      }\n    };\n\n    const handleLeadUpdated = (incoming) => {\n      const normalized = normalizeLead(incoming);\n      setLeads((prev) => {\n        const nextLeads = prev.map((lead) =>\n          lead.id === normalized.id ? { ...lead, ...normalized } : lead\n        );\n        setStoreLeads(nextLeads);\n        return nextLeads;\n      });\n    };\n\n    const eventSource = subscribeToLeads(handleNewLead, handleLeadUpdated, (error) => {\n      console.error('Lead stream error:', error);\n    });\n\n    return () => {\n      if (eventSource && eventSource.close) eventSource.close();\n    };\n  }, [addNotification, lang, setStoreLeads, t]);\n\n  const handleScanLeads = async () => {\n    setIsScanning(true);\n    try {\n      const result = await maya.executeTask(AGENT_TYPES.SCRAPER, {\n        platforms: ['airbnb', 'booking'],\n      });\n      \n      addNotification({\n        type: 'success',\n        title: t('leadsCRM.scanNew'),\n        message: result.message,\n      });\n\n      if (result.leads && result.leads.length > 0) {\n        result.leads.slice(0, 3).forEach((lead) => {\n          addNotification({\n            type: 'info',\n            title: t('notifications.newLead'),\n            messageKey: 'notifications.messages.newLead',\n            messageValues: { platform: lead.platform || 'Airbnb' },\n            data: lead,\n          });\n        });\n      }\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Error',\n        message: 'Lead scan failed',\n      });\n    } finally {\n      setIsScanning(false);\n    }\n  };\n\n  const handleSendDemo = async (lead) => {\n    try {\n      const result = await maya.executeTask(AGENT_TYPES.SALES, {\n        type: 'send_demo',\n        lead,\n      });\n      \n      addNotification({\n        type: 'success',\n        title: t('leadsCRM.actions.sendDemo'),\n        message: result.message,\n      });\n    } catch (error) {\n      addNotification({\n        type: 'error',\n        title: 'Error',\n        message: 'Demo send failed',\n      });\n    }\n  };\n\n  const getStatusColor = (status) => {\n    return statusOptions.find((s) => s.value === status)?.color || '#64748b';\n  };\n\n  const getStatusLabel = (status) => {\n    return statusOptions.find((s) => s.value === status)?.label || status;\n  };\n\n  return (\n    <div className=\"crm-container\" dir={isRTL ? 'rtl' : 'ltr'}>\n      {/* Header */}\n      <div className=\"crm-header\">\n        <div className=\"crm-title\">\n          <Users size={28} />\n          <div>\n            <h2>{t('leadsCRM.title')}</h2>\n            <p>{t('leadsCRM.leadCount', { count: filteredLeads.length })}</p>\n          </div>\n        </div>\n        <motion.button\n          whileHover={{ scale: 1.02 }}\n          whileTap={{ scale: 0.98 }}\n          onClick={handleScanLeads}\n          disabled={isScanning}\n          className=\"btn-primary scan-btn\"\n        >\n          {isScanning ? (\n            <>\n              <Search size={18} className=\"animate-spin\" />\n              {t('common.scanning')}\n            </>\n          ) : (\n            <>\n              <Search size={18} />\n              {t('leadsCRM.scanNew')}\n            </>\n          )}\n        </motion.button>\n      </div>\n\n      {/* Filters */}\n      <div className=\"crm-filters glass-card\">\n        <div className=\"search-box\">\n          <Search size={18} />\n          <input\n            type=\"text\"\n            placeholder={t('leadsCRM.searchPlaceholder')}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n          />\n        </div>\n        <div className=\"status-filters\">\n          {statusOptions.map((status) => (\n            <button\n              key={status.value}\n              onClick={() => setStatusFilter(status.value)}\n              className={`status-filter-btn ${\n                statusFilter === status.value ? 'active' : ''\n              }`}\n              style={{\n                '--status-color': status.color,\n              }}\n            >\n              {status.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Stats Row */}\n      <div className=\"crm-stats\">\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value text-gradient\">\n            {leadsWithFallback.filter((l) => l.status === 'new').length}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.newLeads')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#f59e0b' }}>\n            {leadsWithFallback.filter((l) => l.status === 'contacted').length}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.inProgress')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#8b5cf6' }}>\n            {leadsWithFallback.filter((l) => l.status === 'qualified').length}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.qualified')}</span>\n        </div>\n        <div className=\"crm-stat glass-card\">\n          <span className=\"stat-value\" style={{ color: '#10b981' }}>\n            â‚ª{leadsWithFallback.reduce((sum, l) => sum + l.value, 0).toLocaleString()}\n          </span>\n          <span className=\"stat-label\">{t('leadsCRM.stats.totalValue')}</span>\n        </div>\n      </div>\n\n      {/* Leads Grid */}\n      <div className=\"leads-grid\">\n        {filteredLeads.map((lead, index) => (\n          <motion.div\n            key={lead.id}\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: index * 0.05 }}\n            className=\"lead-card glass-card\"\n            onClick={() => setSelectedLead(lead)}\n          >\n              <div className=\"lead-card-header\">\n                <div\n                  className=\"lead-avatar\"\n                  style={{ backgroundImage: `url(${lead.photo})` }}\n                />\n                <div className=\"lead-header-info\">\n                  <span className=\"lead-name\">{lead.name}</span>\n                  <span className=\"lead-contact\">{lead.contact}</span>\n                </div>\n                <span\n                  className=\"lead-status\"\n                  style={{\n                    '--status-color': getStatusColor(lead.status),\n                    boxShadow: `0 0 16px ${getStatusColor(lead.status)}`,\n                  }}\n                >\n                  {getStatusLabel(lead.status)}\n                </span>\n              </div>\n\n              <div className=\"lead-card-body\">\n                <div className=\"lead-meta-grid\">\n                  <div className=\"lead-meta-item\">\n                    <span className=\"meta-label\">{t('leadsCRM.table.source')}</span>\n                    <span className=\"meta-value\">{sourceIcons[lead.source]} {lead.source}</span>\n                  </div>\n                  <div className=\"lead-meta-item\">\n                    <span className=\"meta-label\">{t('leadsCRM.table.value')}</span>\n                    <span className=\"meta-value\">â‚ª{lead.value.toLocaleString()} <span className=\"per-night\">{t('leadsCRM.perNight')}</span></span>\n                  </div>\n                  <div className=\"lead-meta-item\">\n                    <span className=\"meta-label\">{t('leadsCRM.table.rating')}</span>\n                    <span className=\"meta-value rating\">\n                      <Star size={14} fill=\"#fbbf24\" color=\"#fbbf24\" />\n                      {lead.rating}\n                    </span>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"lead-card-actions\">\n                <motion.button\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                  className=\"lead-action whatsapp\"\n                  title=\"WhatsApp\"\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  <MessageCircle size={16} />\n                </motion.button>\n                <motion.button\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                  className=\"lead-action call\"\n                  title={t('leadsCRM.actions.call')}\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  <Phone size={16} />\n                </motion.button>\n              </div>\n          </motion.div>\n        ))}\n      </div>\n\n      {/* Lead Detail Modal */}\n      {selectedLead && (\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          className=\"lead-modal-backdrop\"\n          onClick={() => setSelectedLead(null)}\n        >\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9 }}\n            animate={{ opacity: 1, scale: 1 }}\n            className=\"lead-modal glass-card\"\n            onClick={(e) => e.stopPropagation()}\n          >\n              <div className=\"lead-modal-header\">\n                <div className=\"lead-info\">\n                  <span className=\"source-icon large\">\n                    {sourceIcons[selectedLead.source]}\n                  </span>\n                  <div>\n                    <h3>{selectedLead.name}</h3>\n                    <p>{selectedLead.contact}</p>\n                  </div>\n                </div>\n                <button\n                  onClick={() => setSelectedLead(null)}\n                  className=\"close-modal-btn\"\n                >\n                  Ã—\n                </button>\n              </div>\n\n              <div className=\"lead-modal-content\">\n                <div className=\"lead-details-grid\">\n                  <div className=\"detail-item\">\n                    <Mail size={18} />\n                    <div>\n                    <span className=\"label\">{t('leadsCRM.modal.email')}</span>\n                      <span className=\"value\">{selectedLead.email}</span>\n                    </div>\n                  </div>\n                  <div className=\"detail-item\">\n                    <Phone size={18} />\n                    <div>\n                  <span className=\"label\">{t('leadsCRM.modal.phone')}</span>\n                      <span className=\"value\">{selectedLead.phone}</span>\n                    </div>\n                  </div>\n                  <div className=\"detail-item\">\n                    <Globe size={18} />\n                    <div>\n                  <span className=\"label\">{t('leadsCRM.modal.source')}</span>\n                      <span className=\"value\">{selectedLead.source}</span>\n                    </div>\n                  </div>\n                  <div className=\"detail-item\">\n                    <Calendar size={18} />\n                    <div>\n                  <span className=\"label\">{t('leadsCRM.modal.createdAt')}</span>\n                      <span className=\"value\">\n                    {new Date(selectedLead.createdAt).toLocaleDateString(lang === 'he' ? 'he-IL' : lang === 'el' ? 'el-GR' : 'en-US')}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"lead-notes\">\n              <h4>{t('leadsCRM.modal.notes')}</h4>\n                  <p>{selectedLead.notes}</p>\n                </div>\n\n                <div className=\"lead-actions\">\n                  <motion.button\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    onClick={() => handleSendDemo(selectedLead)}\n                    className=\"btn-primary\"\n                  >\n                    <Mail size={18} />\n                  {t('leadsCRM.actions.sendDemo')}\n                  </motion.button>\n                  <motion.button\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                    className=\"btn-secondary\"\n                  >\n                    <MessageCircle size={18} />\n                  {t('leadsCRM.modal.sendMessage')}\n                  </motion.button>\n                </div>\n              </div>\n          </motion.div>\n        </motion.div>\n      )}\n    </div>\n  );\n};\n\nexport default LeadsCRM;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}