{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{CheckCircle2,Languages,Wrench,Sparkles,Brush,AlertTriangle}from'lucide-react';import useTranslations from'../../hooks/useTranslations';import useStore from'../../store/useStore';import{setWorkerLanguage,clockInStaff,getStaffTasks,updateStaffTaskStatus,subscribeToStaff,updateStaffLocation,reportIssue}from'../../services/api';import'./FieldView.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MARKET_LANGUAGES={US:[{code:'en',label:'English'},{code:'es',label:'Spanish'}],IL:[{code:'he',label:'Hebrew'},{code:'th',label:'Thai'},{code:'hi',label:'Hindi'}]};const TASK_ICONS={Cleaning:Brush,Maintenance:Wrench,'VIP Treats':Sparkles,cleaning:Brush,maintenance:Wrench,vip_treats:Sparkles};const FieldView=_ref=>{var _staffProfile$rank,_staffProfile$goldPoi;let{clockInOnly=false,autoClockInOnScan=false}=_ref;const{t}=useTranslations();const{fieldLanguage,setFieldLanguage,market,staffProfile,setStaffProfile,addNotification}=useStore();const marketKey=market==='IL'?'IL':'US';const languages=MARKET_LANGUAGES[marketKey]||MARKET_LANGUAGES.US;const[staffIdInput,setStaffIdInput]=useState(staffProfile.staffId||'');const[staffNameInput,setStaffNameInput]=useState(staffProfile.name||'');const[staffPhoneInput,setStaffPhoneInput]=useState(staffProfile.phone||'');const[tasks,setTasks]=useState([]);const[loadingTasks,setLoadingTasks]=useState(false);const[toast,setToast]=useState('');const[pointsToast,setPointsToast]=useState('');const[levelToast,setLevelToast]=useState('');const[showIssueModal,setShowIssueModal]=useState(false);const[issueTask,setIssueTask]=useState(null);const[issueNote,setIssueNote]=useState('');const[issuePhoto,setIssuePhoto]=useState(null);const[issueSending,setIssueSending]=useState(false);const[cameraOn,setCameraOn]=useState(false);const[pendingFinishTask,setPendingFinishTask]=useState(null);const[taskActionLoading,setTaskActionLoading]=useState({});const videoRef=useRef(null);const finishPhotoRef=useRef(null);const scanLoopRef=useRef(null);const prevTaskCountRef=useRef(0);const autoClockInRef=useRef(false);const staffProfileRef=useRef(staffProfile);const prevGoldPointsRef=useRef(staffProfile.goldPoints||0);useEffect(()=>{staffProfileRef.current=staffProfile;},[staffProfile]);useEffect(()=>{const allowed=languages.map(lang=>lang.code);if(!allowed.includes(fieldLanguage)){setFieldLanguage(allowed[0]);}},[fieldLanguage,languages,setFieldLanguage]);useEffect(()=>{const syncWorkerLanguage=async()=>{try{await setWorkerLanguage(fieldLanguage);}catch(error){console.error('Failed to sync worker language:',error);}};syncWorkerLanguage();},[fieldLanguage]);useEffect(()=>{const stopCamera=()=>{var _videoRef$current;if(scanLoopRef.current){cancelAnimationFrame(scanLoopRef.current);}const stream=(_videoRef$current=videoRef.current)===null||_videoRef$current===void 0?void 0:_videoRef$current.srcObject;if(stream){stream.getTracks().forEach(track=>track.stop());if(videoRef.current)videoRef.current.srcObject=null;}};if(!cameraOn){stopCamera();return;}const start=async()=>{try{const stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}});if(!videoRef.current)return;videoRef.current.srcObject=stream;await videoRef.current.play();if('BarcodeDetector'in window){const detector=new window.BarcodeDetector({formats:['qr_code']});const scan=async()=>{if(!videoRef.current)return;try{const barcodes=await detector.detect(videoRef.current);if(barcodes&&barcodes.length>0){const value=barcodes[0].rawValue||'';if(value){setStaffIdInput(value);setToast(t('field.toast.qrScanned'));setTimeout(()=>setToast(''),1500);if(autoClockInOnScan&&!autoClockInRef.current){autoClockInRef.current=true;handleClockIn(value);}setCameraOn(false);return;}}}catch(error){// ignore scan errors\n}scanLoopRef.current=requestAnimationFrame(scan);};scanLoopRef.current=requestAnimationFrame(scan);}}catch(error){setToast(t('field.toast.cameraUnavailable'));setTimeout(()=>setToast(''),2000);setCameraOn(false);}};start();return stopCamera;},[cameraOn]);useEffect(()=>{const loadTasks=async()=>{if(!staffProfile.staffId)return;setLoadingTasks(true);try{const data=await getStaffTasks(staffProfile.staffId);setTasks(data);}catch(error){console.error('Failed to load tasks:',error);}finally{setLoadingTasks(false);}};loadTasks();},[staffProfile.staffId]);useEffect(()=>{if(!staffProfile.staffId||clockInOnly)return;const interval=setInterval(async()=>{try{const data=await getStaffTasks(staffProfile.staffId);setTasks(data);}catch(error){// ignore polling errors\n}},5000);return()=>clearInterval(interval);},[staffProfile.staffId,clockInOnly]);useEffect(()=>{const count=tasks.length;if(count>prevTaskCountRef.current){if(navigator.vibrate){navigator.vibrate([200,100,200]);}try{const ctx=new(window.AudioContext||window.webkitAudioContext)();const osc=ctx.createOscillator();const gain=ctx.createGain();osc.type='sine';osc.frequency.value=880;gain.gain.value=0.05;osc.connect(gain);gain.connect(ctx.destination);osc.start();setTimeout(()=>{osc.stop();ctx.close();},150);}catch(error){// audio not available\n}setToast(t('field.toast.newTask'));setTimeout(()=>setToast(''),1500);}prevTaskCountRef.current=count;},[tasks]);useEffect(()=>{if(!staffProfile.staffId)return;const source=subscribeToStaff(update=>{var _update$gold_points,_update$rank,_update$rank_tier;const current=staffProfileRef.current;if((update===null||update===void 0?void 0:update.id)!==current.staffId)return;setStaffProfile({...current,goldPoints:(_update$gold_points=update.gold_points)!==null&&_update$gold_points!==void 0?_update$gold_points:current.goldPoints,rank:(_update$rank=update.rank)!==null&&_update$rank!==void 0?_update$rank:current.rank,rankTier:(_update$rank_tier=update.rank_tier)!==null&&_update$rank_tier!==void 0?_update$rank_tier:current.rankTier});});return()=>{if(source&&source.close)source.close();};},[staffProfile.staffId,setStaffProfile]);const handleClockIn=async overrideStaffId=>{const staffIdValue=overrideStaffId||staffIdInput;if(!staffIdValue)return;try{var _ref2,_result$gold_points,_result$rank;const payload={staff_id:staffIdValue,name:staffNameInput,phone:staffPhoneInput};if(!staffProfile.language){payload.language=fieldLanguage;}const result=await clockInStaff(payload);if(navigator.geolocation){navigator.geolocation.getCurrentPosition(position=>{updateStaffLocation(result.id,position.coords.latitude,position.coords.longitude).catch(()=>{});},()=>{});}setStaffProfile({staffId:result.id,name:result.name,phone:result.phone,goldPoints:(_ref2=(_result$gold_points=result.gold_points)!==null&&_result$gold_points!==void 0?_result$gold_points:result.points)!==null&&_ref2!==void 0?_ref2:0,rank:(_result$rank=result.rank)!==null&&_result$rank!==void 0?_result$rank:null,rankTier:result.rank_tier||staffProfile.rankTier||'starter',language:result.language||staffProfile.language||fieldLanguage});if(result.language){setFieldLanguage(result.language);}if(!clockInOnly){const data=await getStaffTasks(result.id);setTasks(data);}setToast(t('field.toast.clockedIn'));setTimeout(()=>setToast(''),1500);autoClockInRef.current=false;}catch(error){console.error('Clock-in failed:',error);autoClockInRef.current=false;}};const handleTaskUpdate=async(taskId,status)=>{const task=tasks.find(item=>item.id===taskId);const actionKey=`${taskId}-${status}`;setTaskActionLoading(prev=>({...prev,[actionKey]:true}));try{const result=await updateStaffTaskStatus(taskId,status);const data=await getStaffTasks(staffProfile.staffId);setTasks(data);if((result===null||result===void 0?void 0:result.gold_points)!==undefined||(result===null||result===void 0?void 0:result.rank)!==undefined||result!==null&&result!==void 0&&result.rank_tier){var _result$gold_points2,_result$rank2,_result$rank_tier;setStaffProfile({...staffProfile,goldPoints:(_result$gold_points2=result.gold_points)!==null&&_result$gold_points2!==void 0?_result$gold_points2:staffProfile.goldPoints,rank:(_result$rank2=result.rank)!==null&&_result$rank2!==void 0?_result$rank2:staffProfile.rank,rankTier:(_result$rank_tier=result.rank_tier)!==null&&_result$rank_tier!==void 0?_result$rank_tier:staffProfile.rankTier});}if(status==='finished'&&(result===null||result===void 0?void 0:result.points_awarded)!==undefined){const pointsMessage=t('field.toast.goldPoints',{count:result.points_awarded});setPointsToast(pointsMessage);setTimeout(()=>setPointsToast(''),1800);}if(task!==null&&task!==void 0&&task.room){addNotification({type:status==='finished'?'success':'activity',action:status,room:task.room,title:t('activity.title',{room:task.room})});}setToast(status==='finished'?t('field.toast.roomReady'):t('field.toast.taskUpdated'));setTimeout(()=>setToast(''),1500);}catch(error){console.error('Failed to update task:',error);}finally{setTaskActionLoading(prev=>({...prev,[actionKey]:false}));}};const handleFinishClick=task=>{if(taskActionLoading[`${task.id}-finished`])return;setTaskActionLoading(prev=>({...prev,[`${task.id}-finished`]:true}));setPendingFinishTask(task);if(finishPhotoRef.current){finishPhotoRef.current.value='';finishPhotoRef.current.click();}};const handleFinishPhotoSelected=event=>{var _event$target$files;const file=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0];if(!pendingFinishTask)return;if(!file){setTaskActionLoading(prev=>({...prev,[`${pendingFinishTask.id}-finished`]:false}));setPendingFinishTask(null);return;}handleTaskUpdate(pendingFinishTask.id,'finished');setPendingFinishTask(null);};const openIssueModal=task=>{setIssueTask(task);setIssueNote('');setIssuePhoto(null);setShowIssueModal(true);};const handleIssueSubmit=async()=>{if(!issueTask||!issuePhoto)return;setIssueSending(true);try{await reportIssue({roomId:issueTask.room_id,roomName:issueTask.room,taskId:issueTask.id,note:issueNote,photo:issuePhoto});if(issueTask!==null&&issueTask!==void 0&&issueTask.room){addNotification({type:'damage',action:'damage_reported',room:issueTask.room,title:t('activity.damageReported',{room:issueTask.room}),message:issueNote||''});}setToast(t('field.toast.issueReported'));setTimeout(()=>setToast(''),1500);setShowIssueModal(false);}catch(error){console.error('Failed to report issue:',error);}finally{setIssueSending(false);}};const goldPoints=staffProfile.goldPoints||0;const goldTier=goldPoints>=100?3:goldPoints>=50?2:goldPoints>=10?1:0;useEffect(()=>{const prev=prevGoldPointsRef.current;if(prev<100&&goldPoints>=100){const levelMessage=t('field.toast.levelUp');setLevelToast(levelMessage);setTimeout(()=>setLevelToast(''),2200);}prevGoldPointsRef.current=goldPoints;},[goldPoints,marketKey,staffProfile.rankTier]);useEffect(()=>{if(!staffProfile.staffId||!navigator.geolocation)return()=>{};const updateLocation=()=>{navigator.geolocation.getCurrentPosition(position=>{updateStaffLocation(staffProfile.staffId,position.coords.latitude,position.coords.longitude).catch(()=>{});},()=>{});};updateLocation();const interval=setInterval(updateLocation,120000);return()=>clearInterval(interval);},[staffProfile.staffId]);return/*#__PURE__*/_jsxs(\"div\",{className:`field-view gold-tier-${goldTier}`,children:[/*#__PURE__*/_jsx(\"input\",{ref:finishPhotoRef,type:\"file\",accept:\"image/*\",style:{display:'none'},onChange:handleFinishPhotoSelected}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field-title\",children:[/*#__PURE__*/_jsx(\"h2\",{children:t('field.title')}),/*#__PURE__*/_jsx(\"span\",{className:\"field-subtitle\",children:t('field.subtitle')})]}),staffProfile.staffId&&/*#__PURE__*/_jsxs(\"div\",{className:\"field-rank\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"field-rank-label\",children:t('field.rank')}),/*#__PURE__*/_jsx(\"span\",{className:\"field-rank-value\",children:(_staffProfile$rank=staffProfile.rank)!==null&&_staffProfile$rank!==void 0?_staffProfile$rank:'-'}),/*#__PURE__*/_jsx(\"span\",{className:\"field-rank-points\",children:t('field.points',{count:(_staffProfile$goldPoi=staffProfile.goldPoints)!==null&&_staffProfile$goldPoi!==void 0?_staffProfile$goldPoi:0})}),/*#__PURE__*/_jsx(\"span\",{className:\"field-rank-tier\",children:t(`field.rankTier.${staffProfile.rankTier||'starter'}`)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-lang-toggle\",children:[/*#__PURE__*/_jsx(Languages,{size:16}),/*#__PURE__*/_jsx(\"div\",{className:\"field-lang-options\",children:languages.map(lang=>/*#__PURE__*/_jsx(\"button\",{className:`field-lang-btn ${fieldLanguage===lang.code?'active':''}`,onClick:()=>setFieldLanguage(lang.code),children:lang.label},lang.code))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-task-list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field-clockin glass-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:t('field.clockIn.title')}),/*#__PURE__*/_jsxs(\"div\",{className:\"clockin-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:t('field.clockIn.scanPlaceholder'),value:staffIdInput,onChange:e=>setStaffIdInput(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:()=>setCameraOn(prev=>!prev),children:cameraOn?t('field.clockIn.stopCamera'):t('field.clockIn.scanQr')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:t('field.clockIn.nameOptional'),value:staffNameInput,onChange:e=>setStaffNameInput(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",placeholder:t('field.clockIn.phoneOptional'),value:staffPhoneInput,onChange:e=>setStaffPhoneInput(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleClockIn,children:t('field.clockIn.button')})]}),cameraOn&&/*#__PURE__*/_jsx(\"div\",{className:\"camera-preview\",children:/*#__PURE__*/_jsx(\"video\",{ref:videoRef,muted:true,playsInline:true})})]}),!clockInOnly&&/*#__PURE__*/_jsxs(_Fragment,{children:[loadingTasks&&/*#__PURE__*/_jsx(\"div\",{className:\"field-loading\",children:t('field.loadingTasks')}),tasks.map(task=>{const taskTypeKey=(task.task_type||'').toString().toLowerCase().replace(/\\s+/g,'_');const Icon=TASK_ICONS[task.task_type]||TASK_ICONS[taskTypeKey]||CheckCircle2;const isActiveTask=task.status!=='finished'&&Boolean(task.room_id);const taskLabel=t(`field.taskTypes.${taskTypeKey}`,{defaultValue:task.task_type});return/*#__PURE__*/_jsxs(\"div\",{className:`field-task-card ${task.status}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"task-main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"task-icon\",children:/*#__PURE__*/_jsx(Icon,{size:18})}),/*#__PURE__*/_jsxs(\"div\",{className:\"task-info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"task-title\",children:taskLabel}),/*#__PURE__*/_jsx(\"span\",{className:\"task-meta\",children:task.room})]}),isActiveTask&&/*#__PURE__*/_jsxs(\"button\",{className:\"task-issue-btn\",onClick:()=>openIssueModal(task),\"aria-label\":t('field.reportIssue'),children:[/*#__PURE__*/_jsx(AlertTriangle,{size:14}),t('field.reportIssue')]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"task-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"task-action-btn\",onClick:()=>handleTaskUpdate(task.id,'on_my_way'),disabled:task.status==='finished'||taskActionLoading[`${task.id}-on_my_way`],children:taskActionLoading[`${task.id}-on_my_way`]?t('common.loading'):t('field.actions.onMyWay')}),/*#__PURE__*/_jsx(\"button\",{className:\"task-action-btn\",onClick:()=>handleTaskUpdate(task.id,'started'),disabled:task.status==='finished'||taskActionLoading[`${task.id}-started`],children:taskActionLoading[`${task.id}-started`]?t('common.loading'):t('field.actions.cleaning')}),/*#__PURE__*/_jsx(\"button\",{className:\"task-action-btn primary\",onClick:()=>handleFinishClick(task),disabled:task.status==='finished'||taskActionLoading[`${task.id}-finished`],children:taskActionLoading[`${task.id}-finished`]?t('common.loading'):t('field.actions.finishedWithPhoto')})]})]},task.id);})]})]}),toast&&/*#__PURE__*/_jsx(\"div\",{className:\"field-toast\",children:toast}),pointsToast&&/*#__PURE__*/_jsx(\"div\",{className:\"field-toast points-toast\",children:pointsToast}),levelToast&&/*#__PURE__*/_jsx(\"div\",{className:\"field-toast level-toast\",children:levelToast}),showIssueModal&&/*#__PURE__*/_jsx(\"div\",{className:\"report-modal-backdrop is-open\",onClick:()=>setShowIssueModal(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"report-modal glass-card\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"report-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:t('field.issueModal.title')}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowIssueModal(false),className:\"close-btn\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"report-content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"issue-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:e=>{var _e$target$files;return setIssuePhoto(((_e$target$files=e.target.files)===null||_e$target$files===void 0?void 0:_e$target$files[0])||null);}}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:t('field.issueModal.notePlaceholder'),value:issueNote,onChange:e=>setIssueNote(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleIssueSubmit,disabled:issueSending||!issuePhoto,children:issueSending?t('field.issueModal.sending'):t('field.issueModal.submit')})]})})]})})]});};export default FieldView;","map":{"version":3,"names":["React","useEffect","useRef","useState","CheckCircle2","Languages","Wrench","Sparkles","Brush","AlertTriangle","useTranslations","useStore","setWorkerLanguage","clockInStaff","getStaffTasks","updateStaffTaskStatus","subscribeToStaff","updateStaffLocation","reportIssue","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MARKET_LANGUAGES","US","code","label","IL","TASK_ICONS","Cleaning","Maintenance","cleaning","maintenance","vip_treats","FieldView","_ref","_staffProfile$rank","_staffProfile$goldPoi","clockInOnly","autoClockInOnScan","t","fieldLanguage","setFieldLanguage","market","staffProfile","setStaffProfile","addNotification","marketKey","languages","staffIdInput","setStaffIdInput","staffId","staffNameInput","setStaffNameInput","name","staffPhoneInput","setStaffPhoneInput","phone","tasks","setTasks","loadingTasks","setLoadingTasks","toast","setToast","pointsToast","setPointsToast","levelToast","setLevelToast","showIssueModal","setShowIssueModal","issueTask","setIssueTask","issueNote","setIssueNote","issuePhoto","setIssuePhoto","issueSending","setIssueSending","cameraOn","setCameraOn","pendingFinishTask","setPendingFinishTask","taskActionLoading","setTaskActionLoading","videoRef","finishPhotoRef","scanLoopRef","prevTaskCountRef","autoClockInRef","staffProfileRef","prevGoldPointsRef","goldPoints","current","allowed","map","lang","includes","syncWorkerLanguage","error","console","stopCamera","_videoRef$current","cancelAnimationFrame","stream","srcObject","getTracks","forEach","track","stop","start","navigator","mediaDevices","getUserMedia","video","facingMode","play","window","detector","BarcodeDetector","formats","scan","barcodes","detect","length","value","rawValue","setTimeout","handleClockIn","requestAnimationFrame","loadTasks","data","interval","setInterval","clearInterval","count","vibrate","ctx","AudioContext","webkitAudioContext","osc","createOscillator","gain","createGain","type","frequency","connect","destination","close","source","update","_update$gold_points","_update$rank","_update$rank_tier","id","gold_points","rank","rankTier","rank_tier","overrideStaffId","staffIdValue","_ref2","_result$gold_points","_result$rank","payload","staff_id","language","result","geolocation","getCurrentPosition","position","coords","latitude","longitude","catch","points","handleTaskUpdate","taskId","status","task","find","item","actionKey","prev","undefined","_result$gold_points2","_result$rank2","_result$rank_tier","points_awarded","pointsMessage","room","action","title","handleFinishClick","click","handleFinishPhotoSelected","event","_event$target$files","file","target","files","openIssueModal","handleIssueSubmit","roomId","room_id","roomName","note","photo","message","goldTier","levelMessage","updateLocation","className","children","ref","accept","style","display","onChange","size","onClick","placeholder","e","muted","playsInline","taskTypeKey","task_type","toString","toLowerCase","replace","Icon","isActiveTask","Boolean","taskLabel","defaultValue","disabled","stopPropagation","_e$target$files"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/components/features/FieldView.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { CheckCircle2, Languages, Wrench, Sparkles, Brush, AlertTriangle } from 'lucide-react';\nimport useTranslations from '../../hooks/useTranslations';\nimport useStore from '../../store/useStore';\nimport { setWorkerLanguage, clockInStaff, getStaffTasks, updateStaffTaskStatus, subscribeToStaff, updateStaffLocation, reportIssue } from '../../services/api';\nimport './FieldView.css';\n\nconst MARKET_LANGUAGES = {\n  US: [\n    { code: 'en', label: 'English' },\n    { code: 'es', label: 'Spanish' },\n  ],\n  IL: [\n    { code: 'he', label: 'Hebrew' },\n    { code: 'th', label: 'Thai' },\n    { code: 'hi', label: 'Hindi' },\n  ],\n};\n\nconst TASK_ICONS = {\n  Cleaning: Brush,\n  Maintenance: Wrench,\n  'VIP Treats': Sparkles,\n  cleaning: Brush,\n  maintenance: Wrench,\n  vip_treats: Sparkles,\n};\n\nconst FieldView = ({ clockInOnly = false, autoClockInOnScan = false }) => {\n  const { t } = useTranslations();\n  const { fieldLanguage, setFieldLanguage, market, staffProfile, setStaffProfile, addNotification } = useStore();\n  const marketKey = market === 'IL' ? 'IL' : 'US';\n  const languages = MARKET_LANGUAGES[marketKey] || MARKET_LANGUAGES.US;\n  const [staffIdInput, setStaffIdInput] = useState(staffProfile.staffId || '');\n  const [staffNameInput, setStaffNameInput] = useState(staffProfile.name || '');\n  const [staffPhoneInput, setStaffPhoneInput] = useState(staffProfile.phone || '');\n  const [tasks, setTasks] = useState([]);\n  const [loadingTasks, setLoadingTasks] = useState(false);\n  const [toast, setToast] = useState('');\n  const [pointsToast, setPointsToast] = useState('');\n  const [levelToast, setLevelToast] = useState('');\n  const [showIssueModal, setShowIssueModal] = useState(false);\n  const [issueTask, setIssueTask] = useState(null);\n  const [issueNote, setIssueNote] = useState('');\n  const [issuePhoto, setIssuePhoto] = useState(null);\n  const [issueSending, setIssueSending] = useState(false);\n  const [cameraOn, setCameraOn] = useState(false);\n  const [pendingFinishTask, setPendingFinishTask] = useState(null);\n  const [taskActionLoading, setTaskActionLoading] = useState({});\n  const videoRef = useRef(null);\n  const finishPhotoRef = useRef(null);\n  const scanLoopRef = useRef(null);\n  const prevTaskCountRef = useRef(0);\n  const autoClockInRef = useRef(false);\n  const staffProfileRef = useRef(staffProfile);\n  const prevGoldPointsRef = useRef(staffProfile.goldPoints || 0);\n\n  useEffect(() => {\n    staffProfileRef.current = staffProfile;\n  }, [staffProfile]);\n\n  useEffect(() => {\n    const allowed = languages.map((lang) => lang.code);\n    if (!allowed.includes(fieldLanguage)) {\n      setFieldLanguage(allowed[0]);\n    }\n  }, [fieldLanguage, languages, setFieldLanguage]);\n\n  useEffect(() => {\n    const syncWorkerLanguage = async () => {\n      try {\n        await setWorkerLanguage(fieldLanguage);\n      } catch (error) {\n        console.error('Failed to sync worker language:', error);\n      }\n    };\n    syncWorkerLanguage();\n  }, [fieldLanguage]);\n\n  useEffect(() => {\n    const stopCamera = () => {\n      if (scanLoopRef.current) {\n        cancelAnimationFrame(scanLoopRef.current);\n      }\n      const stream = videoRef.current?.srcObject;\n      if (stream) {\n        stream.getTracks().forEach((track) => track.stop());\n        if (videoRef.current) videoRef.current.srcObject = null;\n      }\n    };\n    if (!cameraOn) {\n      stopCamera();\n      return;\n    }\n    const start = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });\n        if (!videoRef.current) return;\n        videoRef.current.srcObject = stream;\n        await videoRef.current.play();\n        if ('BarcodeDetector' in window) {\n          const detector = new window.BarcodeDetector({ formats: ['qr_code'] });\n          const scan = async () => {\n            if (!videoRef.current) return;\n            try {\n              const barcodes = await detector.detect(videoRef.current);\n              if (barcodes && barcodes.length > 0) {\n                const value = barcodes[0].rawValue || '';\n                if (value) {\n                  setStaffIdInput(value);\n                  setToast(t('field.toast.qrScanned'));\n                  setTimeout(() => setToast(''), 1500);\n                  if (autoClockInOnScan && !autoClockInRef.current) {\n                    autoClockInRef.current = true;\n                    handleClockIn(value);\n                  }\n                  setCameraOn(false);\n                  return;\n                }\n              }\n            } catch (error) {\n              // ignore scan errors\n            }\n            scanLoopRef.current = requestAnimationFrame(scan);\n          };\n          scanLoopRef.current = requestAnimationFrame(scan);\n        }\n      } catch (error) {\n        setToast(t('field.toast.cameraUnavailable'));\n        setTimeout(() => setToast(''), 2000);\n        setCameraOn(false);\n      }\n    };\n    start();\n    return stopCamera;\n  }, [cameraOn]);\n\n  useEffect(() => {\n    const loadTasks = async () => {\n      if (!staffProfile.staffId) return;\n      setLoadingTasks(true);\n      try {\n        const data = await getStaffTasks(staffProfile.staffId);\n        setTasks(data);\n      } catch (error) {\n        console.error('Failed to load tasks:', error);\n      } finally {\n        setLoadingTasks(false);\n      }\n    };\n    loadTasks();\n  }, [staffProfile.staffId]);\n\n  useEffect(() => {\n    if (!staffProfile.staffId || clockInOnly) return;\n    const interval = setInterval(async () => {\n      try {\n        const data = await getStaffTasks(staffProfile.staffId);\n        setTasks(data);\n      } catch (error) {\n        // ignore polling errors\n      }\n    }, 5000);\n    return () => clearInterval(interval);\n  }, [staffProfile.staffId, clockInOnly]);\n\n  useEffect(() => {\n    const count = tasks.length;\n    if (count > prevTaskCountRef.current) {\n      if (navigator.vibrate) {\n        navigator.vibrate([200, 100, 200]);\n      }\n      try {\n        const ctx = new (window.AudioContext || window.webkitAudioContext)();\n        const osc = ctx.createOscillator();\n        const gain = ctx.createGain();\n        osc.type = 'sine';\n        osc.frequency.value = 880;\n        gain.gain.value = 0.05;\n        osc.connect(gain);\n        gain.connect(ctx.destination);\n        osc.start();\n        setTimeout(() => {\n          osc.stop();\n          ctx.close();\n        }, 150);\n      } catch (error) {\n        // audio not available\n      }\n      setToast(t('field.toast.newTask'));\n      setTimeout(() => setToast(''), 1500);\n    }\n    prevTaskCountRef.current = count;\n  }, [tasks]);\n\n  useEffect(() => {\n    if (!staffProfile.staffId) return;\n    const source = subscribeToStaff((update) => {\n      const current = staffProfileRef.current;\n      if (update?.id !== current.staffId) return;\n      setStaffProfile({\n        ...current,\n        goldPoints: update.gold_points ?? current.goldPoints,\n        rank: update.rank ?? current.rank,\n        rankTier: update.rank_tier ?? current.rankTier,\n      });\n    });\n    return () => {\n      if (source && source.close) source.close();\n    };\n  }, [staffProfile.staffId, setStaffProfile]);\n\n  const handleClockIn = async (overrideStaffId) => {\n    const staffIdValue = overrideStaffId || staffIdInput;\n    if (!staffIdValue) return;\n    try {\n      const payload = {\n        staff_id: staffIdValue,\n        name: staffNameInput,\n        phone: staffPhoneInput,\n      };\n      if (!staffProfile.language) {\n        payload.language = fieldLanguage;\n      }\n      const result = await clockInStaff(payload);\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(\n          (position) => {\n            updateStaffLocation(\n              result.id,\n              position.coords.latitude,\n              position.coords.longitude\n            ).catch(() => {});\n          },\n          () => {}\n        );\n      }\n      setStaffProfile({\n        staffId: result.id,\n        name: result.name,\n        phone: result.phone,\n        goldPoints: result.gold_points ?? result.points ?? 0,\n        rank: result.rank ?? null,\n        rankTier: result.rank_tier || staffProfile.rankTier || 'starter',\n        language: result.language || staffProfile.language || fieldLanguage,\n      });\n      if (result.language) {\n        setFieldLanguage(result.language);\n      }\n      if (!clockInOnly) {\n        const data = await getStaffTasks(result.id);\n        setTasks(data);\n      }\n      setToast(t('field.toast.clockedIn'));\n      setTimeout(() => setToast(''), 1500);\n      autoClockInRef.current = false;\n    } catch (error) {\n      console.error('Clock-in failed:', error);\n      autoClockInRef.current = false;\n    }\n  };\n\n  const handleTaskUpdate = async (taskId, status) => {\n    const task = tasks.find((item) => item.id === taskId);\n    const actionKey = `${taskId}-${status}`;\n    setTaskActionLoading((prev) => ({ ...prev, [actionKey]: true }));\n    try {\n      const result = await updateStaffTaskStatus(taskId, status);\n      const data = await getStaffTasks(staffProfile.staffId);\n      setTasks(data);\n      if (result?.gold_points !== undefined || result?.rank !== undefined || result?.rank_tier) {\n        setStaffProfile({\n          ...staffProfile,\n          goldPoints: result.gold_points ?? staffProfile.goldPoints,\n          rank: result.rank ?? staffProfile.rank,\n          rankTier: result.rank_tier ?? staffProfile.rankTier,\n        });\n      }\n      if (status === 'finished' && result?.points_awarded !== undefined) {\n        const pointsMessage = t('field.toast.goldPoints', { count: result.points_awarded });\n        setPointsToast(pointsMessage);\n        setTimeout(() => setPointsToast(''), 1800);\n      }\n      if (task?.room) {\n        addNotification({\n          type: status === 'finished' ? 'success' : 'activity',\n          action: status,\n          room: task.room,\n          title: t('activity.title', { room: task.room }),\n        });\n      }\n      setToast(status === 'finished' ? t('field.toast.roomReady') : t('field.toast.taskUpdated'));\n      setTimeout(() => setToast(''), 1500);\n    } catch (error) {\n      console.error('Failed to update task:', error);\n    } finally {\n      setTaskActionLoading((prev) => ({ ...prev, [actionKey]: false }));\n    }\n  };\n\n  const handleFinishClick = (task) => {\n    if (taskActionLoading[`${task.id}-finished`]) return;\n    setTaskActionLoading((prev) => ({ ...prev, [`${task.id}-finished`]: true }));\n    setPendingFinishTask(task);\n    if (finishPhotoRef.current) {\n      finishPhotoRef.current.value = '';\n      finishPhotoRef.current.click();\n    }\n  };\n\n  const handleFinishPhotoSelected = (event) => {\n    const file = event.target.files?.[0];\n    if (!pendingFinishTask) return;\n    if (!file) {\n      setTaskActionLoading((prev) => ({ ...prev, [`${pendingFinishTask.id}-finished`]: false }));\n      setPendingFinishTask(null);\n      return;\n    }\n    handleTaskUpdate(pendingFinishTask.id, 'finished');\n    setPendingFinishTask(null);\n  };\n\n  const openIssueModal = (task) => {\n    setIssueTask(task);\n    setIssueNote('');\n    setIssuePhoto(null);\n    setShowIssueModal(true);\n  };\n\n  const handleIssueSubmit = async () => {\n    if (!issueTask || !issuePhoto) return;\n    setIssueSending(true);\n    try {\n      await reportIssue({\n        roomId: issueTask.room_id,\n        roomName: issueTask.room,\n        taskId: issueTask.id,\n        note: issueNote,\n        photo: issuePhoto,\n      });\n      if (issueTask?.room) {\n        addNotification({\n          type: 'damage',\n          action: 'damage_reported',\n          room: issueTask.room,\n          title: t('activity.damageReported', { room: issueTask.room }),\n          message: issueNote || '',\n        });\n      }\n      setToast(t('field.toast.issueReported'));\n      setTimeout(() => setToast(''), 1500);\n      setShowIssueModal(false);\n    } catch (error) {\n      console.error('Failed to report issue:', error);\n    } finally {\n      setIssueSending(false);\n    }\n  };\n\n  const goldPoints = staffProfile.goldPoints || 0;\n  const goldTier = goldPoints >= 100 ? 3 : goldPoints >= 50 ? 2 : goldPoints >= 10 ? 1 : 0;\n\n  useEffect(() => {\n    const prev = prevGoldPointsRef.current;\n    if (prev < 100 && goldPoints >= 100) {\n      const levelMessage = t('field.toast.levelUp');\n      setLevelToast(levelMessage);\n      setTimeout(() => setLevelToast(''), 2200);\n    }\n    prevGoldPointsRef.current = goldPoints;\n  }, [goldPoints, marketKey, staffProfile.rankTier]);\n\n  useEffect(() => {\n    if (!staffProfile.staffId || !navigator.geolocation) return () => {};\n    const updateLocation = () => {\n      navigator.geolocation.getCurrentPosition(\n        (position) => {\n          updateStaffLocation(\n            staffProfile.staffId,\n            position.coords.latitude,\n            position.coords.longitude\n          ).catch(() => {});\n        },\n        () => {}\n      );\n    };\n    updateLocation();\n    const interval = setInterval(updateLocation, 120000);\n    return () => clearInterval(interval);\n  }, [staffProfile.staffId]);\n\n  return (\n    <div className={`field-view gold-tier-${goldTier}`}>\n      <input\n        ref={finishPhotoRef}\n        type=\"file\"\n        accept=\"image/*\"\n        style={{ display: 'none' }}\n        onChange={handleFinishPhotoSelected}\n      />\n      <div className=\"field-header\">\n        <div className=\"field-title\">\n          <h2>{t('field.title')}</h2>\n          <span className=\"field-subtitle\">{t('field.subtitle')}</span>\n        </div>\n        {staffProfile.staffId && (\n          <div className=\"field-rank\">\n            <span className=\"field-rank-label\">{t('field.rank')}</span>\n            <span className=\"field-rank-value\">{staffProfile.rank ?? '-'}</span>\n            <span className=\"field-rank-points\">{t('field.points', { count: staffProfile.goldPoints ?? 0 })}</span>\n            <span className=\"field-rank-tier\">{t(`field.rankTier.${staffProfile.rankTier || 'starter'}`)}</span>\n          </div>\n        )}\n        <div className=\"field-lang-toggle\">\n          <Languages size={16} />\n          <div className=\"field-lang-options\">\n            {languages.map((lang) => (\n              <button\n                key={lang.code}\n                className={`field-lang-btn ${fieldLanguage === lang.code ? 'active' : ''}`}\n                onClick={() => setFieldLanguage(lang.code)}\n              >\n                {lang.label}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      <div className=\"field-task-list\">\n        <div className=\"field-clockin glass-card\">\n              <h3>{t('field.clockIn.title')}</h3>\n          <div className=\"clockin-form\">\n            <input\n              type=\"text\"\n                  placeholder={t('field.clockIn.scanPlaceholder')}\n              value={staffIdInput}\n              onChange={(e) => setStaffIdInput(e.target.value)}\n            />\n            <button className=\"btn-secondary\" onClick={() => setCameraOn((prev) => !prev)}>\n                  {cameraOn ? t('field.clockIn.stopCamera') : t('field.clockIn.scanQr')}\n            </button>\n            <input\n              type=\"text\"\n                  placeholder={t('field.clockIn.nameOptional')}\n              value={staffNameInput}\n              onChange={(e) => setStaffNameInput(e.target.value)}\n            />\n            <input\n              type=\"tel\"\n                  placeholder={t('field.clockIn.phoneOptional')}\n              value={staffPhoneInput}\n              onChange={(e) => setStaffPhoneInput(e.target.value)}\n            />\n            <button className=\"btn-primary\" onClick={handleClockIn}>\n                  {t('field.clockIn.button')}\n            </button>\n          </div>\n          {cameraOn && (\n            <div className=\"camera-preview\">\n              <video ref={videoRef} muted playsInline />\n            </div>\n          )}\n        </div>\n\n        {!clockInOnly && (\n          <>\n            {loadingTasks && <div className=\"field-loading\">{t('field.loadingTasks')}</div>}\n            {tasks.map((task) => {\n              const taskTypeKey = (task.task_type || '').toString().toLowerCase().replace(/\\s+/g, '_');\n              const Icon = TASK_ICONS[task.task_type] || TASK_ICONS[taskTypeKey] || CheckCircle2;\n              const isActiveTask = task.status !== 'finished' && Boolean(task.room_id);\n              const taskLabel = t(`field.taskTypes.${taskTypeKey}`, { defaultValue: task.task_type });\n              return (\n                <div key={task.id} className={`field-task-card ${task.status}`}>\n                  <div className=\"task-main\">\n                    <div className=\"task-icon\">\n                      <Icon size={18} />\n                    </div>\n                    <div className=\"task-info\">\n                      <span className=\"task-title\">{taskLabel}</span>\n                      <span className=\"task-meta\">{task.room}</span>\n                    </div>\n                    {isActiveTask && (\n                      <button\n                        className=\"task-issue-btn\"\n                        onClick={() => openIssueModal(task)}\n                        aria-label={t('field.reportIssue')}\n                      >\n                        <AlertTriangle size={14} />\n                        {t('field.reportIssue')}\n                      </button>\n                    )}\n                  </div>\n                  <div className=\"task-actions\">\n                    <button\n                      className=\"task-action-btn\"\n                      onClick={() => handleTaskUpdate(task.id, 'on_my_way')}\n                      disabled={task.status === 'finished' || taskActionLoading[`${task.id}-on_my_way`]}\n                    >\n                      {taskActionLoading[`${task.id}-on_my_way`] ? t('common.loading') : t('field.actions.onMyWay')}\n                    </button>\n                    <button\n                      className=\"task-action-btn\"\n                      onClick={() => handleTaskUpdate(task.id, 'started')}\n                      disabled={task.status === 'finished' || taskActionLoading[`${task.id}-started`]}\n                    >\n                      {taskActionLoading[`${task.id}-started`] ? t('common.loading') : t('field.actions.cleaning')}\n                    </button>\n                    <button\n                      className=\"task-action-btn primary\"\n                      onClick={() => handleFinishClick(task)}\n                      disabled={task.status === 'finished' || taskActionLoading[`${task.id}-finished`]}\n                    >\n                      {taskActionLoading[`${task.id}-finished`] ? t('common.loading') : t('field.actions.finishedWithPhoto')}\n                    </button>\n                  </div>\n                </div>\n              );\n            })}\n          </>\n        )}\n      </div>\n      {toast && <div className=\"field-toast\">{toast}</div>}\n      {pointsToast && <div className=\"field-toast points-toast\">{pointsToast}</div>}\n      {levelToast && <div className=\"field-toast level-toast\">{levelToast}</div>}\n      {showIssueModal && (\n        <div className=\"report-modal-backdrop is-open\" onClick={() => setShowIssueModal(false)}>\n          <div className=\"report-modal glass-card\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"report-header\">\n              <h2>{t('field.issueModal.title')}</h2>\n              <button onClick={() => setShowIssueModal(false)} className=\"close-btn\">Ã—</button>\n            </div>\n            <div className=\"report-content\">\n              <div className=\"issue-form\">\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={(e) => setIssuePhoto(e.target.files?.[0] || null)}\n                />\n                <textarea\n                  placeholder={t('field.issueModal.notePlaceholder')}\n                  value={issueNote}\n                  onChange={(e) => setIssueNote(e.target.value)}\n                />\n                <button className=\"btn-primary\" onClick={handleIssueSubmit} disabled={issueSending || !issuePhoto}>\n                  {issueSending ? t('field.issueModal.sending') : t('field.issueModal.submit')}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default FieldView;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}