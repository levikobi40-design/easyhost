{"ast":null,"code":"import i18n from '../i18n';\nimport { API_URL, getAPIUrl, apiRequest } from '../utils/apiClient';\nconst getBase = () => typeof window !== 'undefined' ? getAPIUrl() : API_URL;\nconsole.log('[Easy Host AI API] Using backend URL:', API_URL);\n\n// Debug helper - logs all API requests\nconst logRequest = (method, url, payload) => {\n  console.log(`[API] ${method} ${url}`);\n  if (payload) console.log('[API] Payload:', payload);\n};\nconst logResponse = (url, status, data) => {\n  console.log(`[API] Response from ${url}:`, status, data);\n};\nconst getAuthContext = () => {\n  try {\n    var _parsed$state, _parsed$state2;\n    const raw = localStorage.getItem('hotel-enterprise-storage');\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return {\n      token: parsed === null || parsed === void 0 ? void 0 : (_parsed$state = parsed.state) === null || _parsed$state === void 0 ? void 0 : _parsed$state.authToken,\n      tenantId: parsed === null || parsed === void 0 ? void 0 : (_parsed$state2 = parsed.state) === null || _parsed$state2 === void 0 ? void 0 : _parsed$state2.activeTenantId\n    };\n  } catch (error) {\n    return {};\n  }\n};\nconst getAuthHeaders = () => {\n  const {\n    token,\n    tenantId\n  } = getAuthContext();\n  const headers = {};\n  if (token) headers.Authorization = `Bearer ${token}`;\n  if (tenantId) headers['X-Tenant-Id'] = tenantId;\n  return headers;\n};\n\n/** GET /api/local-ip - machine's LAN IP for QR code (mobile access) */\nexport const getLocalAppUrl = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/local-ip`);\n    if (!response.ok) return null;\n    const data = await response.json();\n    return data.appUrl || `http://${data.ip || '127.0.0.1'}:3000`;\n  } catch {\n    return null;\n  }\n};\n\n/**\n * Health check - get server status\n * @returns {Promise<object>} { ok, status, openai_configured, sse_clients }\n */\nexport const getHealth = async () => {\n  const url = `${API_URL}/health`;\n  logRequest('GET', url);\n  try {\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      console.error(`[API] Health check failed: HTTP ${response.status}`);\n      throw new Error('Health check failed');\n    }\n    const data = await response.json();\n    logResponse(url, response.status, data);\n    return data;\n  } catch (error) {\n    console.error('[API] Error checking health:', error);\n    throw error;\n  }\n};\nexport const loginAuth = async (email, password) => {\n  const url = `${API_URL}/api/auth/login`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      email,\n      password\n    })\n  });\n  const data = await response.json().catch(() => ({}));\n  console.log('[loginAuth] Server response:', response.status, response.statusText, data);\n  if (!response.ok) {\n    throw new Error(data.error || `Login failed (${response.status})`);\n  }\n  return data;\n};\nexport const registerAuth = async (email, password) => {\n  const url = `${API_URL}/api/auth/register`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      email,\n      password\n    })\n  });\n  const data = await response.json().catch(() => ({}));\n  if (!response.ok) {\n    throw new Error(data.error || 'Registration failed');\n  }\n  return data;\n};\nexport const getDemoAuthToken = async tenantId => {\n  const url = `${API_URL}/api/auth/demo`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      tenant_id: tenantId\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to get demo token');\n  }\n  return await response.json();\n};\nexport const getPilotAccessToken = async tenantName => {\n  const url = `${API_URL}/api/auth/pilot`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      tenant_name: tenantName\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to get pilot token');\n  }\n  return await response.json();\n};\nexport const connectCalendar = async (icalUrl, nightlyRate) => {\n  const url = `${API_URL}/api/onboarding/ical`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      ical_url: icalUrl,\n      nightly_rate: nightlyRate\n    })\n  });\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(errorText || 'Failed to sync calendar');\n  }\n  return await response.json();\n};\nexport const getCalendarStatus = async () => {\n  const url = `${API_URL}/api/onboarding/status`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch calendar status');\n  }\n  return await response.json();\n};\nexport const refreshCalendar = async () => {\n  const url = `${API_URL}/api/onboarding/ical/refresh`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to refresh calendar');\n  }\n  return await response.json();\n};\nexport const createManualCheckout = async (checkoutDate, room) => {\n  const url = `${API_URL}/api/onboarding/manual-checkout`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      checkout_date: checkoutDate,\n      room\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to create manual checkout');\n  }\n  return await response.json();\n};\nexport const getManualRooms = async () => {\n  const url = `${API_URL}/api/rooms/manual`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch manual rooms');\n  }\n  return await response.json();\n};\n\n/** POST /api/ai/maya-command - send command to Gemini, get structured response + optional task. Pass tasksForAnalysis for management summary. */\nexport const sendMayaCommand = async (command, tasksForAnalysis = null) => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const payload = {\n    command\n  };\n  if (tasksForAnalysis && Array.isArray(tasksForAnalysis)) payload.tasksForAnalysis = tasksForAnalysis;\n  const response = await fetch(`${API_URL}/api/ai/maya-command`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(payload)\n  });\n  const data = await response.json().catch(() => ({}));\n  if (!response.ok) {\n    const errMsg = data.displayMessage || data.error || data.message || `Request failed (${response.status})`;\n    const err = new Error(errMsg);\n    err.data = data;\n    err.status = response.status;\n    throw err;\n  }\n  return data;\n};\n\n/** GET /api/ai/property-context - properties + staff for AI Assistant (Maya) */\nexport const getAIPropertyContext = async () => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/ai/property-context`, {\n    method: 'GET',\n    headers\n  });\n  if (!response.ok) return {\n    properties: [],\n    staff_by_property: {},\n    summary_for_ai: ''\n  };\n  return await response.json();\n};\n\n/** GET /api/property-tasks - list all Maya-created tasks */\nexport const getPropertyTasks = async () => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/property-tasks`, {\n    method: 'GET',\n    headers\n  });\n  if (!response.ok) return [];\n  try {\n    const data = await response.json();\n    return Array.isArray(data) ? data : [];\n  } catch {\n    return [];\n  }\n};\n\n/** POST /api/tasks - create task (AI or User). Links to property_id and staff. */\nexport const createTask = async payload => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/tasks`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(payload)\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to create task');\n  }\n  return await response.json();\n};\n\n/** POST /api/property-tasks - create task (Maya notification) */\nexport const createPropertyTask = async payload => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/property-tasks`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(payload)\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to create task');\n  }\n  return await response.json();\n};\n\n/** PATCH /api/property-tasks/<id> - update task status */\nexport const updatePropertyTaskStatus = async (taskId, status) => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/property-tasks/${taskId}`, {\n    method: 'PATCH',\n    headers,\n    body: JSON.stringify({\n      status\n    })\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to update task');\n  }\n  return await response.json();\n};\n\n/** Fetch all properties from GET /api/properties (manual_rooms table) */\nexport const getProperties = async () => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties`, {\n    method: 'GET',\n    headers\n  });\n  if (!response.ok) throw new Error('Failed to fetch properties');\n  return await response.json();\n};\n\n/** PUT /api/properties/<id> - update a property. Pass id exactly as in DB (UUID). */\nexport const updateProperty = async (id, payload = {}) => {\n  const idStr = id != null && id !== '' ? String(id).trim() : '';\n  if (!idStr) throw new Error('Property id required');\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${idStr}`, {\n    method: 'PUT',\n    headers,\n    body: JSON.stringify(payload)\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to update property');\n  }\n  return await response.json();\n};\n\n/** DELETE /api/properties/<id> - remove a property by UUID */\nexport const deleteProperty = async id => {\n  const idStr = id != null && id !== '' ? String(id).trim() : '';\n  if (!idStr) throw new Error('Property id required');\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${idStr}`, {\n    method: 'DELETE',\n    headers\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to delete property');\n  }\n  return await response.json();\n};\n\n/** GET /api/properties/<id>/staff - list employees for property */\nexport const getPropertyStaff = async propertyId => {\n  const idStr = propertyId != null ? String(propertyId).trim() : '';\n  if (!idStr) return [];\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${idStr}/staff`, {\n    method: 'GET',\n    headers\n  });\n  if (!response.ok) return [];\n  return await response.json();\n};\n\n/** POST /api/properties/<id>/staff - add employee (name, role, phone_number) linked to property_id */\nexport const addPropertyStaff = async (propertyId, {\n  name,\n  role = 'Staff',\n  phone_number\n} = {}) => {\n  const idStr = propertyId != null ? String(propertyId).trim() : '';\n  if (!idStr) throw new Error('Property id required');\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const body = {\n    name: (name || '').trim(),\n    role: (role || 'Staff').trim()\n  };\n  if (phone_number != null && String(phone_number).trim()) body.phone_number = String(phone_number).trim();\n  const response = await fetch(`${API_URL}/api/properties/${idStr}/staff`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(body)\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to add employee');\n  }\n  return await response.json();\n};\n\n/** PATCH /api/properties/<id>/staff/<staff_id> - update staff (name, role, phone_number) */\nexport const updatePropertyStaff = async (propertyId, staffId, {\n  name,\n  role,\n  phone_number\n} = {}) => {\n  const pid = propertyId != null ? String(propertyId).trim() : '';\n  const sid = staffId != null ? String(staffId).trim() : '';\n  if (!pid || !sid) throw new Error('Property and staff id required');\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const body = {};\n  if (name != null) body.name = String(name).trim();\n  if (role != null) body.role = String(role).trim();\n  if (phone_number != null) body.phone_number = String(phone_number).trim();\n  const response = await fetch(`${API_URL}/api/properties/${pid}/staff/${sid}`, {\n    method: 'PATCH',\n    headers,\n    body: JSON.stringify(body)\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to update staff');\n  }\n  return await response.json();\n};\n\n/** DELETE /api/properties/<id>/staff/<staff_id> - remove employee from property */\nexport const removePropertyStaff = async (propertyId, staffId) => {\n  const pid = propertyId != null ? String(propertyId).trim() : '';\n  const sid = staffId != null ? String(staffId).trim() : '';\n  if (!pid || !sid) throw new Error('Property and staff id required');\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${pid}/staff/${sid}`, {\n    method: 'DELETE',\n    headers\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to remove employee');\n  }\n  return await response.json();\n};\nexport const createManualRoom = async name => {\n  const url = `${API_URL}/api/rooms/manual`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      name\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to create manual room');\n  }\n  return await response.json();\n};\nexport const createManualRoomWithDescription = async (name, description, photoUrl) => {\n  const url = `${API_URL}/api/rooms/manual`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      name,\n      description,\n      photo_url: photoUrl\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to create manual room');\n  }\n  return await response.json();\n};\n\n/**\n * Create property - uses central apiClient (http://127.0.0.1:5000)\n * All fields have safe defaults to prevent undefined errors.\n */\nexport const createProperty = async (payload = {}) => {\n  var _payload$name, _payload$description, _payload$photo_url;\n  const propertyData = {\n    name: String((_payload$name = payload.name) !== null && _payload$name !== void 0 ? _payload$name : '').trim() || 'Unnamed Property',\n    description: String((_payload$description = payload.description) !== null && _payload$description !== void 0 ? _payload$description : ''),\n    price: Number(payload.price) || 0,\n    photo_url: String((_payload$photo_url = payload.photo_url) !== null && _payload$photo_url !== void 0 ? _payload$photo_url : ''),\n    images: payload.images || [],\n    amenities: payload.amenities || [],\n    max_guests: Math.max(1, parseInt(payload.max_guests, 10) || 2),\n    bedrooms: Math.max(1, parseInt(payload.bedrooms, 10) || 1),\n    beds: Math.max(1, parseInt(payload.beds, 10) || 1),\n    bathrooms: Math.max(1, parseInt(payload.bathrooms, 10) || 1)\n  };\n  console.log('[createProperty] Sending:', propertyData);\n  try {\n    let headers = {};\n    if (!getAuthHeaders().Authorization) {\n      try {\n        const auth = await getDemoAuthToken('default');\n        if (auth !== null && auth !== void 0 && auth.token) headers.Authorization = `Bearer ${auth.token}`;\n      } catch (e) {\n        console.warn('[createProperty] Demo auth failed:', e);\n      }\n    }\n    const result = await apiRequest('/api/properties', {\n      method: 'POST',\n      body: propertyData,\n      headers: {\n        ...getAuthHeaders(),\n        ...headers\n      }\n    });\n    return result;\n  } catch (error) {\n    var _error$status, _error$response, _error$data, _error$response2, _ref, _data$error;\n    const status = (_error$status = error === null || error === void 0 ? void 0 : error.status) !== null && _error$status !== void 0 ? _error$status : error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status;\n    const data = (_error$data = error === null || error === void 0 ? void 0 : error.data) !== null && _error$data !== void 0 ? _error$data : error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data;\n    const serverMsg = (_ref = (_data$error = data === null || data === void 0 ? void 0 : data.error) !== null && _data$error !== void 0 ? _data$error : data === null || data === void 0 ? void 0 : data.message) !== null && _ref !== void 0 ? _ref : typeof data === 'string' ? data : JSON.stringify(data || {});\n    const msg = `Create Property failed: ${(error === null || error === void 0 ? void 0 : error.message) || 'Unknown error'}` + (status ? ` [HTTP ${status}]` : '') + (serverMsg ? ` | Server: ${serverMsg}` : '');\n    console.error('[createProperty] Full error:', error);\n    window.alert(msg);\n    throw error;\n  }\n};\n\n/**\n * Generic image upload - accepts multiple files, returns array of URLs\n * @param {File|File[]} files - Single file or array of files\n * @returns {Promise<{urls: string[]}>}\n */\nexport const uploadImages = async files => {\n  const fileList = Array.isArray(files) ? files : [files];\n  const formData = new FormData();\n  fileList.forEach(f => formData.append('files', f));\n  const response = await fetch(`${API_URL}/api/upload`, {\n    method: 'POST',\n    headers: {\n      ...getAuthHeaders()\n      // FormData triggers browser to set Content-Type: multipart/form-data; boundary=...\n    },\n    body: formData\n  });\n  if (!response.ok) {\n    const err = await response.json().catch(() => ({}));\n    throw new Error(err.error || 'Failed to upload images');\n  }\n  return await response.json();\n};\nexport const uploadPropertyPhoto = async file => {\n  const formData = new FormData();\n  formData.append('photo', file);\n  const response = await fetch(`${API_URL}/api/rooms/manual/photo/upload`, {\n    method: 'POST',\n    headers: getAuthHeaders(),\n    body: formData\n  });\n  if (!response.ok) {\n    const err = await response.json().catch(() => ({}));\n    throw new Error(err.error || 'Failed to upload photo');\n  }\n  const data = await response.json();\n  return data.photo_url;\n};\nexport const checkoutManualRoom = async roomId => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/checkout`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to checkout room');\n  }\n  return await response.json();\n};\nexport const checkinManualRoom = async roomId => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/checkin`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to check-in room');\n  }\n  return await response.json();\n};\nexport const getManualRoomHistory = async roomId => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/history`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch room history');\n  }\n  return await response.json();\n};\nexport const assignManualRoom = async (roomId, staffId) => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/assign`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      staff_id: staffId\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to assign room');\n  }\n  return await response.json();\n};\nexport const resolveManualRoom = async roomId => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/resolve`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to resolve room');\n  }\n  return await response.json();\n};\nexport const reportIssue = async ({\n  roomId,\n  roomName,\n  taskId,\n  note,\n  photo\n}) => {\n  const url = `${API_URL}/api/issues/report`;\n  const formData = new FormData();\n  formData.append('room_id', roomId);\n  formData.append('room_name', roomName || '');\n  if (taskId) formData.append('task_id', taskId);\n  if (note) formData.append('note', note);\n  formData.append('photo', photo);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      ...getAuthHeaders()\n    },\n    body: formData\n  });\n  if (!response.ok) {\n    throw new Error('Failed to report issue');\n  }\n  return await response.json();\n};\nexport const searchProperties = async query => {\n  const url = `${API_URL}/api/properties/search?q=${encodeURIComponent(query)}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to search properties');\n  }\n  return await response.json();\n};\nexport const importManualRoomFromLink = async url => {\n  const endpoint = `${API_URL}/api/rooms/manual/import`;\n  const response = await fetch(endpoint, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      url\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to import room');\n  }\n  return await response.json();\n};\n\n/** Import Airbnb/Booking property - creates property + initial cleaning task */\nexport const importProperty = async url => {\n  const response = await fetch(`${API_URL}/api/v1/properties/import`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      url\n    })\n  });\n  if (!response.ok) {\n    const err = await response.json().catch(() => ({}));\n    throw new Error(err.error || 'Failed to import property');\n  }\n  return await response.json();\n};\nexport const setWorkerLanguage = async language => {\n  const url = `${API_URL}/api/worker/language`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      language\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to set worker language');\n  }\n  return await response.json();\n};\nexport const getMessages = async (limit = 50) => {\n  const url = `${API_URL}/api/messages?limit=${limit}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch messages');\n  }\n  return await response.json();\n};\nexport const clockInStaff = async payload => {\n  const url = `${API_URL}/api/staff/clock-in`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(payload)\n  });\n  if (!response.ok) {\n    throw new Error('Failed to clock in staff');\n  }\n  return await response.json();\n};\nexport const clockOutStaff = async staffId => {\n  const url = `${API_URL}/api/staff/clock-out`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      staff_id: staffId\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to clock out staff');\n  }\n  return await response.json();\n};\nexport const getStaffList = async () => {\n  const url = `${API_URL}/api/staff`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch staff');\n  }\n  return await response.json();\n};\nexport const toggleStaffActive = async (staffId, active) => {\n  const url = `${API_URL}/api/staff/${staffId}/active`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      active\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to toggle staff');\n  }\n  return await response.json();\n};\nexport const getLeaderboard = async () => {\n  const url = `${API_URL}/api/staff/leaderboard`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch leaderboard');\n  }\n  return await response.json();\n};\nexport const getTasks = async (staffId = null) => {\n  const url = staffId ? `${API_URL}/api/staff/tasks?staff_id=${encodeURIComponent(staffId)}` : `${API_URL}/api/staff/tasks`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch tasks');\n  }\n  return await response.json();\n};\nexport const getStaffTasks = getTasks;\nexport const updateStaffTaskStatus = async (taskId, status) => {\n  const url = `${API_URL}/api/staff/tasks/${taskId}/status`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      status\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update task');\n  }\n  return await response.json();\n};\nexport const endShiftStaff = async staffId => {\n  const url = `${API_URL}/api/staff/${staffId}/end-shift`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to end shift');\n  }\n  return await response.json();\n};\nexport const updateStaffPhoto = async (staffId, photoUrl) => {\n  const url = `${API_URL}/api/staff/${staffId}/photo`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      photo_url: photoUrl\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update staff photo');\n  }\n  return await response.json();\n};\nexport const uploadStaffPhoto = async (staffId, file) => {\n  const url = `${API_URL}/api/staff/${staffId}/photo/upload`;\n  const formData = new FormData();\n  formData.append('photo', file);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      ...getAuthHeaders()\n      // FormData sends as multipart/form-data (browser sets Content-Type with boundary)\n    },\n    body: formData\n  });\n  if (!response.ok) {\n    throw new Error('Failed to upload staff photo');\n  }\n  return await response.json();\n};\nexport const updateStaffLocation = async (staffId, lat, lng) => {\n  const url = `${API_URL}/api/staff/${staffId}/location`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      lat,\n      lng\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update staff location');\n  }\n  return await response.json();\n};\nexport const subscribeToStaff = (onUpdate, onError) => {\n  const {\n    token,\n    tenant_id\n  } = getAuthContext();\n  const qs = new URLSearchParams();\n  if (token) qs.set('token', token);\n  if (tenant_id) qs.set('tenant_id', tenant_id);\n  const url = `${API_URL}/api/stream/staff?${qs.toString()}`;\n  const source = new EventSource(url);\n  source.addEventListener('staff_update', event => {\n    try {\n      const data = JSON.parse(event.data);\n      onUpdate === null || onUpdate === void 0 ? void 0 : onUpdate(data);\n    } catch (error) {\n      // ignore parse errors\n    }\n  });\n  source.onerror = error => {\n    onError === null || onError === void 0 ? void 0 : onError(error);\n  };\n  return source;\n};\nexport const getDispatchStatus = async () => {\n  const url = `${API_URL}/api/dispatch/status`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch dispatch status');\n  }\n  return await response.json();\n};\nexport const setDispatchStatus = async (enabled, intervalSeconds) => {\n  const url = `${API_URL}/api/dispatch/status`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      enabled,\n      interval_seconds: intervalSeconds\n    })\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update dispatch status');\n  }\n  return await response.json();\n};\n\n/**\n * Send an AI action request\n * @param {string} type - Action type (e.g., 'checkout', 'towels', 'restaurant')\n * @param {string} room - Room identifier\n * @param {string} role - User role ('owner', 'staff', 'guest')\n * @param {string} lang - Language code\n * @returns {Promise<object>} Response with { success, intent, draft, auto_send, is_safe }\n */\nexport const sendAIAction = async (type, room, role, lang) => {\n  try {\n    const response = await fetch(`${API_URL}/ai_action`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        type,\n        room,\n        role,\n        lang\n      })\n    });\n    if (!response.ok) {\n      throw new Error('Failed to send AI action');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error sending AI action:', error);\n    throw error;\n  }\n};\n\n/**\n * Create a new booking\n * @param {object} bookingData - Booking data { room_name, customer_name }\n * @returns {Promise<object>}\n */\nexport const createBooking = async bookingData => {\n  const url = `${API_URL}/api/book`;\n  logRequest('POST', url, bookingData);\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(bookingData)\n    });\n    const responseText = await response.text();\n    console.log(`[API] createBooking response: status=${response.status}, body=${responseText}`);\n    if (!response.ok) {\n      throw new Error(`Failed to create booking: HTTP ${response.status}`);\n    }\n    return JSON.parse(responseText);\n  } catch (error) {\n    console.error('[API] Error creating booking:', error);\n    throw error;\n  }\n};\n\n/**\n * Get all bookings\n * @returns {Promise<Array>}\n */\nexport const getBookings = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/bookings`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch bookings');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching bookings:', error);\n    throw error;\n  }\n};\n\n/**\n * Get AI insights\n * Returns fallback message if OpenAI not configured on backend\n * @returns {Promise<object>} { insight, bookings_count }\n */\nexport const getAIInsights = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/ai-insights`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch AI insights');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching AI insights:', error);\n    // Return fallback insight on error\n    return {\n      insight: i18n.t('common.readyToHelp'),\n      bookings_count: 0\n    };\n  }\n};\n\n/**\n * Get latest booking info (for polling fallback)\n * @returns {Promise<object>} { latest_id, latest_room, latest_customer, latest_time, total_count }\n */\nexport const getLatestBooking = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/bookings/latest`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch latest booking');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching latest booking:', error);\n    throw error;\n  }\n};\n\n/**\n * Get dashboard summary (revenue, active tasks, upcoming)\n * @returns {Promise<object>}\n */\nexport const getDashboardSummary = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/v1/dashboard/summary`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) throw new Error('Failed to fetch dashboard summary');\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching dashboard summary:', error);\n    return {\n      revenue: '0₪',\n      active_tasks_count: 0,\n      upcoming: [],\n      status: 'Unavailable'\n    };\n  }\n};\n\n/**\n * Get stats summary (properties, tasks by status, staff workload, capacity, top staff)\n * @returns {Promise<{total_properties: number, tasks_by_status: object, staff_workload: object, total_capacity: number, top_staff: array}>}\n */\nexport const getStatsSummary = async () => {\n  let headers = {\n    'Content-Type': 'application/json',\n    ...getAuthHeaders()\n  };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth !== null && auth !== void 0 && auth.token) headers = {\n        ...headers,\n        Authorization: `Bearer ${auth.token}`\n      };\n    } catch (_) {}\n  }\n  try {\n    const response = await fetch(`${API_URL}/api/stats/summary`, {\n      method: 'GET',\n      headers\n    });\n    if (!response.ok) throw new Error('Failed to fetch stats summary');\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching stats summary:', error);\n    return {\n      total_properties: 0,\n      tasks_by_status: {\n        Pending: 0,\n        Done: 0\n      },\n      staff_workload: {},\n      total_capacity: 0,\n      top_staff: []\n    };\n  }\n};\n\n/**\n * Get financial summary (LTV, conversion rate, projected revenue)\n * @returns {Promise<{avg_ltv: string, conversion_rate: string, projected_revenue: string}>}\n */\nexport const getFinancialSummary = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/v1/financials/summary`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) throw new Error('Failed to fetch financial summary');\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching financial summary:', error);\n    return {\n      avg_ltv: '₪0',\n      conversion_rate: '0%',\n      projected_revenue: '₪0'\n    };\n  }\n};\n\n/**\n * Get daily ROI report\n * @returns {Promise<object>}\n */\nexport const getDailyReport = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/reports/daily`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch daily report');\n    }\n    const data = await response.json();\n    return data.report || data;\n  } catch (error) {\n    console.error('Error fetching daily report:', error);\n    return {\n      date: new Date().toISOString().split('T')[0],\n      roi_metrics: {\n        hours_saved: 0,\n        cleanings_triggered: 0,\n        leads_captured: 0\n      },\n      recommendations: [],\n      agent_performance: [],\n      savings: {\n        automation_rate: 0\n      }\n    };\n  }\n};\n\n/**\n * Get automation stats (messages sent, last scan, objection success)\n * @returns {Promise<object>}\n */\nexport const getAutomationStats = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/stats`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch automation stats');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching automation stats:', error);\n    return {\n      automation_stats: {\n        automated_messages: 0,\n        last_scan: null,\n        leads_total: 0\n      },\n      objection_success: {}\n    };\n  }\n};\n\n/**\n * Send welcome WhatsApp message for a lead\n * @param {string} leadId\n * @returns {Promise<object>}\n */\nexport const sendWelcomeMessage = async leadId => {\n  try {\n    const response = await fetch(`${API_URL}/api/whatsapp/welcome`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        lead_id: leadId\n      })\n    });\n    if (!response.ok) {\n      throw new Error('Failed to send welcome message');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error sending welcome message:', error);\n    throw error;\n  }\n};\n\n// ============== Leads API ==============\n\n/**\n * Create a new lead\n * @param {object} leadData - { name, email, phone, guests, checkin, checkout, source }\n * @returns {Promise<object>} { success, id, score }\n */\nexport const createLead = async leadData => {\n  const url = `${API_URL}/api/leads`;\n  logRequest('POST', url, leadData);\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      },\n      body: JSON.stringify(leadData)\n    });\n    const responseText = await response.text();\n    console.log(`[API] createLead response: status=${response.status}, body=${responseText}`);\n    if (!response.ok) {\n      throw new Error(`Failed to create lead: HTTP ${response.status}`);\n    }\n    return JSON.parse(responseText);\n  } catch (error) {\n    console.error('[API] Error creating lead:', error);\n    throw error;\n  }\n};\n\n/**\n * Get all leads\n * @param {string} status - Optional status filter ('new', 'contacted', 'qualified', 'booked', 'lost')\n * @returns {Promise<Array>}\n */\nexport const getLeads = async (status = null) => {\n  const url = status ? `${API_URL}/api/leads?status=${status}` : `${API_URL}/api/leads`;\n  logRequest('GET', url);\n  try {\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      console.error(`[API] getLeads failed: HTTP ${response.status}`);\n      throw new Error('Failed to fetch leads');\n    }\n    const data = await response.json();\n\n    // IMPORTANT: Ensure we always return an array\n    if (Array.isArray(data)) {\n      console.log(`[API] getLeads: received ${data.length} leads`);\n      return data;\n    } else if (data && typeof data === 'object') {\n      // If backend returns a single object, wrap it in an array\n      console.warn('[API] getLeads: received object instead of array, wrapping');\n      return [data];\n    } else {\n      console.warn('[API] getLeads: unexpected response format, returning empty array');\n      return [];\n    }\n  } catch (error) {\n    console.error('[API] Error fetching leads:', error);\n    // Return empty array on error instead of throwing\n    return [];\n  }\n};\n\n/**\n * Get a single lead by ID\n * @param {number} leadId - Lead ID\n * @returns {Promise<object>}\n */\nexport const getLead = async leadId => {\n  try {\n    const response = await fetch(`${API_URL}/api/leads/${leadId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch lead');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching lead:', error);\n    throw error;\n  }\n};\n\n/**\n * Get leads statistics\n * @returns {Promise<object>} { total, new, contacted, qualified, won, lost, avg_score }\n */\nexport const getLeadsStats = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/leads/stats`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      }\n    });\n    if (!response.ok) {\n      throw new Error('Failed to fetch leads stats');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching leads stats:', error);\n    // Return default stats on error\n    return {\n      total: 0,\n      new: 0,\n      contacted: 0,\n      qualified: 0,\n      won: 0,\n      lost: 0,\n      avg_score: 0\n    };\n  }\n};\n\n/**\n * Update lead status, score, or notes\n * @param {number} leadId - Lead ID\n * @param {object} data - { status, score, notes }\n * @returns {Promise<object>}\n */\nexport const updateLead = async (leadId, data) => {\n  try {\n    const response = await fetch(`${API_URL}/api/leads/${leadId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders()\n      },\n      body: JSON.stringify(data)\n    });\n    if (!response.ok) {\n      throw new Error('Failed to update lead');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error updating lead:', error);\n    throw error;\n  }\n};\n\n/**\n * Update room status or details\n * @param {number} roomId\n * @param {object} data\n * @returns {Promise<object>}\n */\nexport const updateRoomStatus = async (roomId, data) => {\n  try {\n    const response = await fetch(`${API_URL}/api/rooms/${roomId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    });\n    if (!response.ok) {\n      throw new Error('Failed to update room');\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('Error updating room:', error);\n    throw error;\n  }\n};\n\n/**\n * Subscribe to leads SSE stream\n * @param {function} onNewLead - Callback for new lead events\n * @param {function} onLeadUpdated - Callback for lead updated events\n * @param {function} onError - Callback for errors\n * @returns {EventSource} - The event source (call .close() to disconnect)\n */\nexport const subscribeToLeads = (onNewLead, onLeadUpdated, onError, onAutomationStats) => {\n  const {\n    token,\n    tenantId\n  } = getAuthContext();\n  const query = new URLSearchParams();\n  if (token) query.set('token', token);\n  if (tenantId) query.set('tenant_id', tenantId);\n  const url = `${API_URL}/api/stream/leads?${query.toString()}`;\n  const eventSource = new EventSource(url);\n  eventSource.addEventListener('new_lead', event => {\n    try {\n      const lead = JSON.parse(event.data);\n      onNewLead(lead);\n    } catch (e) {\n      console.error('Error parsing lead event:', e);\n    }\n  });\n  eventSource.addEventListener('lead_updated', event => {\n    try {\n      const lead = JSON.parse(event.data);\n      if (onLeadUpdated) onLeadUpdated(lead);\n    } catch (e) {\n      console.error('Error parsing lead_updated event:', e);\n    }\n  });\n  eventSource.addEventListener('automation_stats', event => {\n    try {\n      const stats = JSON.parse(event.data);\n      if (onAutomationStats) onAutomationStats(stats);\n    } catch (e) {\n      console.error('Error parsing automation_stats event:', e);\n    }\n  });\n  eventSource.addEventListener('connected', event => {\n    console.log('Connected to leads stream:', event.data);\n  });\n  eventSource.onerror = error => {\n    console.error('Leads SSE error:', error);\n    if (onError) onError(error);\n  };\n  return eventSource;\n};\n\n// ============== AI Marketing Agent API ==============\n\n/**\n * Get AI Agent profile and capabilities\n */\nexport const getAgentProfile = async () => {\n  const url = `${API_URL}/api/agent/profile`;\n  logRequest('GET', url);\n  try {\n    const response = await fetch(url);\n    if (!response.ok) throw new Error('Failed to fetch agent profile');\n    return await response.json();\n  } catch (error) {\n    console.error('[API] Error fetching agent profile:', error);\n    return {\n      success: true,\n      agent: {\n        name: \"Maya\",\n        title: \"AI Marketing & Sales Agent\",\n        avatar: \"https://api.dicebear.com/7.x/personas/svg?seed=Maya&backgroundColor=667eea\"\n      },\n      capabilities: [\"Marketing\", \"Lead Generation\", \"Sales\"]\n    };\n  }\n};\n\n/**\n * Generate a marketing post\n */\nexport const generateMarketingPost = async params => {\n  const url = `${API_URL}/api/agent/generate-post`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to generate post');\n  return await response.json();\n};\n\n/**\n * Search for property owner leads\n */\nexport const searchPropertyLeads = async params => {\n  const url = `${API_URL}/api/agent/search-leads`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to search leads');\n  return await response.json();\n};\n\n/**\n * Draft outreach email to property owner\n */\nexport const draftOutreachEmail = async params => {\n  const url = `${API_URL}/api/agent/draft-email`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to draft email');\n  return await response.json();\n};\n\n/**\n * Generate client acquisition strategy\n */\nexport const generateAcquisitionStrategy = async params => {\n  const url = `${API_URL}/api/agent/acquisition-strategy`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to generate strategy');\n  return await response.json();\n};\n\n/**\n * Simulate publishing a post\n */\nexport const publishPost = async params => {\n  const url = `${API_URL}/api/agent/publish`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to publish');\n  return await response.json();\n};\n\n/**\n * Simulate sending an email\n */\nexport const sendOutreachEmail = async params => {\n  const url = `${API_URL}/api/agent/send-email`;\n  logRequest('POST', url, params);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to send email');\n  return await response.json();\n};\nconst api = {\n  getHealth,\n  getDemoAuthToken,\n  getPilotAccessToken,\n  connectCalendar,\n  getCalendarStatus,\n  createManualCheckout,\n  getManualRooms,\n  getProperties,\n  updateProperty,\n  deleteProperty,\n  getPropertyStaff,\n  addPropertyStaff,\n  updatePropertyStaff,\n  removePropertyStaff,\n  getPropertyTasks,\n  createTask,\n  createPropertyTask,\n  updatePropertyTaskStatus,\n  createManualRoom,\n  createManualRoomWithDescription,\n  createProperty,\n  checkoutManualRoom,\n  checkinManualRoom,\n  getManualRoomHistory,\n  assignManualRoom,\n  searchProperties,\n  resolveManualRoom,\n  reportIssue,\n  importManualRoomFromLink,\n  importProperty,\n  setWorkerLanguage,\n  getMessages,\n  clockInStaff,\n  clockOutStaff,\n  getStaffList,\n  toggleStaffActive,\n  getLeaderboard,\n  getStaffTasks,\n  updateStaffTaskStatus,\n  endShiftStaff,\n  updateStaffPhoto,\n  uploadStaffPhoto,\n  updateStaffLocation,\n  subscribeToStaff,\n  getDispatchStatus,\n  setDispatchStatus,\n  sendAIAction,\n  createBooking,\n  getBookings,\n  getAIInsights,\n  getLatestBooking,\n  getDailyReport,\n  getAutomationStats,\n  createLead,\n  getLeads,\n  getLead,\n  getLeadsStats,\n  updateLead,\n  updateRoomStatus,\n  subscribeToLeads,\n  getAgentProfile,\n  generateMarketingPost,\n  searchPropertyLeads,\n  draftOutreachEmail,\n  generateAcquisitionStrategy,\n  publishPost,\n  sendOutreachEmail\n};\nexport default api;","map":{"version":3,"names":["i18n","API_URL","getAPIUrl","apiRequest","getBase","window","console","log","logRequest","method","url","payload","logResponse","status","data","getAuthContext","_parsed$state","_parsed$state2","raw","localStorage","getItem","parsed","JSON","parse","token","state","authToken","tenantId","activeTenantId","error","getAuthHeaders","headers","Authorization","getLocalAppUrl","response","fetch","ok","json","appUrl","ip","getHealth","Error","loginAuth","email","password","body","stringify","catch","statusText","registerAuth","getDemoAuthToken","tenant_id","getPilotAccessToken","tenantName","tenant_name","connectCalendar","icalUrl","nightlyRate","ical_url","nightly_rate","errorText","text","getCalendarStatus","refreshCalendar","createManualCheckout","checkoutDate","room","checkout_date","getManualRooms","sendMayaCommand","command","tasksForAnalysis","auth","_","Array","isArray","errMsg","displayMessage","message","err","getAIPropertyContext","properties","staff_by_property","summary_for_ai","getPropertyTasks","createTask","createPropertyTask","updatePropertyTaskStatus","taskId","getProperties","updateProperty","id","idStr","String","trim","deleteProperty","getPropertyStaff","propertyId","addPropertyStaff","name","role","phone_number","updatePropertyStaff","staffId","pid","sid","removePropertyStaff","createManualRoom","createManualRoomWithDescription","description","photoUrl","photo_url","createProperty","_payload$name","_payload$description","_payload$photo_url","propertyData","price","Number","images","amenities","max_guests","Math","max","parseInt","bedrooms","beds","bathrooms","e","warn","result","_error$status","_error$response","_error$data","_error$response2","_ref","_data$error","serverMsg","msg","alert","uploadImages","files","fileList","formData","FormData","forEach","f","append","uploadPropertyPhoto","file","checkoutManualRoom","roomId","checkinManualRoom","getManualRoomHistory","assignManualRoom","staff_id","resolveManualRoom","reportIssue","roomName","note","photo","searchProperties","query","encodeURIComponent","importManualRoomFromLink","endpoint","importProperty","setWorkerLanguage","language","getMessages","limit","clockInStaff","clockOutStaff","getStaffList","toggleStaffActive","active","getLeaderboard","getTasks","getStaffTasks","updateStaffTaskStatus","endShiftStaff","updateStaffPhoto","uploadStaffPhoto","updateStaffLocation","lat","lng","subscribeToStaff","onUpdate","onError","qs","URLSearchParams","set","toString","source","EventSource","addEventListener","event","onerror","getDispatchStatus","setDispatchStatus","enabled","intervalSeconds","interval_seconds","sendAIAction","type","lang","createBooking","bookingData","responseText","getBookings","getAIInsights","insight","t","bookings_count","getLatestBooking","getDashboardSummary","revenue","active_tasks_count","upcoming","getStatsSummary","total_properties","tasks_by_status","Pending","Done","staff_workload","total_capacity","top_staff","getFinancialSummary","avg_ltv","conversion_rate","projected_revenue","getDailyReport","report","date","Date","toISOString","split","roi_metrics","hours_saved","cleanings_triggered","leads_captured","recommendations","agent_performance","savings","automation_rate","getAutomationStats","automation_stats","automated_messages","last_scan","leads_total","objection_success","sendWelcomeMessage","leadId","lead_id","createLead","leadData","getLeads","length","getLead","getLeadsStats","total","new","contacted","qualified","won","lost","avg_score","updateLead","updateRoomStatus","subscribeToLeads","onNewLead","onLeadUpdated","onAutomationStats","eventSource","lead","stats","getAgentProfile","success","agent","title","avatar","capabilities","generateMarketingPost","params","searchPropertyLeads","draftOutreachEmail","generateAcquisitionStrategy","publishPost","sendOutreachEmail","api"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/services/api.js"],"sourcesContent":["import i18n from '../i18n';\nimport { API_URL, getAPIUrl, apiRequest } from '../utils/apiClient';\n\nconst getBase = () => (typeof window !== 'undefined' ? getAPIUrl() : API_URL);\n\nconsole.log('[Easy Host AI API] Using backend URL:', API_URL);\n\n// Debug helper - logs all API requests\nconst logRequest = (method, url, payload) => {\n  console.log(`[API] ${method} ${url}`);\n  if (payload) console.log('[API] Payload:', payload);\n};\n\nconst logResponse = (url, status, data) => {\n  console.log(`[API] Response from ${url}:`, status, data);\n};\n\nconst getAuthContext = () => {\n  try {\n    const raw = localStorage.getItem('hotel-enterprise-storage');\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return {\n      token: parsed?.state?.authToken,\n      tenantId: parsed?.state?.activeTenantId,\n    };\n  } catch (error) {\n    return {};\n  }\n};\n\nconst getAuthHeaders = () => {\n  const { token, tenantId } = getAuthContext();\n  const headers = {};\n  if (token) headers.Authorization = `Bearer ${token}`;\n  if (tenantId) headers['X-Tenant-Id'] = tenantId;\n  return headers;\n};\n\n/** GET /api/local-ip - machine's LAN IP for QR code (mobile access) */\nexport const getLocalAppUrl = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/local-ip`);\n    if (!response.ok) return null;\n    const data = await response.json();\n    return data.appUrl || `http://${data.ip || '127.0.0.1'}:3000`;\n  } catch {\n    return null;\n  }\n};\n\n/**\n * Health check - get server status\n * @returns {Promise<object>} { ok, status, openai_configured, sse_clients }\n */\nexport const getHealth = async () => {\n  const url = `${API_URL}/health`;\n  logRequest('GET', url);\n\n  try {\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n    });\n\n    if (!response.ok) {\n      console.error(`[API] Health check failed: HTTP ${response.status}`);\n      throw new Error('Health check failed');\n    }\n\n    const data = await response.json();\n    logResponse(url, response.status, data);\n    return data;\n  } catch (error) {\n    console.error('[API] Error checking health:', error);\n    throw error;\n  }\n};\n\nexport const loginAuth = async (email, password) => {\n  const url = `${API_URL}/api/auth/login`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ email, password }),\n  });\n  const data = await response.json().catch(() => ({}));\n  console.log('[loginAuth] Server response:', response.status, response.statusText, data);\n  if (!response.ok) {\n    throw new Error(data.error || `Login failed (${response.status})`);\n  }\n  return data;\n};\n\nexport const registerAuth = async (email, password) => {\n  const url = `${API_URL}/api/auth/register`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ email, password }),\n  });\n  const data = await response.json().catch(() => ({}));\n  if (!response.ok) {\n    throw new Error(data.error || 'Registration failed');\n  }\n  return data;\n};\n\nexport const getDemoAuthToken = async (tenantId) => {\n  const url = `${API_URL}/api/auth/demo`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({ tenant_id: tenantId }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to get demo token');\n  }\n  return await response.json();\n};\n\nexport const getPilotAccessToken = async (tenantName) => {\n  const url = `${API_URL}/api/auth/pilot`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({ tenant_name: tenantName }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to get pilot token');\n  }\n  return await response.json();\n};\n\nexport const connectCalendar = async (icalUrl, nightlyRate) => {\n  const url = `${API_URL}/api/onboarding/ical`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ ical_url: icalUrl, nightly_rate: nightlyRate }),\n  });\n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(errorText || 'Failed to sync calendar');\n  }\n  return await response.json();\n};\n\nexport const getCalendarStatus = async () => {\n  const url = `${API_URL}/api/onboarding/status`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch calendar status');\n  }\n  return await response.json();\n};\n\nexport const refreshCalendar = async () => {\n  const url = `${API_URL}/api/onboarding/ical/refresh`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to refresh calendar');\n  }\n  return await response.json();\n};\n\nexport const createManualCheckout = async (checkoutDate, room) => {\n  const url = `${API_URL}/api/onboarding/manual-checkout`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ checkout_date: checkoutDate, room }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to create manual checkout');\n  }\n  return await response.json();\n};\n\nexport const getManualRooms = async () => {\n  const url = `${API_URL}/api/rooms/manual`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch manual rooms');\n  }\n  return await response.json();\n};\n\n/** POST /api/ai/maya-command - send command to Gemini, get structured response + optional task. Pass tasksForAnalysis for management summary. */\nexport const sendMayaCommand = async (command, tasksForAnalysis = null) => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const payload = { command };\n  if (tasksForAnalysis && Array.isArray(tasksForAnalysis)) payload.tasksForAnalysis = tasksForAnalysis;\n  const response = await fetch(`${API_URL}/api/ai/maya-command`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(payload),\n  });\n  const data = await response.json().catch(() => ({}));\n  if (!response.ok) {\n    const errMsg = data.displayMessage || data.error || data.message || `Request failed (${response.status})`;\n    const err = new Error(errMsg);\n    err.data = data;\n    err.status = response.status;\n    throw err;\n  }\n  return data;\n};\n\n/** GET /api/ai/property-context - properties + staff for AI Assistant (Maya) */\nexport const getAIPropertyContext = async () => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/ai/property-context`, { method: 'GET', headers });\n  if (!response.ok) return { properties: [], staff_by_property: {}, summary_for_ai: '' };\n  return await response.json();\n};\n\n/** GET /api/property-tasks - list all Maya-created tasks */\nexport const getPropertyTasks = async () => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/property-tasks`, { method: 'GET', headers });\n  if (!response.ok) return [];\n  try {\n    const data = await response.json();\n    return Array.isArray(data) ? data : [];\n  } catch {\n    return [];\n  }\n};\n\n/** POST /api/tasks - create task (AI or User). Links to property_id and staff. */\nexport const createTask = async (payload) => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/tasks`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(payload),\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to create task');\n  }\n  return await response.json();\n};\n\n/** POST /api/property-tasks - create task (Maya notification) */\nexport const createPropertyTask = async (payload) => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/property-tasks`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(payload),\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to create task');\n  }\n  return await response.json();\n};\n\n/** PATCH /api/property-tasks/<id> - update task status */\nexport const updatePropertyTaskStatus = async (taskId, status) => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/property-tasks/${taskId}`, {\n    method: 'PATCH',\n    headers,\n    body: JSON.stringify({ status }),\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to update task');\n  }\n  return await response.json();\n};\n\n/** Fetch all properties from GET /api/properties (manual_rooms table) */\nexport const getProperties = async () => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties`, { method: 'GET', headers });\n  if (!response.ok) throw new Error('Failed to fetch properties');\n  return await response.json();\n};\n\n/** PUT /api/properties/<id> - update a property. Pass id exactly as in DB (UUID). */\nexport const updateProperty = async (id, payload = {}) => {\n  const idStr = id != null && id !== '' ? String(id).trim() : '';\n  if (!idStr) throw new Error('Property id required');\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${idStr}`, {\n    method: 'PUT',\n    headers,\n    body: JSON.stringify(payload),\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to update property');\n  }\n  return await response.json();\n};\n\n/** DELETE /api/properties/<id> - remove a property by UUID */\nexport const deleteProperty = async (id) => {\n  const idStr = id != null && id !== '' ? String(id).trim() : '';\n  if (!idStr) throw new Error('Property id required');\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${idStr}`, { method: 'DELETE', headers });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to delete property');\n  }\n  return await response.json();\n};\n\n/** GET /api/properties/<id>/staff - list employees for property */\nexport const getPropertyStaff = async (propertyId) => {\n  const idStr = propertyId != null ? String(propertyId).trim() : '';\n  if (!idStr) return [];\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${idStr}/staff`, { method: 'GET', headers });\n  if (!response.ok) return [];\n  return await response.json();\n};\n\n/** POST /api/properties/<id>/staff - add employee (name, role, phone_number) linked to property_id */\nexport const addPropertyStaff = async (propertyId, { name, role = 'Staff', phone_number } = {}) => {\n  const idStr = propertyId != null ? String(propertyId).trim() : '';\n  if (!idStr) throw new Error('Property id required');\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const body = { name: (name || '').trim(), role: (role || 'Staff').trim() };\n  if (phone_number != null && String(phone_number).trim()) body.phone_number = String(phone_number).trim();\n  const response = await fetch(`${API_URL}/api/properties/${idStr}/staff`, {\n    method: 'POST',\n    headers,\n    body: JSON.stringify(body),\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to add employee');\n  }\n  return await response.json();\n};\n\n/** PATCH /api/properties/<id>/staff/<staff_id> - update staff (name, role, phone_number) */\nexport const updatePropertyStaff = async (propertyId, staffId, { name, role, phone_number } = {}) => {\n  const pid = propertyId != null ? String(propertyId).trim() : '';\n  const sid = staffId != null ? String(staffId).trim() : '';\n  if (!pid || !sid) throw new Error('Property and staff id required');\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const body = {};\n  if (name != null) body.name = String(name).trim();\n  if (role != null) body.role = String(role).trim();\n  if (phone_number != null) body.phone_number = String(phone_number).trim();\n  const response = await fetch(`${API_URL}/api/properties/${pid}/staff/${sid}`, {\n    method: 'PATCH',\n    headers,\n    body: JSON.stringify(body),\n  });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to update staff');\n  }\n  return await response.json();\n};\n\n/** DELETE /api/properties/<id>/staff/<staff_id> - remove employee from property */\nexport const removePropertyStaff = async (propertyId, staffId) => {\n  const pid = propertyId != null ? String(propertyId).trim() : '';\n  const sid = staffId != null ? String(staffId).trim() : '';\n  if (!pid || !sid) throw new Error('Property and staff id required');\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  const response = await fetch(`${API_URL}/api/properties/${pid}/staff/${sid}`, { method: 'DELETE', headers });\n  if (!response.ok) {\n    const data = await response.json().catch(() => ({}));\n    throw new Error(data.error || 'Failed to remove employee');\n  }\n  return await response.json();\n};\n\nexport const createManualRoom = async (name) => {\n  const url = `${API_URL}/api/rooms/manual`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ name }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to create manual room');\n  }\n  return await response.json();\n};\n\nexport const createManualRoomWithDescription = async (name, description, photoUrl) => {\n  const url = `${API_URL}/api/rooms/manual`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ name, description, photo_url: photoUrl }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to create manual room');\n  }\n  return await response.json();\n};\n\n/**\n * Create property - uses central apiClient (http://127.0.0.1:5000)\n * All fields have safe defaults to prevent undefined errors.\n */\nexport const createProperty = async (payload = {}) => {\n  const propertyData = {\n    name: String(payload.name ?? '').trim() || 'Unnamed Property',\n    description: String(payload.description ?? ''),\n    price: Number(payload.price) || 0,\n    photo_url: String(payload.photo_url ?? ''),\n    images: payload.images || [],\n    amenities: payload.amenities || [],\n    max_guests: Math.max(1, parseInt(payload.max_guests, 10) || 2),\n    bedrooms: Math.max(1, parseInt(payload.bedrooms, 10) || 1),\n    beds: Math.max(1, parseInt(payload.beds, 10) || 1),\n    bathrooms: Math.max(1, parseInt(payload.bathrooms, 10) || 1),\n  };\n  console.log('[createProperty] Sending:', propertyData);\n  try {\n    let headers = {};\n    if (!getAuthHeaders().Authorization) {\n      try {\n        const auth = await getDemoAuthToken('default');\n        if (auth?.token) headers.Authorization = `Bearer ${auth.token}`;\n      } catch (e) {\n        console.warn('[createProperty] Demo auth failed:', e);\n      }\n    }\n    const result = await apiRequest('/api/properties', {\n      method: 'POST',\n      body: propertyData,\n      headers: { ...getAuthHeaders(), ...headers },\n    });\n    return result;\n  } catch (error) {\n    const status = error?.status ?? error?.response?.status;\n    const data = error?.data ?? error?.response?.data;\n    const serverMsg = data?.error ?? data?.message ?? (typeof data === 'string' ? data : JSON.stringify(data || {}));\n    const msg = `Create Property failed: ${error?.message || 'Unknown error'}` +\n      (status ? ` [HTTP ${status}]` : '') +\n      (serverMsg ? ` | Server: ${serverMsg}` : '');\n    console.error('[createProperty] Full error:', error);\n    window.alert(msg);\n    throw error;\n  }\n};\n\n/**\n * Generic image upload - accepts multiple files, returns array of URLs\n * @param {File|File[]} files - Single file or array of files\n * @returns {Promise<{urls: string[]}>}\n */\nexport const uploadImages = async (files) => {\n  const fileList = Array.isArray(files) ? files : [files];\n  const formData = new FormData();\n  fileList.forEach((f) => formData.append('files', f));\n  const response = await fetch(`${API_URL}/api/upload`, {\n    method: 'POST',\n    headers: {\n      ...getAuthHeaders(),\n      // FormData triggers browser to set Content-Type: multipart/form-data; boundary=...\n    },\n    body: formData,\n  });\n  if (!response.ok) {\n    const err = await response.json().catch(() => ({}));\n    throw new Error(err.error || 'Failed to upload images');\n  }\n  return await response.json();\n};\n\nexport const uploadPropertyPhoto = async (file) => {\n  const formData = new FormData();\n  formData.append('photo', file);\n  const response = await fetch(`${API_URL}/api/rooms/manual/photo/upload`, {\n    method: 'POST',\n    headers: getAuthHeaders(),\n    body: formData,\n  });\n  if (!response.ok) {\n    const err = await response.json().catch(() => ({}));\n    throw new Error(err.error || 'Failed to upload photo');\n  }\n  const data = await response.json();\n  return data.photo_url;\n};\n\nexport const checkoutManualRoom = async (roomId) => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/checkout`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to checkout room');\n  }\n  return await response.json();\n};\n\nexport const checkinManualRoom = async (roomId) => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/checkin`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to check-in room');\n  }\n  return await response.json();\n};\n\nexport const getManualRoomHistory = async (roomId) => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/history`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch room history');\n  }\n  return await response.json();\n};\n\nexport const assignManualRoom = async (roomId, staffId) => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/assign`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ staff_id: staffId }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to assign room');\n  }\n  return await response.json();\n};\n\nexport const resolveManualRoom = async (roomId) => {\n  const url = `${API_URL}/api/rooms/manual/${roomId}/resolve`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to resolve room');\n  }\n  return await response.json();\n};\n\nexport const reportIssue = async ({ roomId, roomName, taskId, note, photo }) => {\n  const url = `${API_URL}/api/issues/report`;\n  const formData = new FormData();\n  formData.append('room_id', roomId);\n  formData.append('room_name', roomName || '');\n  if (taskId) formData.append('task_id', taskId);\n  if (note) formData.append('note', note);\n  formData.append('photo', photo);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      ...getAuthHeaders(),\n    },\n    body: formData,\n  });\n  if (!response.ok) {\n    throw new Error('Failed to report issue');\n  }\n  return await response.json();\n};\n\nexport const searchProperties = async (query) => {\n  const url = `${API_URL}/api/properties/search?q=${encodeURIComponent(query)}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to search properties');\n  }\n  return await response.json();\n};\n\nexport const importManualRoomFromLink = async (url) => {\n  const endpoint = `${API_URL}/api/rooms/manual/import`;\n  const response = await fetch(endpoint, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ url }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to import room');\n  }\n  return await response.json();\n};\n\n/** Import Airbnb/Booking property - creates property + initial cleaning task */\nexport const importProperty = async (url) => {\n  const response = await fetch(`${API_URL}/api/v1/properties/import`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ url }),\n  });\n  if (!response.ok) {\n    const err = await response.json().catch(() => ({}));\n    throw new Error(err.error || 'Failed to import property');\n  }\n  return await response.json();\n};\n\nexport const setWorkerLanguage = async (language) => {\n  const url = `${API_URL}/api/worker/language`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ language }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to set worker language');\n  }\n  return await response.json();\n};\n\nexport const getMessages = async (limit = 50) => {\n  const url = `${API_URL}/api/messages?limit=${limit}`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch messages');\n  }\n  return await response.json();\n};\n\nexport const clockInStaff = async (payload) => {\n  const url = `${API_URL}/api/staff/clock-in`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify(payload),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to clock in staff');\n  }\n  return await response.json();\n};\n\nexport const clockOutStaff = async (staffId) => {\n  const url = `${API_URL}/api/staff/clock-out`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ staff_id: staffId }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to clock out staff');\n  }\n  return await response.json();\n};\n\nexport const getStaffList = async () => {\n  const url = `${API_URL}/api/staff`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch staff');\n  }\n  return await response.json();\n};\n\nexport const toggleStaffActive = async (staffId, active) => {\n  const url = `${API_URL}/api/staff/${staffId}/active`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ active }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to toggle staff');\n  }\n  return await response.json();\n};\n\nexport const getLeaderboard = async () => {\n  const url = `${API_URL}/api/staff/leaderboard`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch leaderboard');\n  }\n  return await response.json();\n};\n\nexport const getTasks = async (staffId = null) => {\n  const url = staffId\n    ? `${API_URL}/api/staff/tasks?staff_id=${encodeURIComponent(staffId)}`\n    : `${API_URL}/api/staff/tasks`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch tasks');\n  }\n  return await response.json();\n};\n\nexport const getStaffTasks = getTasks;\n\nexport const updateStaffTaskStatus = async (taskId, status) => {\n  const url = `${API_URL}/api/staff/tasks/${taskId}/status`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ status }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update task');\n  }\n  return await response.json();\n};\n\nexport const endShiftStaff = async (staffId) => {\n  const url = `${API_URL}/api/staff/${staffId}/end-shift`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to end shift');\n  }\n  return await response.json();\n};\n\nexport const updateStaffPhoto = async (staffId, photoUrl) => {\n  const url = `${API_URL}/api/staff/${staffId}/photo`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ photo_url: photoUrl }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update staff photo');\n  }\n  return await response.json();\n};\n\nexport const uploadStaffPhoto = async (staffId, file) => {\n  const url = `${API_URL}/api/staff/${staffId}/photo/upload`;\n  const formData = new FormData();\n  formData.append('photo', file);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      ...getAuthHeaders(),\n      // FormData sends as multipart/form-data (browser sets Content-Type with boundary)\n    },\n    body: formData,\n  });\n  if (!response.ok) {\n    throw new Error('Failed to upload staff photo');\n  }\n  return await response.json();\n};\n\nexport const updateStaffLocation = async (staffId, lat, lng) => {\n  const url = `${API_URL}/api/staff/${staffId}/location`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ lat, lng }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update staff location');\n  }\n  return await response.json();\n};\n\nexport const subscribeToStaff = (onUpdate, onError) => {\n  const { token, tenant_id } = getAuthContext();\n  const qs = new URLSearchParams();\n  if (token) qs.set('token', token);\n  if (tenant_id) qs.set('tenant_id', tenant_id);\n  const url = `${API_URL}/api/stream/staff?${qs.toString()}`;\n  const source = new EventSource(url);\n  source.addEventListener('staff_update', (event) => {\n    try {\n      const data = JSON.parse(event.data);\n      onUpdate?.(data);\n    } catch (error) {\n      // ignore parse errors\n    }\n  });\n  source.onerror = (error) => {\n    onError?.(error);\n  };\n  return source;\n};\n\nexport const getDispatchStatus = async () => {\n  const url = `${API_URL}/api/dispatch/status`;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n  });\n  if (!response.ok) {\n    throw new Error('Failed to fetch dispatch status');\n  }\n  return await response.json();\n};\n\nexport const setDispatchStatus = async (enabled, intervalSeconds) => {\n  const url = `${API_URL}/api/dispatch/status`;\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders(),\n    },\n    body: JSON.stringify({ enabled, interval_seconds: intervalSeconds }),\n  });\n  if (!response.ok) {\n    throw new Error('Failed to update dispatch status');\n  }\n  return await response.json();\n};\n\n/**\n * Send an AI action request\n * @param {string} type - Action type (e.g., 'checkout', 'towels', 'restaurant')\n * @param {string} room - Room identifier\n * @param {string} role - User role ('owner', 'staff', 'guest')\n * @param {string} lang - Language code\n * @returns {Promise<object>} Response with { success, intent, draft, auto_send, is_safe }\n */\nexport const sendAIAction = async (type, room, role, lang) => {\n  try {\n    const response = await fetch(`${API_URL}/ai_action`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ type, room, role, lang }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to send AI action');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error sending AI action:', error);\n    throw error;\n  }\n};\n\n/**\n * Create a new booking\n * @param {object} bookingData - Booking data { room_name, customer_name }\n * @returns {Promise<object>}\n */\nexport const createBooking = async (bookingData) => {\n  const url = `${API_URL}/api/book`;\n  logRequest('POST', url, bookingData);\n\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(bookingData),\n    });\n\n    const responseText = await response.text();\n    console.log(`[API] createBooking response: status=${response.status}, body=${responseText}`);\n\n    if (!response.ok) {\n      throw new Error(`Failed to create booking: HTTP ${response.status}`);\n    }\n\n    return JSON.parse(responseText);\n  } catch (error) {\n    console.error('[API] Error creating booking:', error);\n    throw error;\n  }\n};\n\n/**\n * Get all bookings\n * @returns {Promise<Array>}\n */\nexport const getBookings = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/bookings`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch bookings');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching bookings:', error);\n    throw error;\n  }\n};\n\n/**\n * Get AI insights\n * Returns fallback message if OpenAI not configured on backend\n * @returns {Promise<object>} { insight, bookings_count }\n */\nexport const getAIInsights = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/ai-insights`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch AI insights');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching AI insights:', error);\n    // Return fallback insight on error\n    return {\n      insight: i18n.t('common.readyToHelp'),\n      bookings_count: 0\n    };\n  }\n};\n\n/**\n * Get latest booking info (for polling fallback)\n * @returns {Promise<object>} { latest_id, latest_room, latest_customer, latest_time, total_count }\n */\nexport const getLatestBooking = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/bookings/latest`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch latest booking');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching latest booking:', error);\n    throw error;\n  }\n};\n\n/**\n * Get dashboard summary (revenue, active tasks, upcoming)\n * @returns {Promise<object>}\n */\nexport const getDashboardSummary = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/v1/dashboard/summary`, {\n      method: 'GET',\n      headers: { 'Content-Type': 'application/json', ...getAuthHeaders() },\n    });\n    if (!response.ok) throw new Error('Failed to fetch dashboard summary');\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching dashboard summary:', error);\n    return { revenue: '0₪', active_tasks_count: 0, upcoming: [], status: 'Unavailable' };\n  }\n};\n\n/**\n * Get stats summary (properties, tasks by status, staff workload, capacity, top staff)\n * @returns {Promise<{total_properties: number, tasks_by_status: object, staff_workload: object, total_capacity: number, top_staff: array}>}\n */\nexport const getStatsSummary = async () => {\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\n  if (!headers.Authorization) {\n    try {\n      const auth = await getDemoAuthToken('default');\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\n    } catch (_) {}\n  }\n  try {\n    const response = await fetch(`${API_URL}/api/stats/summary`, { method: 'GET', headers });\n    if (!response.ok) throw new Error('Failed to fetch stats summary');\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching stats summary:', error);\n    return {\n      total_properties: 0,\n      tasks_by_status: { Pending: 0, Done: 0 },\n      staff_workload: {},\n      total_capacity: 0,\n      top_staff: [],\n    };\n  }\n};\n\n/**\n * Get financial summary (LTV, conversion rate, projected revenue)\n * @returns {Promise<{avg_ltv: string, conversion_rate: string, projected_revenue: string}>}\n */\nexport const getFinancialSummary = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/v1/financials/summary`, {\n      method: 'GET',\n      headers: { 'Content-Type': 'application/json', ...getAuthHeaders() },\n    });\n    if (!response.ok) throw new Error('Failed to fetch financial summary');\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching financial summary:', error);\n    return { avg_ltv: '₪0', conversion_rate: '0%', projected_revenue: '₪0' };\n  }\n};\n\n/**\n * Get daily ROI report\n * @returns {Promise<object>}\n */\nexport const getDailyReport = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/reports/daily`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch daily report');\n    }\n\n    const data = await response.json();\n    return data.report || data;\n  } catch (error) {\n    console.error('Error fetching daily report:', error);\n    return {\n      date: new Date().toISOString().split('T')[0],\n      roi_metrics: {\n        hours_saved: 0,\n        cleanings_triggered: 0,\n        leads_captured: 0\n      },\n      recommendations: [],\n      agent_performance: [],\n      savings: { automation_rate: 0 }\n    };\n  }\n};\n\n/**\n * Get automation stats (messages sent, last scan, objection success)\n * @returns {Promise<object>}\n */\nexport const getAutomationStats = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/stats`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch automation stats');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching automation stats:', error);\n    return {\n      automation_stats: { automated_messages: 0, last_scan: null, leads_total: 0 },\n      objection_success: {},\n    };\n  }\n};\n\n/**\n * Send welcome WhatsApp message for a lead\n * @param {string} leadId\n * @returns {Promise<object>}\n */\nexport const sendWelcomeMessage = async (leadId) => {\n  try {\n    const response = await fetch(`${API_URL}/api/whatsapp/welcome`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ lead_id: leadId }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to send welcome message');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error sending welcome message:', error);\n    throw error;\n  }\n};\n\n// ============== Leads API ==============\n\n/**\n * Create a new lead\n * @param {object} leadData - { name, email, phone, guests, checkin, checkout, source }\n * @returns {Promise<object>} { success, id, score }\n */\nexport const createLead = async (leadData) => {\n  const url = `${API_URL}/api/leads`;\n  logRequest('POST', url, leadData);\n\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n      body: JSON.stringify(leadData),\n    });\n\n    const responseText = await response.text();\n    console.log(`[API] createLead response: status=${response.status}, body=${responseText}`);\n\n    if (!response.ok) {\n      throw new Error(`Failed to create lead: HTTP ${response.status}`);\n    }\n\n    return JSON.parse(responseText);\n  } catch (error) {\n    console.error('[API] Error creating lead:', error);\n    throw error;\n  }\n};\n\n/**\n * Get all leads\n * @param {string} status - Optional status filter ('new', 'contacted', 'qualified', 'booked', 'lost')\n * @returns {Promise<Array>}\n */\nexport const getLeads = async (status = null) => {\n  const url = status\n    ? `${API_URL}/api/leads?status=${status}`\n    : `${API_URL}/api/leads`;\n  logRequest('GET', url);\n\n  try {\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      console.error(`[API] getLeads failed: HTTP ${response.status}`);\n      throw new Error('Failed to fetch leads');\n    }\n\n    const data = await response.json();\n\n    // IMPORTANT: Ensure we always return an array\n    if (Array.isArray(data)) {\n      console.log(`[API] getLeads: received ${data.length} leads`);\n      return data;\n    } else if (data && typeof data === 'object') {\n      // If backend returns a single object, wrap it in an array\n      console.warn('[API] getLeads: received object instead of array, wrapping');\n      return [data];\n    } else {\n      console.warn('[API] getLeads: unexpected response format, returning empty array');\n      return [];\n    }\n  } catch (error) {\n    console.error('[API] Error fetching leads:', error);\n    // Return empty array on error instead of throwing\n    return [];\n  }\n};\n\n/**\n * Get a single lead by ID\n * @param {number} leadId - Lead ID\n * @returns {Promise<object>}\n */\nexport const getLead = async (leadId) => {\n  try {\n    const response = await fetch(`${API_URL}/api/leads/${leadId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch lead');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching lead:', error);\n    throw error;\n  }\n};\n\n/**\n * Get leads statistics\n * @returns {Promise<object>} { total, new, contacted, qualified, won, lost, avg_score }\n */\nexport const getLeadsStats = async () => {\n  try {\n    const response = await fetch(`${API_URL}/api/leads/stats`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch leads stats');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error fetching leads stats:', error);\n    // Return default stats on error\n    return {\n      total: 0,\n      new: 0,\n      contacted: 0,\n      qualified: 0,\n      won: 0,\n      lost: 0,\n      avg_score: 0\n    };\n  }\n};\n\n/**\n * Update lead status, score, or notes\n * @param {number} leadId - Lead ID\n * @param {object} data - { status, score, notes }\n * @returns {Promise<object>}\n */\nexport const updateLead = async (leadId, data) => {\n  try {\n    const response = await fetch(`${API_URL}/api/leads/${leadId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to update lead');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error updating lead:', error);\n    throw error;\n  }\n};\n\n/**\n * Update room status or details\n * @param {number} roomId\n * @param {object} data\n * @returns {Promise<object>}\n */\nexport const updateRoomStatus = async (roomId, data) => {\n  try {\n    const response = await fetch(`${API_URL}/api/rooms/${roomId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to update room');\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Error updating room:', error);\n    throw error;\n  }\n};\n\n/**\n * Subscribe to leads SSE stream\n * @param {function} onNewLead - Callback for new lead events\n * @param {function} onLeadUpdated - Callback for lead updated events\n * @param {function} onError - Callback for errors\n * @returns {EventSource} - The event source (call .close() to disconnect)\n */\nexport const subscribeToLeads = (onNewLead, onLeadUpdated, onError, onAutomationStats) => {\n  const { token, tenantId } = getAuthContext();\n  const query = new URLSearchParams();\n  if (token) query.set('token', token);\n  if (tenantId) query.set('tenant_id', tenantId);\n  const url = `${API_URL}/api/stream/leads?${query.toString()}`;\n  const eventSource = new EventSource(url);\n\n  eventSource.addEventListener('new_lead', (event) => {\n    try {\n      const lead = JSON.parse(event.data);\n      onNewLead(lead);\n    } catch (e) {\n      console.error('Error parsing lead event:', e);\n    }\n  });\n\n  eventSource.addEventListener('lead_updated', (event) => {\n    try {\n      const lead = JSON.parse(event.data);\n      if (onLeadUpdated) onLeadUpdated(lead);\n    } catch (e) {\n      console.error('Error parsing lead_updated event:', e);\n    }\n  });\n\n  eventSource.addEventListener('automation_stats', (event) => {\n    try {\n      const stats = JSON.parse(event.data);\n      if (onAutomationStats) onAutomationStats(stats);\n    } catch (e) {\n      console.error('Error parsing automation_stats event:', e);\n    }\n  });\n\n  eventSource.addEventListener('connected', (event) => {\n    console.log('Connected to leads stream:', event.data);\n  });\n\n  eventSource.onerror = (error) => {\n    console.error('Leads SSE error:', error);\n    if (onError) onError(error);\n  };\n\n  return eventSource;\n};\n\n// ============== AI Marketing Agent API ==============\n\n/**\n * Get AI Agent profile and capabilities\n */\nexport const getAgentProfile = async () => {\n  const url = `${API_URL}/api/agent/profile`;\n  logRequest('GET', url);\n\n  try {\n    const response = await fetch(url);\n    if (!response.ok) throw new Error('Failed to fetch agent profile');\n    return await response.json();\n  } catch (error) {\n    console.error('[API] Error fetching agent profile:', error);\n    return {\n      success: true,\n      agent: {\n        name: \"Maya\",\n        title: \"AI Marketing & Sales Agent\",\n        avatar: \"https://api.dicebear.com/7.x/personas/svg?seed=Maya&backgroundColor=667eea\"\n      },\n      capabilities: [\"Marketing\", \"Lead Generation\", \"Sales\"]\n    };\n  }\n};\n\n/**\n * Generate a marketing post\n */\nexport const generateMarketingPost = async (params) => {\n  const url = `${API_URL}/api/agent/generate-post`;\n  logRequest('POST', url, params);\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to generate post');\n  return await response.json();\n};\n\n/**\n * Search for property owner leads\n */\nexport const searchPropertyLeads = async (params) => {\n  const url = `${API_URL}/api/agent/search-leads`;\n  logRequest('POST', url, params);\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to search leads');\n  return await response.json();\n};\n\n/**\n * Draft outreach email to property owner\n */\nexport const draftOutreachEmail = async (params) => {\n  const url = `${API_URL}/api/agent/draft-email`;\n  logRequest('POST', url, params);\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to draft email');\n  return await response.json();\n};\n\n/**\n * Generate client acquisition strategy\n */\nexport const generateAcquisitionStrategy = async (params) => {\n  const url = `${API_URL}/api/agent/acquisition-strategy`;\n  logRequest('POST', url, params);\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to generate strategy');\n  return await response.json();\n};\n\n/**\n * Simulate publishing a post\n */\nexport const publishPost = async (params) => {\n  const url = `${API_URL}/api/agent/publish`;\n  logRequest('POST', url, params);\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to publish');\n  return await response.json();\n};\n\n/**\n * Simulate sending an email\n */\nexport const sendOutreachEmail = async (params) => {\n  const url = `${API_URL}/api/agent/send-email`;\n  logRequest('POST', url, params);\n\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify(params)\n  });\n  if (!response.ok) throw new Error('Failed to send email');\n  return await response.json();\n};\n\nconst api = {\n  getHealth,\n  getDemoAuthToken,\n  getPilotAccessToken,\n  connectCalendar,\n  getCalendarStatus,\n  createManualCheckout,\n  getManualRooms,\n  getProperties,\n  updateProperty,\n  deleteProperty,\n  getPropertyStaff,\n  addPropertyStaff,\n  updatePropertyStaff,\n  removePropertyStaff,\n  getPropertyTasks,\n  createTask,\n  createPropertyTask,\n  updatePropertyTaskStatus,\n  createManualRoom,\n  createManualRoomWithDescription,\n  createProperty,\n  checkoutManualRoom,\n  checkinManualRoom,\n  getManualRoomHistory,\n  assignManualRoom,\n  searchProperties,\n  resolveManualRoom,\n  reportIssue,\n  importManualRoomFromLink,\n  importProperty,\n  setWorkerLanguage,\n  getMessages,\n  clockInStaff,\n  clockOutStaff,\n  getStaffList,\n  toggleStaffActive,\n  getLeaderboard,\n  getStaffTasks,\n  updateStaffTaskStatus,\n  endShiftStaff,\n  updateStaffPhoto,\n  uploadStaffPhoto,\n  updateStaffLocation,\n  subscribeToStaff,\n  getDispatchStatus,\n  setDispatchStatus,\n  sendAIAction,\n  createBooking,\n  getBookings,\n  getAIInsights,\n  getLatestBooking,\n  getDailyReport,\n  getAutomationStats,\n  createLead,\n  getLeads,\n  getLead,\n  getLeadsStats,\n  updateLead,\n  updateRoomStatus,\n  subscribeToLeads,\n  getAgentProfile,\n  generateMarketingPost,\n  searchPropertyLeads,\n  draftOutreachEmail,\n  generateAcquisitionStrategy,\n  publishPost,\n  sendOutreachEmail,\n};\n\nexport default api;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}