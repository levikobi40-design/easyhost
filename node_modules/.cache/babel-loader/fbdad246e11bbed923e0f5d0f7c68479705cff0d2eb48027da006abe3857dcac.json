{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\hotel_ai_assistant\\\\hotel_dashboard\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, Suspense } from 'react';\nimport useTranslations from './hooks/useTranslations';\nimport useStore from './store/useStore';\nimport { getDemoAuthToken } from './services/api';\nimport { wsService } from './services/websocket';\nimport './styles/tailwind.css';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst HostShell = /*#__PURE__*/React.lazy(_c = () => import('./views/HostShell'));\n_c2 = HostShell;\nconst OperatorShell = /*#__PURE__*/React.lazy(_c3 = () => import('./views/OperatorShell'));\n_c4 = OperatorShell;\nconst FieldShell = /*#__PURE__*/React.lazy(_c5 = () => import('./views/FieldShell'));\n_c6 = FieldShell;\nconst parseJwtPayload = token => {\n  try {\n    const payload = token.split('.')[1];\n    const normalized = payload.replace(/-/g, '+').replace(/_/g, '/');\n    const decoded = JSON.parse(atob(normalized));\n    return decoded || {};\n  } catch (error) {\n    return {};\n  }\n};\nfunction App() {\n  _s();\n  const {\n    lang,\n    activeTenantId,\n    authToken,\n    setAuthToken,\n    setActiveTenantId,\n    role,\n    hasHydrated\n  } = useStore();\n  const {\n    i18n\n  } = useTranslations();\n  const isRTL = lang === 'he';\n  useEffect(() => {\n    // Connect to WebSocket on mount\n    wsService.connect();\n    return () => {\n      wsService.disconnect();\n    };\n  }, []);\n  useEffect(() => {\n    const ensureAuth = async () => {\n      if (authToken) return;\n      const params = new URLSearchParams(window.location.search);\n      const tokenParam = params.get('token');\n      if (tokenParam) {\n        const payload = parseJwtPayload(tokenParam);\n        if (payload !== null && payload !== void 0 && payload.tenant_id) {\n          setActiveTenantId(payload.tenant_id);\n        }\n        setAuthToken(tokenParam);\n        params.delete('token');\n        const next = `${window.location.pathname}${params.toString() ? `?${params}` : ''}`;\n        window.history.replaceState({}, '', next);\n        return;\n      }\n      try {\n        const result = await getDemoAuthToken(activeTenantId);\n        setAuthToken(result.token);\n      } catch (error) {\n        console.error('Failed to obtain demo token:', error);\n      }\n    };\n    ensureAuth();\n  }, [activeTenantId, authToken, setAuthToken, setActiveTenantId]);\n  useEffect(() => {\n    i18n.changeLanguage(lang);\n    if (typeof document !== 'undefined') {\n      document.documentElement.dir = isRTL ? 'rtl' : 'ltr';\n      document.documentElement.lang = lang;\n    }\n  }, [i18n, isRTL, lang]);\n  if (!hasHydrated) {\n    return null;\n  }\n  const renderRoleShell = () => {\n    switch (role) {\n      case 'operator':\n        return /*#__PURE__*/_jsxDEV(OperatorShell, {}, \"operator-shell\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 16\n        }, this);\n      case 'field':\n        return /*#__PURE__*/_jsxDEV(FieldShell, {}, \"field-shell\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 16\n        }, this);\n      case 'host':\n      default:\n        return /*#__PURE__*/_jsxDEV(HostShell, {}, \"host-shell\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    dir: isRTL ? 'rtl' : 'ltr',\n    children: /*#__PURE__*/_jsxDEV(Suspense, {\n      fallback: null,\n      children: renderRoleShell()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"FA8ePUr/aiMJcYHF1D4yY3gJ/OE=\", false, function () {\n  return [useStore, useTranslations];\n});\n_c7 = App;\nexport default App;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n$RefreshReg$(_c, \"HostShell$React.lazy\");\n$RefreshReg$(_c2, \"HostShell\");\n$RefreshReg$(_c3, \"OperatorShell$React.lazy\");\n$RefreshReg$(_c4, \"OperatorShell\");\n$RefreshReg$(_c5, \"FieldShell$React.lazy\");\n$RefreshReg$(_c6, \"FieldShell\");\n$RefreshReg$(_c7, \"App\");","map":{"version":3,"names":["React","useEffect","Suspense","useTranslations","useStore","getDemoAuthToken","wsService","jsxDEV","_jsxDEV","HostShell","lazy","_c","_c2","OperatorShell","_c3","_c4","FieldShell","_c5","_c6","parseJwtPayload","token","payload","split","normalized","replace","decoded","JSON","parse","atob","error","App","_s","lang","activeTenantId","authToken","setAuthToken","setActiveTenantId","role","hasHydrated","i18n","isRTL","connect","disconnect","ensureAuth","params","URLSearchParams","window","location","search","tokenParam","get","tenant_id","delete","next","pathname","toString","history","replaceState","result","console","changeLanguage","document","documentElement","dir","renderRoleShell","fileName","_jsxFileName","lineNumber","columnNumber","children","fallback","_c7","$RefreshReg$"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/App.js"],"sourcesContent":["import React, { useEffect, Suspense } from 'react';\nimport useTranslations from './hooks/useTranslations';\nimport useStore from './store/useStore';\nimport { getDemoAuthToken } from './services/api';\nimport { wsService } from './services/websocket';\nimport './styles/tailwind.css';\nimport './App.css';\nconst HostShell = React.lazy(() => import('./views/HostShell'));\nconst OperatorShell = React.lazy(() => import('./views/OperatorShell'));\nconst FieldShell = React.lazy(() => import('./views/FieldShell'));\n\nconst parseJwtPayload = (token) => {\n  try {\n    const payload = token.split('.')[1];\n    const normalized = payload.replace(/-/g, '+').replace(/_/g, '/');\n    const decoded = JSON.parse(atob(normalized));\n    return decoded || {};\n  } catch (error) {\n    return {};\n  }\n};\n\nfunction App() {\n  const { lang, activeTenantId, authToken, setAuthToken, setActiveTenantId, role, hasHydrated } = useStore();\n  const { i18n } = useTranslations();\n  const isRTL = lang === 'he';\n\n  useEffect(() => {\n    // Connect to WebSocket on mount\n    wsService.connect();\n    \n    return () => {\n      wsService.disconnect();\n    };\n  }, []);\n\n  useEffect(() => {\n    const ensureAuth = async () => {\n      if (authToken) return;\n      const params = new URLSearchParams(window.location.search);\n      const tokenParam = params.get('token');\n      if (tokenParam) {\n        const payload = parseJwtPayload(tokenParam);\n        if (payload?.tenant_id) {\n          setActiveTenantId(payload.tenant_id);\n        }\n        setAuthToken(tokenParam);\n        params.delete('token');\n        const next = `${window.location.pathname}${params.toString() ? `?${params}` : ''}`;\n        window.history.replaceState({}, '', next);\n        return;\n      }\n      try {\n        const result = await getDemoAuthToken(activeTenantId);\n        setAuthToken(result.token);\n      } catch (error) {\n        console.error('Failed to obtain demo token:', error);\n      }\n    };\n    ensureAuth();\n  }, [activeTenantId, authToken, setAuthToken, setActiveTenantId]);\n\n  useEffect(() => {\n    i18n.changeLanguage(lang);\n    if (typeof document !== 'undefined') {\n      document.documentElement.dir = isRTL ? 'rtl' : 'ltr';\n      document.documentElement.lang = lang;\n    }\n  }, [i18n, isRTL, lang]);\n\n  if (!hasHydrated) {\n    return null;\n  }\n\n  const renderRoleShell = () => {\n    switch (role) {\n      case 'operator':\n        return <OperatorShell key=\"operator-shell\" />;\n      case 'field':\n        return <FieldShell key=\"field-shell\" />;\n      case 'host':\n      default:\n        return <HostShell key=\"host-shell\" />;\n    }\n  };\n\n  return (\n    <div dir={isRTL ? 'rtl' : 'ltr'}>\n      <Suspense fallback={null}>\n        {renderRoleShell()}\n      </Suspense>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}