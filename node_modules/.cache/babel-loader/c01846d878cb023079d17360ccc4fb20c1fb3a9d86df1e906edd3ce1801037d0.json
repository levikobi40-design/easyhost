{"ast":null,"code":"import i18n from'../i18n';import{API_URL,apiRequest}from'../utils/apiClient';console.log('[Easy Host AI API] Using backend URL:',API_URL);// Debug helper - logs all API requests\nconst logRequest=(method,url,payload)=>{console.log(`[API] ${method} ${url}`);if(payload)console.log('[API] Payload:',payload);};const logResponse=(url,status,data)=>{console.log(`[API] Response from ${url}:`,status,data);};const getAuthContext=()=>{try{var _parsed$state,_parsed$state2;const raw=localStorage.getItem('hotel-enterprise-storage');if(!raw)return{};const parsed=JSON.parse(raw);return{token:parsed===null||parsed===void 0?void 0:(_parsed$state=parsed.state)===null||_parsed$state===void 0?void 0:_parsed$state.authToken,tenantId:parsed===null||parsed===void 0?void 0:(_parsed$state2=parsed.state)===null||_parsed$state2===void 0?void 0:_parsed$state2.activeTenantId};}catch(error){return{};}};const getAuthHeaders=()=>{const{token,tenantId}=getAuthContext();const headers={};if(token)headers.Authorization=`Bearer ${token}`;if(tenantId)headers['X-Tenant-Id']=tenantId;return headers;};/**\r\n * Health check - get server status\r\n * @returns {Promise<object>} { ok, status, openai_configured, sse_clients }\r\n */export const getHealth=async()=>{const url=`${API_URL}/health`;logRequest('GET',url);try{const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){console.error(`[API] Health check failed: HTTP ${response.status}`);throw new Error('Health check failed');}const data=await response.json();logResponse(url,response.status,data);return data;}catch(error){console.error('[API] Error checking health:',error);throw error;}};export const getDemoAuthToken=async tenantId=>{const url=`${API_URL}/api/auth/demo`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({tenant_id:tenantId})});if(!response.ok){throw new Error('Failed to get demo token');}return await response.json();};export const getPilotAccessToken=async tenantName=>{const url=`${API_URL}/api/auth/pilot`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({tenant_name:tenantName})});if(!response.ok){throw new Error('Failed to get pilot token');}return await response.json();};export const connectCalendar=async(icalUrl,nightlyRate)=>{const url=`${API_URL}/api/onboarding/ical`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({ical_url:icalUrl,nightly_rate:nightlyRate})});if(!response.ok){const errorText=await response.text();throw new Error(errorText||'Failed to sync calendar');}return await response.json();};export const getCalendarStatus=async()=>{const url=`${API_URL}/api/onboarding/status`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch calendar status');}return await response.json();};export const refreshCalendar=async()=>{const url=`${API_URL}/api/onboarding/ical/refresh`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to refresh calendar');}return await response.json();};export const createManualCheckout=async(checkoutDate,room)=>{const url=`${API_URL}/api/onboarding/manual-checkout`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({checkout_date:checkoutDate,room})});if(!response.ok){throw new Error('Failed to create manual checkout');}return await response.json();};export const getManualRooms=async()=>{const url=`${API_URL}/api/rooms/manual`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch manual rooms');}return await response.json();};/** Fetch all properties from GET /api/properties (manual_rooms table) */export const getProperties=async()=>{let headers={'Content-Type':'application/json',...getAuthHeaders()};if(!headers.Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers={...headers,Authorization:`Bearer ${auth.token}`};}catch(_){}}const response=await fetch(`${API_URL}/api/properties`,{method:'GET',headers});if(!response.ok)throw new Error('Failed to fetch properties');return await response.json();};/** PUT /api/properties/<id> - update a property. Pass id exactly as in DB (UUID). */export const updateProperty=async function(id){let payload=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const idStr=id!=null&&id!==''?String(id).trim():'';if(!idStr)throw new Error('Property id required');let headers={'Content-Type':'application/json',...getAuthHeaders()};if(!headers.Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers={...headers,Authorization:`Bearer ${auth.token}`};}catch(_){}}const response=await fetch(`${API_URL}/api/properties/${idStr}`,{method:'PUT',headers,body:JSON.stringify(payload)});if(!response.ok){const data=await response.json().catch(()=>({}));throw new Error(data.error||'Failed to update property');}return await response.json();};/** DELETE /api/properties/<id> - remove a property by UUID */export const deleteProperty=async id=>{const idStr=id!=null&&id!==''?String(id).trim():'';if(!idStr)throw new Error('Property id required');let headers={'Content-Type':'application/json',...getAuthHeaders()};if(!headers.Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers={...headers,Authorization:`Bearer ${auth.token}`};}catch(_){}}const response=await fetch(`${API_URL}/api/properties/${idStr}`,{method:'DELETE',headers});if(!response.ok){const data=await response.json().catch(()=>({}));throw new Error(data.error||'Failed to delete property');}return await response.json();};/** GET /api/properties/<id>/staff - list employees for property */export const getPropertyStaff=async propertyId=>{const idStr=propertyId!=null?String(propertyId).trim():'';if(!idStr)return[];let headers={'Content-Type':'application/json',...getAuthHeaders()};if(!headers.Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers={...headers,Authorization:`Bearer ${auth.token}`};}catch(_){}}const response=await fetch(`${API_URL}/api/properties/${idStr}/staff`,{method:'GET',headers});if(!response.ok)return[];return await response.json();};/** POST /api/properties/<id>/staff - add employee (name, role) linked to property_id */export const addPropertyStaff=async(propertyId,_ref)=>{let{name,role='Staff'}=_ref;const idStr=propertyId!=null?String(propertyId).trim():'';if(!idStr)throw new Error('Property id required');let headers={'Content-Type':'application/json',...getAuthHeaders()};if(!headers.Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers={...headers,Authorization:`Bearer ${auth.token}`};}catch(_){}}const response=await fetch(`${API_URL}/api/properties/${idStr}/staff`,{method:'POST',headers,body:JSON.stringify({name:(name||'').trim(),role:(role||'Staff').trim()})});if(!response.ok){const data=await response.json().catch(()=>({}));throw new Error(data.error||'Failed to add employee');}return await response.json();};/** DELETE /api/properties/<id>/staff/<staff_id> - remove employee from property */export const removePropertyStaff=async(propertyId,staffId)=>{const pid=propertyId!=null?String(propertyId).trim():'';const sid=staffId!=null?String(staffId).trim():'';if(!pid||!sid)throw new Error('Property and staff id required');let headers={'Content-Type':'application/json',...getAuthHeaders()};if(!headers.Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers={...headers,Authorization:`Bearer ${auth.token}`};}catch(_){}}const response=await fetch(`${API_URL}/api/properties/${pid}/staff/${sid}`,{method:'DELETE',headers});if(!response.ok){const data=await response.json().catch(()=>({}));throw new Error(data.error||'Failed to remove employee');}return await response.json();};export const createManualRoom=async name=>{const url=`${API_URL}/api/rooms/manual`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({name})});if(!response.ok){throw new Error('Failed to create manual room');}return await response.json();};export const createManualRoomWithDescription=async(name,description,photoUrl)=>{const url=`${API_URL}/api/rooms/manual`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({name,description,photo_url:photoUrl})});if(!response.ok){throw new Error('Failed to create manual room');}return await response.json();};/**\r\n * Create property - uses central apiClient (http://127.0.0.1:5000)\r\n * All fields have safe defaults to prevent undefined errors.\r\n */export const createProperty=async function(){var _payload$name,_payload$description,_payload$photo_url;let payload=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};const propertyData={name:String((_payload$name=payload.name)!==null&&_payload$name!==void 0?_payload$name:'').trim()||'Unnamed Property',description:String((_payload$description=payload.description)!==null&&_payload$description!==void 0?_payload$description:''),price:Number(payload.price)||0,photo_url:String((_payload$photo_url=payload.photo_url)!==null&&_payload$photo_url!==void 0?_payload$photo_url:''),images:payload.images||[],amenities:payload.amenities||[]};console.log('[createProperty] Sending:',propertyData);try{let headers={};if(!getAuthHeaders().Authorization){try{const auth=await getDemoAuthToken('default');if(auth!==null&&auth!==void 0&&auth.token)headers.Authorization=`Bearer ${auth.token}`;}catch(e){console.warn('[createProperty] Demo auth failed:',e);}}const result=await apiRequest('/api/properties',{method:'POST',body:propertyData,headers:{...getAuthHeaders(),...headers}});return result;}catch(error){var _error$status,_error$response,_error$data,_error$response2,_ref2,_data$error;const status=(_error$status=error===null||error===void 0?void 0:error.status)!==null&&_error$status!==void 0?_error$status:error===null||error===void 0?void 0:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status;const data=(_error$data=error===null||error===void 0?void 0:error.data)!==null&&_error$data!==void 0?_error$data:error===null||error===void 0?void 0:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.data;const serverMsg=(_ref2=(_data$error=data===null||data===void 0?void 0:data.error)!==null&&_data$error!==void 0?_data$error:data===null||data===void 0?void 0:data.message)!==null&&_ref2!==void 0?_ref2:typeof data==='string'?data:JSON.stringify(data||{});const msg=`Create Property failed: ${(error===null||error===void 0?void 0:error.message)||'Unknown error'}`+(status?` [HTTP ${status}]`:'')+(serverMsg?` | Server: ${serverMsg}`:'');console.error('[createProperty] Full error:',error);window.alert(msg);throw error;}};/**\r\n * Generic image upload - accepts multiple files, returns array of URLs\r\n * @param {File|File[]} files - Single file or array of files\r\n * @returns {Promise<{urls: string[]}>}\r\n */export const uploadImages=async files=>{const fileList=Array.isArray(files)?files:[files];const formData=new FormData();fileList.forEach(f=>formData.append('files',f));const response=await fetch(`${API_URL}/api/upload`,{method:'POST',headers:{...getAuthHeaders()// FormData triggers browser to set Content-Type: multipart/form-data; boundary=...\n},body:formData});if(!response.ok){const err=await response.json().catch(()=>({}));throw new Error(err.error||'Failed to upload images');}return await response.json();};export const uploadPropertyPhoto=async file=>{const formData=new FormData();formData.append('photo',file);const response=await fetch(`${API_URL}/api/rooms/manual/photo/upload`,{method:'POST',headers:getAuthHeaders(),body:formData});if(!response.ok){const err=await response.json().catch(()=>({}));throw new Error(err.error||'Failed to upload photo');}const data=await response.json();return data.photo_url;};export const checkoutManualRoom=async roomId=>{const url=`${API_URL}/api/rooms/manual/${roomId}/checkout`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to checkout room');}return await response.json();};export const checkinManualRoom=async roomId=>{const url=`${API_URL}/api/rooms/manual/${roomId}/checkin`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to check-in room');}return await response.json();};export const getManualRoomHistory=async roomId=>{const url=`${API_URL}/api/rooms/manual/${roomId}/history`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch room history');}return await response.json();};export const assignManualRoom=async(roomId,staffId)=>{const url=`${API_URL}/api/rooms/manual/${roomId}/assign`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({staff_id:staffId})});if(!response.ok){throw new Error('Failed to assign room');}return await response.json();};export const resolveManualRoom=async roomId=>{const url=`${API_URL}/api/rooms/manual/${roomId}/resolve`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to resolve room');}return await response.json();};export const reportIssue=async _ref3=>{let{roomId,roomName,taskId,note,photo}=_ref3;const url=`${API_URL}/api/issues/report`;const formData=new FormData();formData.append('room_id',roomId);formData.append('room_name',roomName||'');if(taskId)formData.append('task_id',taskId);if(note)formData.append('note',note);formData.append('photo',photo);const response=await fetch(url,{method:'POST',headers:{...getAuthHeaders()},body:formData});if(!response.ok){throw new Error('Failed to report issue');}return await response.json();};export const searchProperties=async query=>{const url=`${API_URL}/api/properties/search?q=${encodeURIComponent(query)}`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to search properties');}return await response.json();};export const importManualRoomFromLink=async url=>{const endpoint=`${API_URL}/api/rooms/manual/import`;const response=await fetch(endpoint,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({url})});if(!response.ok){throw new Error('Failed to import room');}return await response.json();};/** Import Airbnb/Booking property - creates property + initial cleaning task */export const importProperty=async url=>{const response=await fetch(`${API_URL}/api/v1/properties/import`,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({url})});if(!response.ok){const err=await response.json().catch(()=>({}));throw new Error(err.error||'Failed to import property');}return await response.json();};export const setWorkerLanguage=async language=>{const url=`${API_URL}/api/worker/language`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({language})});if(!response.ok){throw new Error('Failed to set worker language');}return await response.json();};export const getMessages=async function(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:50;const url=`${API_URL}/api/messages?limit=${limit}`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch messages');}return await response.json();};export const clockInStaff=async payload=>{const url=`${API_URL}/api/staff/clock-in`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify(payload)});if(!response.ok){throw new Error('Failed to clock in staff');}return await response.json();};export const clockOutStaff=async staffId=>{const url=`${API_URL}/api/staff/clock-out`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({staff_id:staffId})});if(!response.ok){throw new Error('Failed to clock out staff');}return await response.json();};export const getStaffList=async()=>{const url=`${API_URL}/api/staff`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch staff');}return await response.json();};export const toggleStaffActive=async(staffId,active)=>{const url=`${API_URL}/api/staff/${staffId}/active`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({active})});if(!response.ok){throw new Error('Failed to toggle staff');}return await response.json();};export const getLeaderboard=async()=>{const url=`${API_URL}/api/staff/leaderboard`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch leaderboard');}return await response.json();};export const getTasks=async function(){let staffId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const url=staffId?`${API_URL}/api/staff/tasks?staff_id=${encodeURIComponent(staffId)}`:`${API_URL}/api/staff/tasks`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch tasks');}return await response.json();};export const getStaffTasks=getTasks;export const updateStaffTaskStatus=async(taskId,status)=>{const url=`${API_URL}/api/staff/tasks/${taskId}/status`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({status})});if(!response.ok){throw new Error('Failed to update task');}return await response.json();};export const endShiftStaff=async staffId=>{const url=`${API_URL}/api/staff/${staffId}/end-shift`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to end shift');}return await response.json();};export const updateStaffPhoto=async(staffId,photoUrl)=>{const url=`${API_URL}/api/staff/${staffId}/photo`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({photo_url:photoUrl})});if(!response.ok){throw new Error('Failed to update staff photo');}return await response.json();};export const uploadStaffPhoto=async(staffId,file)=>{const url=`${API_URL}/api/staff/${staffId}/photo/upload`;const formData=new FormData();formData.append('photo',file);const response=await fetch(url,{method:'POST',headers:{...getAuthHeaders()// FormData sends as multipart/form-data (browser sets Content-Type with boundary)\n},body:formData});if(!response.ok){throw new Error('Failed to upload staff photo');}return await response.json();};export const updateStaffLocation=async(staffId,lat,lng)=>{const url=`${API_URL}/api/staff/${staffId}/location`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({lat,lng})});if(!response.ok){throw new Error('Failed to update staff location');}return await response.json();};export const subscribeToStaff=(onUpdate,onError)=>{const{token,tenant_id}=getAuthContext();const qs=new URLSearchParams();if(token)qs.set('token',token);if(tenant_id)qs.set('tenant_id',tenant_id);const url=`${API_URL}/api/stream/staff?${qs.toString()}`;const source=new EventSource(url);source.addEventListener('staff_update',event=>{try{const data=JSON.parse(event.data);onUpdate===null||onUpdate===void 0?void 0:onUpdate(data);}catch(error){// ignore parse errors\n}});source.onerror=error=>{onError===null||onError===void 0?void 0:onError(error);};return source;};export const getDispatchStatus=async()=>{const url=`${API_URL}/api/dispatch/status`;const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch dispatch status');}return await response.json();};export const setDispatchStatus=async(enabled,intervalSeconds)=>{const url=`${API_URL}/api/dispatch/status`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify({enabled,interval_seconds:intervalSeconds})});if(!response.ok){throw new Error('Failed to update dispatch status');}return await response.json();};/**\r\n * Send an AI action request\r\n * @param {string} type - Action type (e.g., 'checkout', 'towels', 'restaurant')\r\n * @param {string} room - Room identifier\r\n * @param {string} role - User role ('owner', 'staff', 'guest')\r\n * @param {string} lang - Language code\r\n * @returns {Promise<object>} Response with { success, intent, draft, auto_send, is_safe }\r\n */export const sendAIAction=async(type,room,role,lang)=>{try{const response=await fetch(`${API_URL}/ai_action`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({type,room,role,lang})});if(!response.ok){throw new Error('Failed to send AI action');}return await response.json();}catch(error){console.error('Error sending AI action:',error);throw error;}};/**\r\n * Create a new booking\r\n * @param {object} bookingData - Booking data { room_name, customer_name }\r\n * @returns {Promise<object>}\r\n */export const createBooking=async bookingData=>{const url=`${API_URL}/api/book`;logRequest('POST',url,bookingData);try{const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(bookingData)});const responseText=await response.text();console.log(`[API] createBooking response: status=${response.status}, body=${responseText}`);if(!response.ok){throw new Error(`Failed to create booking: HTTP ${response.status}`);}return JSON.parse(responseText);}catch(error){console.error('[API] Error creating booking:',error);throw error;}};/**\r\n * Get all bookings\r\n * @returns {Promise<Array>}\r\n */export const getBookings=async()=>{try{const response=await fetch(`${API_URL}/api/bookings`,{method:'GET',headers:{'Content-Type':'application/json'}});if(!response.ok){throw new Error('Failed to fetch bookings');}return await response.json();}catch(error){console.error('Error fetching bookings:',error);throw error;}};/**\r\n * Get AI insights\r\n * Returns fallback message if OpenAI not configured on backend\r\n * @returns {Promise<object>} { insight, bookings_count }\r\n */export const getAIInsights=async()=>{try{const response=await fetch(`${API_URL}/api/ai-insights`,{method:'GET',headers:{'Content-Type':'application/json'}});if(!response.ok){throw new Error('Failed to fetch AI insights');}return await response.json();}catch(error){console.error('Error fetching AI insights:',error);// Return fallback insight on error\nreturn{insight:i18n.t('common.readyToHelp'),bookings_count:0};}};/**\r\n * Get latest booking info (for polling fallback)\r\n * @returns {Promise<object>} { latest_id, latest_room, latest_customer, latest_time, total_count }\r\n */export const getLatestBooking=async()=>{try{const response=await fetch(`${API_URL}/api/bookings/latest`,{method:'GET',headers:{'Content-Type':'application/json'}});if(!response.ok){throw new Error('Failed to fetch latest booking');}return await response.json();}catch(error){console.error('Error fetching latest booking:',error);throw error;}};/**\r\n * Get dashboard summary (revenue, active tasks, upcoming)\r\n * @returns {Promise<object>}\r\n */export const getDashboardSummary=async()=>{try{const response=await fetch(`${API_URL}/api/v1/dashboard/summary`,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok)throw new Error('Failed to fetch dashboard summary');return await response.json();}catch(error){console.error('Error fetching dashboard summary:',error);return{revenue:'0₪',active_tasks_count:0,upcoming:[],status:'Unavailable'};}};/**\r\n * Get financial summary (LTV, conversion rate, projected revenue)\r\n * @returns {Promise<{avg_ltv: string, conversion_rate: string, projected_revenue: string}>}\r\n */export const getFinancialSummary=async()=>{try{const response=await fetch(`${API_URL}/api/v1/financials/summary`,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok)throw new Error('Failed to fetch financial summary');return await response.json();}catch(error){console.error('Error fetching financial summary:',error);return{avg_ltv:'₪0',conversion_rate:'0%',projected_revenue:'₪0'};}};/**\r\n * Get daily ROI report\r\n * @returns {Promise<object>}\r\n */export const getDailyReport=async()=>{try{const response=await fetch(`${API_URL}/api/reports/daily`,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch daily report');}const data=await response.json();return data.report||data;}catch(error){console.error('Error fetching daily report:',error);return{date:new Date().toISOString().split('T')[0],roi_metrics:{hours_saved:0,cleanings_triggered:0,leads_captured:0},recommendations:[],agent_performance:[],savings:{automation_rate:0}};}};/**\r\n * Get automation stats (messages sent, last scan, objection success)\r\n * @returns {Promise<object>}\r\n */export const getAutomationStats=async()=>{try{const response=await fetch(`${API_URL}/api/stats`,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch automation stats');}return await response.json();}catch(error){console.error('Error fetching automation stats:',error);return{automation_stats:{automated_messages:0,last_scan:null,leads_total:0},objection_success:{}};}};/**\r\n * Send welcome WhatsApp message for a lead\r\n * @param {string} leadId\r\n * @returns {Promise<object>}\r\n */export const sendWelcomeMessage=async leadId=>{try{const response=await fetch(`${API_URL}/api/whatsapp/welcome`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({lead_id:leadId})});if(!response.ok){throw new Error('Failed to send welcome message');}return await response.json();}catch(error){console.error('Error sending welcome message:',error);throw error;}};// ============== Leads API ==============\n/**\r\n * Create a new lead\r\n * @param {object} leadData - { name, email, phone, guests, checkin, checkout, source }\r\n * @returns {Promise<object>} { success, id, score }\r\n */export const createLead=async leadData=>{const url=`${API_URL}/api/leads`;logRequest('POST',url,leadData);try{const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify(leadData)});const responseText=await response.text();console.log(`[API] createLead response: status=${response.status}, body=${responseText}`);if(!response.ok){throw new Error(`Failed to create lead: HTTP ${response.status}`);}return JSON.parse(responseText);}catch(error){console.error('[API] Error creating lead:',error);throw error;}};/**\r\n * Get all leads\r\n * @param {string} status - Optional status filter ('new', 'contacted', 'qualified', 'booked', 'lost')\r\n * @returns {Promise<Array>}\r\n */export const getLeads=async function(){let status=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;const url=status?`${API_URL}/api/leads?status=${status}`:`${API_URL}/api/leads`;logRequest('GET',url);try{const response=await fetch(url,{method:'GET',headers:{'Content-Type':'application/json'}});if(!response.ok){console.error(`[API] getLeads failed: HTTP ${response.status}`);throw new Error('Failed to fetch leads');}const data=await response.json();// IMPORTANT: Ensure we always return an array\nif(Array.isArray(data)){console.log(`[API] getLeads: received ${data.length} leads`);return data;}else if(data&&typeof data==='object'){// If backend returns a single object, wrap it in an array\nconsole.warn('[API] getLeads: received object instead of array, wrapping');return[data];}else{console.warn('[API] getLeads: unexpected response format, returning empty array');return[];}}catch(error){console.error('[API] Error fetching leads:',error);// Return empty array on error instead of throwing\nreturn[];}};/**\r\n * Get a single lead by ID\r\n * @param {number} leadId - Lead ID\r\n * @returns {Promise<object>}\r\n */export const getLead=async leadId=>{try{const response=await fetch(`${API_URL}/api/leads/${leadId}`,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch lead');}return await response.json();}catch(error){console.error('Error fetching lead:',error);throw error;}};/**\r\n * Get leads statistics\r\n * @returns {Promise<object>} { total, new, contacted, qualified, won, lost, avg_score }\r\n */export const getLeadsStats=async()=>{try{const response=await fetch(`${API_URL}/api/leads/stats`,{method:'GET',headers:{'Content-Type':'application/json',...getAuthHeaders()}});if(!response.ok){throw new Error('Failed to fetch leads stats');}return await response.json();}catch(error){console.error('Error fetching leads stats:',error);// Return default stats on error\nreturn{total:0,new:0,contacted:0,qualified:0,won:0,lost:0,avg_score:0};}};/**\r\n * Update lead status, score, or notes\r\n * @param {number} leadId - Lead ID\r\n * @param {object} data - { status, score, notes }\r\n * @returns {Promise<object>}\r\n */export const updateLead=async(leadId,data)=>{try{const response=await fetch(`${API_URL}/api/leads/${leadId}`,{method:'PATCH',headers:{'Content-Type':'application/json',...getAuthHeaders()},body:JSON.stringify(data)});if(!response.ok){throw new Error('Failed to update lead');}return await response.json();}catch(error){console.error('Error updating lead:',error);throw error;}};/**\r\n * Update room status or details\r\n * @param {number} roomId\r\n * @param {object} data\r\n * @returns {Promise<object>}\r\n */export const updateRoomStatus=async(roomId,data)=>{try{const response=await fetch(`${API_URL}/api/rooms/${roomId}`,{method:'PATCH',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});if(!response.ok){throw new Error('Failed to update room');}return await response.json();}catch(error){console.error('Error updating room:',error);throw error;}};/**\r\n * Subscribe to leads SSE stream\r\n * @param {function} onNewLead - Callback for new lead events\r\n * @param {function} onLeadUpdated - Callback for lead updated events\r\n * @param {function} onError - Callback for errors\r\n * @returns {EventSource} - The event source (call .close() to disconnect)\r\n */export const subscribeToLeads=(onNewLead,onLeadUpdated,onError,onAutomationStats)=>{const{token,tenantId}=getAuthContext();const query=new URLSearchParams();if(token)query.set('token',token);if(tenantId)query.set('tenant_id',tenantId);const url=`${API_URL}/api/stream/leads?${query.toString()}`;const eventSource=new EventSource(url);eventSource.addEventListener('new_lead',event=>{try{const lead=JSON.parse(event.data);onNewLead(lead);}catch(e){console.error('Error parsing lead event:',e);}});eventSource.addEventListener('lead_updated',event=>{try{const lead=JSON.parse(event.data);if(onLeadUpdated)onLeadUpdated(lead);}catch(e){console.error('Error parsing lead_updated event:',e);}});eventSource.addEventListener('automation_stats',event=>{try{const stats=JSON.parse(event.data);if(onAutomationStats)onAutomationStats(stats);}catch(e){console.error('Error parsing automation_stats event:',e);}});eventSource.addEventListener('connected',event=>{console.log('Connected to leads stream:',event.data);});eventSource.onerror=error=>{console.error('Leads SSE error:',error);if(onError)onError(error);};return eventSource;};// ============== AI Marketing Agent API ==============\n/**\r\n * Get AI Agent profile and capabilities\r\n */export const getAgentProfile=async()=>{const url=`${API_URL}/api/agent/profile`;logRequest('GET',url);try{const response=await fetch(url);if(!response.ok)throw new Error('Failed to fetch agent profile');return await response.json();}catch(error){console.error('[API] Error fetching agent profile:',error);return{success:true,agent:{name:\"Maya\",title:\"AI Marketing & Sales Agent\",avatar:\"https://api.dicebear.com/7.x/personas/svg?seed=Maya&backgroundColor=667eea\"},capabilities:[\"Marketing\",\"Lead Generation\",\"Sales\"]};}};/**\r\n * Generate a marketing post\r\n */export const generateMarketingPost=async params=>{const url=`${API_URL}/api/agent/generate-post`;logRequest('POST',url,params);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(params)});if(!response.ok)throw new Error('Failed to generate post');return await response.json();};/**\r\n * Search for property owner leads\r\n */export const searchPropertyLeads=async params=>{const url=`${API_URL}/api/agent/search-leads`;logRequest('POST',url,params);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(params)});if(!response.ok)throw new Error('Failed to search leads');return await response.json();};/**\r\n * Draft outreach email to property owner\r\n */export const draftOutreachEmail=async params=>{const url=`${API_URL}/api/agent/draft-email`;logRequest('POST',url,params);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(params)});if(!response.ok)throw new Error('Failed to draft email');return await response.json();};/**\r\n * Generate client acquisition strategy\r\n */export const generateAcquisitionStrategy=async params=>{const url=`${API_URL}/api/agent/acquisition-strategy`;logRequest('POST',url,params);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(params)});if(!response.ok)throw new Error('Failed to generate strategy');return await response.json();};/**\r\n * Simulate publishing a post\r\n */export const publishPost=async params=>{const url=`${API_URL}/api/agent/publish`;logRequest('POST',url,params);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(params)});if(!response.ok)throw new Error('Failed to publish');return await response.json();};/**\r\n * Simulate sending an email\r\n */export const sendOutreachEmail=async params=>{const url=`${API_URL}/api/agent/send-email`;logRequest('POST',url,params);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(params)});if(!response.ok)throw new Error('Failed to send email');return await response.json();};export default{getHealth,getDemoAuthToken,getPilotAccessToken,connectCalendar,getCalendarStatus,createManualCheckout,getManualRooms,getProperties,updateProperty,deleteProperty,createManualRoom,createManualRoomWithDescription,createProperty,checkoutManualRoom,checkinManualRoom,getManualRoomHistory,assignManualRoom,searchProperties,resolveManualRoom,reportIssue,importManualRoomFromLink,importProperty,setWorkerLanguage,getMessages,clockInStaff,clockOutStaff,getStaffList,toggleStaffActive,getLeaderboard,getStaffTasks,updateStaffTaskStatus,endShiftStaff,updateStaffPhoto,uploadStaffPhoto,updateStaffLocation,subscribeToStaff,getDispatchStatus,setDispatchStatus,sendAIAction,createBooking,getBookings,getAIInsights,getLatestBooking,getDailyReport,getAutomationStats,createLead,getLeads,getLead,getLeadsStats,updateLead,updateRoomStatus,subscribeToLeads,getAgentProfile,generateMarketingPost,searchPropertyLeads,draftOutreachEmail,generateAcquisitionStrategy,publishPost,sendOutreachEmail};","map":{"version":3,"names":["i18n","API_URL","apiRequest","console","log","logRequest","method","url","payload","logResponse","status","data","getAuthContext","_parsed$state","_parsed$state2","raw","localStorage","getItem","parsed","JSON","parse","token","state","authToken","tenantId","activeTenantId","error","getAuthHeaders","headers","Authorization","getHealth","response","fetch","ok","Error","json","getDemoAuthToken","body","stringify","tenant_id","getPilotAccessToken","tenantName","tenant_name","connectCalendar","icalUrl","nightlyRate","ical_url","nightly_rate","errorText","text","getCalendarStatus","refreshCalendar","createManualCheckout","checkoutDate","room","checkout_date","getManualRooms","getProperties","auth","_","updateProperty","id","arguments","length","undefined","idStr","String","trim","catch","deleteProperty","getPropertyStaff","propertyId","addPropertyStaff","_ref","name","role","removePropertyStaff","staffId","pid","sid","createManualRoom","createManualRoomWithDescription","description","photoUrl","photo_url","createProperty","_payload$name","_payload$description","_payload$photo_url","propertyData","price","Number","images","amenities","e","warn","result","_error$status","_error$response","_error$data","_error$response2","_ref2","_data$error","serverMsg","message","msg","window","alert","uploadImages","files","fileList","Array","isArray","formData","FormData","forEach","f","append","err","uploadPropertyPhoto","file","checkoutManualRoom","roomId","checkinManualRoom","getManualRoomHistory","assignManualRoom","staff_id","resolveManualRoom","reportIssue","_ref3","roomName","taskId","note","photo","searchProperties","query","encodeURIComponent","importManualRoomFromLink","endpoint","importProperty","setWorkerLanguage","language","getMessages","limit","clockInStaff","clockOutStaff","getStaffList","toggleStaffActive","active","getLeaderboard","getTasks","getStaffTasks","updateStaffTaskStatus","endShiftStaff","updateStaffPhoto","uploadStaffPhoto","updateStaffLocation","lat","lng","subscribeToStaff","onUpdate","onError","qs","URLSearchParams","set","toString","source","EventSource","addEventListener","event","onerror","getDispatchStatus","setDispatchStatus","enabled","intervalSeconds","interval_seconds","sendAIAction","type","lang","createBooking","bookingData","responseText","getBookings","getAIInsights","insight","t","bookings_count","getLatestBooking","getDashboardSummary","revenue","active_tasks_count","upcoming","getFinancialSummary","avg_ltv","conversion_rate","projected_revenue","getDailyReport","report","date","Date","toISOString","split","roi_metrics","hours_saved","cleanings_triggered","leads_captured","recommendations","agent_performance","savings","automation_rate","getAutomationStats","automation_stats","automated_messages","last_scan","leads_total","objection_success","sendWelcomeMessage","leadId","lead_id","createLead","leadData","getLeads","getLead","getLeadsStats","total","new","contacted","qualified","won","lost","avg_score","updateLead","updateRoomStatus","subscribeToLeads","onNewLead","onLeadUpdated","onAutomationStats","eventSource","lead","stats","getAgentProfile","success","agent","title","avatar","capabilities","generateMarketingPost","params","searchPropertyLeads","draftOutreachEmail","generateAcquisitionStrategy","publishPost","sendOutreachEmail"],"sources":["C:/Users/user/Desktop/hotel_ai_assistant/hotel_dashboard/src/services/api.js"],"sourcesContent":["import i18n from '../i18n';\r\nimport { API_URL, apiRequest } from '../utils/apiClient';\r\n\r\nconsole.log('[Easy Host AI API] Using backend URL:', API_URL);\r\n\r\n// Debug helper - logs all API requests\r\nconst logRequest = (method, url, payload) => {\r\n  console.log(`[API] ${method} ${url}`);\r\n  if (payload) console.log('[API] Payload:', payload);\r\n};\r\n\r\nconst logResponse = (url, status, data) => {\r\n  console.log(`[API] Response from ${url}:`, status, data);\r\n};\r\n\r\nconst getAuthContext = () => {\r\n  try {\r\n    const raw = localStorage.getItem('hotel-enterprise-storage');\r\n    if (!raw) return {};\r\n    const parsed = JSON.parse(raw);\r\n    return {\r\n      token: parsed?.state?.authToken,\r\n      tenantId: parsed?.state?.activeTenantId,\r\n    };\r\n  } catch (error) {\r\n    return {};\r\n  }\r\n};\r\n\r\nconst getAuthHeaders = () => {\r\n  const { token, tenantId } = getAuthContext();\r\n  const headers = {};\r\n  if (token) headers.Authorization = `Bearer ${token}`;\r\n  if (tenantId) headers['X-Tenant-Id'] = tenantId;\r\n  return headers;\r\n};\r\n\r\n/**\r\n * Health check - get server status\r\n * @returns {Promise<object>} { ok, status, openai_configured, sse_clients }\r\n */\r\nexport const getHealth = async () => {\r\n  const url = `${API_URL}/health`;\r\n  logRequest('GET', url);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      console.error(`[API] Health check failed: HTTP ${response.status}`);\r\n      throw new Error('Health check failed');\r\n    }\r\n\r\n    const data = await response.json();\r\n    logResponse(url, response.status, data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error('[API] Error checking health:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getDemoAuthToken = async (tenantId) => {\r\n  const url = `${API_URL}/api/auth/demo`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ tenant_id: tenantId }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to get demo token');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getPilotAccessToken = async (tenantName) => {\r\n  const url = `${API_URL}/api/auth/pilot`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ tenant_name: tenantName }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to get pilot token');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const connectCalendar = async (icalUrl, nightlyRate) => {\r\n  const url = `${API_URL}/api/onboarding/ical`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ ical_url: icalUrl, nightly_rate: nightlyRate }),\r\n  });\r\n  if (!response.ok) {\r\n    const errorText = await response.text();\r\n    throw new Error(errorText || 'Failed to sync calendar');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getCalendarStatus = async () => {\r\n  const url = `${API_URL}/api/onboarding/status`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch calendar status');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const refreshCalendar = async () => {\r\n  const url = `${API_URL}/api/onboarding/ical/refresh`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to refresh calendar');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const createManualCheckout = async (checkoutDate, room) => {\r\n  const url = `${API_URL}/api/onboarding/manual-checkout`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ checkout_date: checkoutDate, room }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to create manual checkout');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getManualRooms = async () => {\r\n  const url = `${API_URL}/api/rooms/manual`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch manual rooms');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/** Fetch all properties from GET /api/properties (manual_rooms table) */\r\nexport const getProperties = async () => {\r\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\r\n  if (!headers.Authorization) {\r\n    try {\r\n      const auth = await getDemoAuthToken('default');\r\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\r\n    } catch (_) {}\r\n  }\r\n  const response = await fetch(`${API_URL}/api/properties`, { method: 'GET', headers });\r\n  if (!response.ok) throw new Error('Failed to fetch properties');\r\n  return await response.json();\r\n};\r\n\r\n/** PUT /api/properties/<id> - update a property. Pass id exactly as in DB (UUID). */\r\nexport const updateProperty = async (id, payload = {}) => {\r\n  const idStr = id != null && id !== '' ? String(id).trim() : '';\r\n  if (!idStr) throw new Error('Property id required');\r\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\r\n  if (!headers.Authorization) {\r\n    try {\r\n      const auth = await getDemoAuthToken('default');\r\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\r\n    } catch (_) {}\r\n  }\r\n  const response = await fetch(`${API_URL}/api/properties/${idStr}`, {\r\n    method: 'PUT',\r\n    headers,\r\n    body: JSON.stringify(payload),\r\n  });\r\n  if (!response.ok) {\r\n    const data = await response.json().catch(() => ({}));\r\n    throw new Error(data.error || 'Failed to update property');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/** DELETE /api/properties/<id> - remove a property by UUID */\r\nexport const deleteProperty = async (id) => {\r\n  const idStr = id != null && id !== '' ? String(id).trim() : '';\r\n  if (!idStr) throw new Error('Property id required');\r\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\r\n  if (!headers.Authorization) {\r\n    try {\r\n      const auth = await getDemoAuthToken('default');\r\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\r\n    } catch (_) {}\r\n  }\r\n  const response = await fetch(`${API_URL}/api/properties/${idStr}`, { method: 'DELETE', headers });\r\n  if (!response.ok) {\r\n    const data = await response.json().catch(() => ({}));\r\n    throw new Error(data.error || 'Failed to delete property');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/** GET /api/properties/<id>/staff - list employees for property */\r\nexport const getPropertyStaff = async (propertyId) => {\r\n  const idStr = propertyId != null ? String(propertyId).trim() : '';\r\n  if (!idStr) return [];\r\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\r\n  if (!headers.Authorization) {\r\n    try {\r\n      const auth = await getDemoAuthToken('default');\r\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\r\n    } catch (_) {}\r\n  }\r\n  const response = await fetch(`${API_URL}/api/properties/${idStr}/staff`, { method: 'GET', headers });\r\n  if (!response.ok) return [];\r\n  return await response.json();\r\n};\r\n\r\n/** POST /api/properties/<id>/staff - add employee (name, role) linked to property_id */\r\nexport const addPropertyStaff = async (propertyId, { name, role = 'Staff' }) => {\r\n  const idStr = propertyId != null ? String(propertyId).trim() : '';\r\n  if (!idStr) throw new Error('Property id required');\r\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\r\n  if (!headers.Authorization) {\r\n    try {\r\n      const auth = await getDemoAuthToken('default');\r\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\r\n    } catch (_) {}\r\n  }\r\n  const response = await fetch(`${API_URL}/api/properties/${idStr}/staff`, {\r\n    method: 'POST',\r\n    headers,\r\n    body: JSON.stringify({ name: (name || '').trim(), role: (role || 'Staff').trim() }),\r\n  });\r\n  if (!response.ok) {\r\n    const data = await response.json().catch(() => ({}));\r\n    throw new Error(data.error || 'Failed to add employee');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/** DELETE /api/properties/<id>/staff/<staff_id> - remove employee from property */\r\nexport const removePropertyStaff = async (propertyId, staffId) => {\r\n  const pid = propertyId != null ? String(propertyId).trim() : '';\r\n  const sid = staffId != null ? String(staffId).trim() : '';\r\n  if (!pid || !sid) throw new Error('Property and staff id required');\r\n  let headers = { 'Content-Type': 'application/json', ...getAuthHeaders() };\r\n  if (!headers.Authorization) {\r\n    try {\r\n      const auth = await getDemoAuthToken('default');\r\n      if (auth?.token) headers = { ...headers, Authorization: `Bearer ${auth.token}` };\r\n    } catch (_) {}\r\n  }\r\n  const response = await fetch(`${API_URL}/api/properties/${pid}/staff/${sid}`, { method: 'DELETE', headers });\r\n  if (!response.ok) {\r\n    const data = await response.json().catch(() => ({}));\r\n    throw new Error(data.error || 'Failed to remove employee');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const createManualRoom = async (name) => {\r\n  const url = `${API_URL}/api/rooms/manual`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ name }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to create manual room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const createManualRoomWithDescription = async (name, description, photoUrl) => {\r\n  const url = `${API_URL}/api/rooms/manual`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ name, description, photo_url: photoUrl }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to create manual room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Create property - uses central apiClient (http://127.0.0.1:5000)\r\n * All fields have safe defaults to prevent undefined errors.\r\n */\r\nexport const createProperty = async (payload = {}) => {\r\n  const propertyData = {\r\n    name: String(payload.name ?? '').trim() || 'Unnamed Property',\r\n    description: String(payload.description ?? ''),\r\n    price: Number(payload.price) || 0,\r\n    photo_url: String(payload.photo_url ?? ''),\r\n    images: payload.images || [],\r\n    amenities: payload.amenities || [],\r\n  };\r\n  console.log('[createProperty] Sending:', propertyData);\r\n  try {\r\n    let headers = {};\r\n    if (!getAuthHeaders().Authorization) {\r\n      try {\r\n        const auth = await getDemoAuthToken('default');\r\n        if (auth?.token) headers.Authorization = `Bearer ${auth.token}`;\r\n      } catch (e) {\r\n        console.warn('[createProperty] Demo auth failed:', e);\r\n      }\r\n    }\r\n    const result = await apiRequest('/api/properties', {\r\n      method: 'POST',\r\n      body: propertyData,\r\n      headers: { ...getAuthHeaders(), ...headers },\r\n    });\r\n    return result;\r\n  } catch (error) {\r\n    const status = error?.status ?? error?.response?.status;\r\n    const data = error?.data ?? error?.response?.data;\r\n    const serverMsg = data?.error ?? data?.message ?? (typeof data === 'string' ? data : JSON.stringify(data || {}));\r\n    const msg = `Create Property failed: ${error?.message || 'Unknown error'}` +\r\n      (status ? ` [HTTP ${status}]` : '') +\r\n      (serverMsg ? ` | Server: ${serverMsg}` : '');\r\n    console.error('[createProperty] Full error:', error);\r\n    window.alert(msg);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Generic image upload - accepts multiple files, returns array of URLs\r\n * @param {File|File[]} files - Single file or array of files\r\n * @returns {Promise<{urls: string[]}>}\r\n */\r\nexport const uploadImages = async (files) => {\r\n  const fileList = Array.isArray(files) ? files : [files];\r\n  const formData = new FormData();\r\n  fileList.forEach((f) => formData.append('files', f));\r\n  const response = await fetch(`${API_URL}/api/upload`, {\r\n    method: 'POST',\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n      // FormData triggers browser to set Content-Type: multipart/form-data; boundary=...\r\n    },\r\n    body: formData,\r\n  });\r\n  if (!response.ok) {\r\n    const err = await response.json().catch(() => ({}));\r\n    throw new Error(err.error || 'Failed to upload images');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const uploadPropertyPhoto = async (file) => {\r\n  const formData = new FormData();\r\n  formData.append('photo', file);\r\n  const response = await fetch(`${API_URL}/api/rooms/manual/photo/upload`, {\r\n    method: 'POST',\r\n    headers: getAuthHeaders(),\r\n    body: formData,\r\n  });\r\n  if (!response.ok) {\r\n    const err = await response.json().catch(() => ({}));\r\n    throw new Error(err.error || 'Failed to upload photo');\r\n  }\r\n  const data = await response.json();\r\n  return data.photo_url;\r\n};\r\n\r\nexport const checkoutManualRoom = async (roomId) => {\r\n  const url = `${API_URL}/api/rooms/manual/${roomId}/checkout`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to checkout room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const checkinManualRoom = async (roomId) => {\r\n  const url = `${API_URL}/api/rooms/manual/${roomId}/checkin`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to check-in room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getManualRoomHistory = async (roomId) => {\r\n  const url = `${API_URL}/api/rooms/manual/${roomId}/history`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch room history');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const assignManualRoom = async (roomId, staffId) => {\r\n  const url = `${API_URL}/api/rooms/manual/${roomId}/assign`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ staff_id: staffId }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to assign room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const resolveManualRoom = async (roomId) => {\r\n  const url = `${API_URL}/api/rooms/manual/${roomId}/resolve`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to resolve room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const reportIssue = async ({ roomId, roomName, taskId, note, photo }) => {\r\n  const url = `${API_URL}/api/issues/report`;\r\n  const formData = new FormData();\r\n  formData.append('room_id', roomId);\r\n  formData.append('room_name', roomName || '');\r\n  if (taskId) formData.append('task_id', taskId);\r\n  if (note) formData.append('note', note);\r\n  formData.append('photo', photo);\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: formData,\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to report issue');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const searchProperties = async (query) => {\r\n  const url = `${API_URL}/api/properties/search?q=${encodeURIComponent(query)}`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to search properties');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const importManualRoomFromLink = async (url) => {\r\n  const endpoint = `${API_URL}/api/rooms/manual/import`;\r\n  const response = await fetch(endpoint, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ url }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to import room');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/** Import Airbnb/Booking property - creates property + initial cleaning task */\r\nexport const importProperty = async (url) => {\r\n  const response = await fetch(`${API_URL}/api/v1/properties/import`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ url }),\r\n  });\r\n  if (!response.ok) {\r\n    const err = await response.json().catch(() => ({}));\r\n    throw new Error(err.error || 'Failed to import property');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const setWorkerLanguage = async (language) => {\r\n  const url = `${API_URL}/api/worker/language`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ language }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to set worker language');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getMessages = async (limit = 50) => {\r\n  const url = `${API_URL}/api/messages?limit=${limit}`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch messages');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const clockInStaff = async (payload) => {\r\n  const url = `${API_URL}/api/staff/clock-in`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify(payload),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to clock in staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const clockOutStaff = async (staffId) => {\r\n  const url = `${API_URL}/api/staff/clock-out`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ staff_id: staffId }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to clock out staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getStaffList = async () => {\r\n  const url = `${API_URL}/api/staff`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const toggleStaffActive = async (staffId, active) => {\r\n  const url = `${API_URL}/api/staff/${staffId}/active`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ active }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to toggle staff');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getLeaderboard = async () => {\r\n  const url = `${API_URL}/api/staff/leaderboard`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch leaderboard');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getTasks = async (staffId = null) => {\r\n  const url = staffId\r\n    ? `${API_URL}/api/staff/tasks?staff_id=${encodeURIComponent(staffId)}`\r\n    : `${API_URL}/api/staff/tasks`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch tasks');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const getStaffTasks = getTasks;\r\n\r\nexport const updateStaffTaskStatus = async (taskId, status) => {\r\n  const url = `${API_URL}/api/staff/tasks/${taskId}/status`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ status }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update task');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const endShiftStaff = async (staffId) => {\r\n  const url = `${API_URL}/api/staff/${staffId}/end-shift`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to end shift');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const updateStaffPhoto = async (staffId, photoUrl) => {\r\n  const url = `${API_URL}/api/staff/${staffId}/photo`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ photo_url: photoUrl }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update staff photo');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const uploadStaffPhoto = async (staffId, file) => {\r\n  const url = `${API_URL}/api/staff/${staffId}/photo/upload`;\r\n  const formData = new FormData();\r\n  formData.append('photo', file);\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n      // FormData sends as multipart/form-data (browser sets Content-Type with boundary)\r\n    },\r\n    body: formData,\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to upload staff photo');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const updateStaffLocation = async (staffId, lat, lng) => {\r\n  const url = `${API_URL}/api/staff/${staffId}/location`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ lat, lng }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update staff location');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const subscribeToStaff = (onUpdate, onError) => {\r\n  const { token, tenant_id } = getAuthContext();\r\n  const qs = new URLSearchParams();\r\n  if (token) qs.set('token', token);\r\n  if (tenant_id) qs.set('tenant_id', tenant_id);\r\n  const url = `${API_URL}/api/stream/staff?${qs.toString()}`;\r\n  const source = new EventSource(url);\r\n  source.addEventListener('staff_update', (event) => {\r\n    try {\r\n      const data = JSON.parse(event.data);\r\n      onUpdate?.(data);\r\n    } catch (error) {\r\n      // ignore parse errors\r\n    }\r\n  });\r\n  source.onerror = (error) => {\r\n    onError?.(error);\r\n  };\r\n  return source;\r\n};\r\n\r\nexport const getDispatchStatus = async () => {\r\n  const url = `${API_URL}/api/dispatch/status`;\r\n  const response = await fetch(url, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch dispatch status');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\nexport const setDispatchStatus = async (enabled, intervalSeconds) => {\r\n  const url = `${API_URL}/api/dispatch/status`;\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ enabled, interval_seconds: intervalSeconds }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error('Failed to update dispatch status');\r\n  }\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Send an AI action request\r\n * @param {string} type - Action type (e.g., 'checkout', 'towels', 'restaurant')\r\n * @param {string} room - Room identifier\r\n * @param {string} role - User role ('owner', 'staff', 'guest')\r\n * @param {string} lang - Language code\r\n * @returns {Promise<object>} Response with { success, intent, draft, auto_send, is_safe }\r\n */\r\nexport const sendAIAction = async (type, room, role, lang) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/ai_action`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ type, room, role, lang }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to send AI action');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error sending AI action:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Create a new booking\r\n * @param {object} bookingData - Booking data { room_name, customer_name }\r\n * @returns {Promise<object>}\r\n */\r\nexport const createBooking = async (bookingData) => {\r\n  const url = `${API_URL}/api/book`;\r\n  logRequest('POST', url, bookingData);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(bookingData),\r\n    });\r\n\r\n    const responseText = await response.text();\r\n    console.log(`[API] createBooking response: status=${response.status}, body=${responseText}`);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to create booking: HTTP ${response.status}`);\r\n    }\r\n\r\n    return JSON.parse(responseText);\r\n  } catch (error) {\r\n    console.error('[API] Error creating booking:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get all bookings\r\n * @returns {Promise<Array>}\r\n */\r\nexport const getBookings = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/bookings`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch bookings');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching bookings:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get AI insights\r\n * Returns fallback message if OpenAI not configured on backend\r\n * @returns {Promise<object>} { insight, bookings_count }\r\n */\r\nexport const getAIInsights = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/ai-insights`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch AI insights');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching AI insights:', error);\r\n    // Return fallback insight on error\r\n    return {\r\n      insight: i18n.t('common.readyToHelp'),\r\n      bookings_count: 0\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get latest booking info (for polling fallback)\r\n * @returns {Promise<object>} { latest_id, latest_room, latest_customer, latest_time, total_count }\r\n */\r\nexport const getLatestBooking = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/bookings/latest`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch latest booking');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching latest booking:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get dashboard summary (revenue, active tasks, upcoming)\r\n * @returns {Promise<object>}\r\n */\r\nexport const getDashboardSummary = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/v1/dashboard/summary`, {\r\n      method: 'GET',\r\n      headers: { 'Content-Type': 'application/json', ...getAuthHeaders() },\r\n    });\r\n    if (!response.ok) throw new Error('Failed to fetch dashboard summary');\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching dashboard summary:', error);\r\n    return { revenue: '0₪', active_tasks_count: 0, upcoming: [], status: 'Unavailable' };\r\n  }\r\n};\r\n\r\n/**\r\n * Get financial summary (LTV, conversion rate, projected revenue)\r\n * @returns {Promise<{avg_ltv: string, conversion_rate: string, projected_revenue: string}>}\r\n */\r\nexport const getFinancialSummary = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/v1/financials/summary`, {\r\n      method: 'GET',\r\n      headers: { 'Content-Type': 'application/json', ...getAuthHeaders() },\r\n    });\r\n    if (!response.ok) throw new Error('Failed to fetch financial summary');\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching financial summary:', error);\r\n    return { avg_ltv: '₪0', conversion_rate: '0%', projected_revenue: '₪0' };\r\n  }\r\n};\r\n\r\n/**\r\n * Get daily ROI report\r\n * @returns {Promise<object>}\r\n */\r\nexport const getDailyReport = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/reports/daily`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch daily report');\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.report || data;\r\n  } catch (error) {\r\n    console.error('Error fetching daily report:', error);\r\n    return {\r\n      date: new Date().toISOString().split('T')[0],\r\n      roi_metrics: {\r\n        hours_saved: 0,\r\n        cleanings_triggered: 0,\r\n        leads_captured: 0\r\n      },\r\n      recommendations: [],\r\n      agent_performance: [],\r\n      savings: { automation_rate: 0 }\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Get automation stats (messages sent, last scan, objection success)\r\n * @returns {Promise<object>}\r\n */\r\nexport const getAutomationStats = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/stats`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch automation stats');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching automation stats:', error);\r\n    return {\r\n      automation_stats: { automated_messages: 0, last_scan: null, leads_total: 0 },\r\n      objection_success: {},\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Send welcome WhatsApp message for a lead\r\n * @param {string} leadId\r\n * @returns {Promise<object>}\r\n */\r\nexport const sendWelcomeMessage = async (leadId) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/whatsapp/welcome`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({ lead_id: leadId }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to send welcome message');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error sending welcome message:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// ============== Leads API ==============\r\n\r\n/**\r\n * Create a new lead\r\n * @param {object} leadData - { name, email, phone, guests, checkin, checkout, source }\r\n * @returns {Promise<object>} { success, id, score }\r\n */\r\nexport const createLead = async (leadData) => {\r\n  const url = `${API_URL}/api/leads`;\r\n  logRequest('POST', url, leadData);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n      body: JSON.stringify(leadData),\r\n    });\r\n\r\n    const responseText = await response.text();\r\n    console.log(`[API] createLead response: status=${response.status}, body=${responseText}`);\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to create lead: HTTP ${response.status}`);\r\n    }\r\n\r\n    return JSON.parse(responseText);\r\n  } catch (error) {\r\n    console.error('[API] Error creating lead:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get all leads\r\n * @param {string} status - Optional status filter ('new', 'contacted', 'qualified', 'booked', 'lost')\r\n * @returns {Promise<Array>}\r\n */\r\nexport const getLeads = async (status = null) => {\r\n  const url = status\r\n    ? `${API_URL}/api/leads?status=${status}`\r\n    : `${API_URL}/api/leads`;\r\n  logRequest('GET', url);\r\n\r\n  try {\r\n    const response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      console.error(`[API] getLeads failed: HTTP ${response.status}`);\r\n      throw new Error('Failed to fetch leads');\r\n    }\r\n\r\n    const data = await response.json();\r\n\r\n    // IMPORTANT: Ensure we always return an array\r\n    if (Array.isArray(data)) {\r\n      console.log(`[API] getLeads: received ${data.length} leads`);\r\n      return data;\r\n    } else if (data && typeof data === 'object') {\r\n      // If backend returns a single object, wrap it in an array\r\n      console.warn('[API] getLeads: received object instead of array, wrapping');\r\n      return [data];\r\n    } else {\r\n      console.warn('[API] getLeads: unexpected response format, returning empty array');\r\n      return [];\r\n    }\r\n  } catch (error) {\r\n    console.error('[API] Error fetching leads:', error);\r\n    // Return empty array on error instead of throwing\r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Get a single lead by ID\r\n * @param {number} leadId - Lead ID\r\n * @returns {Promise<object>}\r\n */\r\nexport const getLead = async (leadId) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/leads/${leadId}`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch lead');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching lead:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Get leads statistics\r\n * @returns {Promise<object>} { total, new, contacted, qualified, won, lost, avg_score }\r\n */\r\nexport const getLeadsStats = async () => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/leads/stats`, {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to fetch leads stats');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error fetching leads stats:', error);\r\n    // Return default stats on error\r\n    return {\r\n      total: 0,\r\n      new: 0,\r\n      contacted: 0,\r\n      qualified: 0,\r\n      won: 0,\r\n      lost: 0,\r\n      avg_score: 0\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Update lead status, score, or notes\r\n * @param {number} leadId - Lead ID\r\n * @param {object} data - { status, score, notes }\r\n * @returns {Promise<object>}\r\n */\r\nexport const updateLead = async (leadId, data) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/leads/${leadId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        ...getAuthHeaders(),\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to update lead');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error updating lead:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Update room status or details\r\n * @param {number} roomId\r\n * @param {object} data\r\n * @returns {Promise<object>}\r\n */\r\nexport const updateRoomStatus = async (roomId, data) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/api/rooms/${roomId}`, {\r\n      method: 'PATCH',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Failed to update room');\r\n    }\r\n\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('Error updating room:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Subscribe to leads SSE stream\r\n * @param {function} onNewLead - Callback for new lead events\r\n * @param {function} onLeadUpdated - Callback for lead updated events\r\n * @param {function} onError - Callback for errors\r\n * @returns {EventSource} - The event source (call .close() to disconnect)\r\n */\r\nexport const subscribeToLeads = (onNewLead, onLeadUpdated, onError, onAutomationStats) => {\r\n  const { token, tenantId } = getAuthContext();\r\n  const query = new URLSearchParams();\r\n  if (token) query.set('token', token);\r\n  if (tenantId) query.set('tenant_id', tenantId);\r\n  const url = `${API_URL}/api/stream/leads?${query.toString()}`;\r\n  const eventSource = new EventSource(url);\r\n\r\n  eventSource.addEventListener('new_lead', (event) => {\r\n    try {\r\n      const lead = JSON.parse(event.data);\r\n      onNewLead(lead);\r\n    } catch (e) {\r\n      console.error('Error parsing lead event:', e);\r\n    }\r\n  });\r\n\r\n  eventSource.addEventListener('lead_updated', (event) => {\r\n    try {\r\n      const lead = JSON.parse(event.data);\r\n      if (onLeadUpdated) onLeadUpdated(lead);\r\n    } catch (e) {\r\n      console.error('Error parsing lead_updated event:', e);\r\n    }\r\n  });\r\n\r\n  eventSource.addEventListener('automation_stats', (event) => {\r\n    try {\r\n      const stats = JSON.parse(event.data);\r\n      if (onAutomationStats) onAutomationStats(stats);\r\n    } catch (e) {\r\n      console.error('Error parsing automation_stats event:', e);\r\n    }\r\n  });\r\n\r\n  eventSource.addEventListener('connected', (event) => {\r\n    console.log('Connected to leads stream:', event.data);\r\n  });\r\n\r\n  eventSource.onerror = (error) => {\r\n    console.error('Leads SSE error:', error);\r\n    if (onError) onError(error);\r\n  };\r\n\r\n  return eventSource;\r\n};\r\n\r\n// ============== AI Marketing Agent API ==============\r\n\r\n/**\r\n * Get AI Agent profile and capabilities\r\n */\r\nexport const getAgentProfile = async () => {\r\n  const url = `${API_URL}/api/agent/profile`;\r\n  logRequest('GET', url);\r\n\r\n  try {\r\n    const response = await fetch(url);\r\n    if (!response.ok) throw new Error('Failed to fetch agent profile');\r\n    return await response.json();\r\n  } catch (error) {\r\n    console.error('[API] Error fetching agent profile:', error);\r\n    return {\r\n      success: true,\r\n      agent: {\r\n        name: \"Maya\",\r\n        title: \"AI Marketing & Sales Agent\",\r\n        avatar: \"https://api.dicebear.com/7.x/personas/svg?seed=Maya&backgroundColor=667eea\"\r\n      },\r\n      capabilities: [\"Marketing\", \"Lead Generation\", \"Sales\"]\r\n    };\r\n  }\r\n};\r\n\r\n/**\r\n * Generate a marketing post\r\n */\r\nexport const generateMarketingPost = async (params) => {\r\n  const url = `${API_URL}/api/agent/generate-post`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to generate post');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Search for property owner leads\r\n */\r\nexport const searchPropertyLeads = async (params) => {\r\n  const url = `${API_URL}/api/agent/search-leads`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to search leads');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Draft outreach email to property owner\r\n */\r\nexport const draftOutreachEmail = async (params) => {\r\n  const url = `${API_URL}/api/agent/draft-email`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to draft email');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Generate client acquisition strategy\r\n */\r\nexport const generateAcquisitionStrategy = async (params) => {\r\n  const url = `${API_URL}/api/agent/acquisition-strategy`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to generate strategy');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Simulate publishing a post\r\n */\r\nexport const publishPost = async (params) => {\r\n  const url = `${API_URL}/api/agent/publish`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to publish');\r\n  return await response.json();\r\n};\r\n\r\n/**\r\n * Simulate sending an email\r\n */\r\nexport const sendOutreachEmail = async (params) => {\r\n  const url = `${API_URL}/api/agent/send-email`;\r\n  logRequest('POST', url, params);\r\n\r\n  const response = await fetch(url, {\r\n    method: 'POST',\r\n    headers: { 'Content-Type': 'application/json' },\r\n    body: JSON.stringify(params)\r\n  });\r\n  if (!response.ok) throw new Error('Failed to send email');\r\n  return await response.json();\r\n};\r\n\r\nexport default {\r\n  getHealth,\r\n  getDemoAuthToken,\r\n  getPilotAccessToken,\r\n  connectCalendar,\r\n  getCalendarStatus,\r\n  createManualCheckout,\r\n  getManualRooms,\r\n  getProperties,\r\n  updateProperty,\r\n  deleteProperty,\r\n  createManualRoom,\r\n  createManualRoomWithDescription,\r\n  createProperty,\r\n  checkoutManualRoom,\r\n  checkinManualRoom,\r\n  getManualRoomHistory,\r\n  assignManualRoom,\r\n  searchProperties,\r\n  resolveManualRoom,\r\n  reportIssue,\r\n  importManualRoomFromLink,\r\n  importProperty,\r\n  setWorkerLanguage,\r\n  getMessages,\r\n  clockInStaff,\r\n  clockOutStaff,\r\n  getStaffList,\r\n  toggleStaffActive,\r\n  getLeaderboard,\r\n  getStaffTasks,\r\n  updateStaffTaskStatus,\r\n  endShiftStaff,\r\n  updateStaffPhoto,\r\n  uploadStaffPhoto,\r\n  updateStaffLocation,\r\n  subscribeToStaff,\r\n  getDispatchStatus,\r\n  setDispatchStatus,\r\n  sendAIAction,\r\n  createBooking,\r\n  getBookings,\r\n  getAIInsights,\r\n  getLatestBooking,\r\n  getDailyReport,\r\n  getAutomationStats,\r\n  createLead,\r\n  getLeads,\r\n  getLead,\r\n  getLeadsStats,\r\n  updateLead,\r\n  updateRoomStatus,\r\n  subscribeToLeads,\r\n  getAgentProfile,\r\n  generateMarketingPost,\r\n  searchPropertyLeads,\r\n  draftOutreachEmail,\r\n  generateAcquisitionStrategy,\r\n  publishPost,\r\n  sendOutreachEmail,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}